<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ASMAS-SS2024 | 0.12.5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ASMAS-SS2024 | 0.12.5</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../course_notes.html"> 
<span class="menu-text">Course Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../exercises.html"> 
<span class="menu-text">Exercises</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../solutions.html"> 
<span class="menu-text">Solutions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../add_info.html"> 
<span class="menu-text">Additional Information</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-1-linear-regression" id="toc-problem-1-linear-regression" class="nav-link active" data-scroll-target="#problem-1-linear-regression">Problem 1: Linear Regression</a>
  <ul class="collapse">
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution">Solution</a></li>
  <li><a href="#solution-1" id="toc-solution-1" class="nav-link" data-scroll-target="#solution-1">Solution</a></li>
  <li><a href="#solution-2" id="toc-solution-2" class="nav-link" data-scroll-target="#solution-2">Solution</a></li>
  <li><a href="#solution-3" id="toc-solution-3" class="nav-link" data-scroll-target="#solution-3">Solution</a></li>
  </ul></li>
  <li><a href="#problem-2-fixed-linear-effects-model" id="toc-problem-2-fixed-linear-effects-model" class="nav-link" data-scroll-target="#problem-2-fixed-linear-effects-model">Problem 2: Fixed Linear Effects Model</a>
  <ul class="collapse">
  <li><a href="#solution-4" id="toc-solution-4" class="nav-link" data-scroll-target="#solution-4">Solution</a></li>
  <li><a href="#solution-5" id="toc-solution-5" class="nav-link" data-scroll-target="#solution-5">Solution</a></li>
  <li><a href="#solution-6" id="toc-solution-6" class="nav-link" data-scroll-target="#solution-6">Solution</a></li>
  </ul></li>
  <li><a href="#problem-3-interactions" id="toc-problem-3-interactions" class="nav-link" data-scroll-target="#problem-3-interactions">Problem 3: Interactions</a>
  <ul class="collapse">
  <li><a href="#solution-7" id="toc-solution-7" class="nav-link" data-scroll-target="#solution-7">Solution</a></li>
  <li><a href="#solution-8" id="toc-solution-8" class="nav-link" data-scroll-target="#solution-8">Solution</a></li>
  </ul></li>
  <li><a href="#problem-4-contrasts" id="toc-problem-4-contrasts" class="nav-link" data-scroll-target="#problem-4-contrasts">Problem 4: Contrasts</a>
  <ul class="collapse">
  <li><a href="#solution-9" id="toc-solution-9" class="nav-link" data-scroll-target="#solution-9">Solution</a></li>
  <li><a href="#solution-10" id="toc-solution-10" class="nav-link" data-scroll-target="#solution-10">Solution</a></li>
  </ul></li>
  <li><a href="#problem-5-linear-mixed-effects-models" id="toc-problem-5-linear-mixed-effects-models" class="nav-link" data-scroll-target="#problem-5-linear-mixed-effects-models">Problem 5: Linear Mixed Effects Models</a>
  <ul class="collapse">
  <li><a href="#solution-11" id="toc-solution-11" class="nav-link" data-scroll-target="#solution-11">Solution</a></li>
  <li><a href="#solution-12" id="toc-solution-12" class="nav-link" data-scroll-target="#solution-12">Solution</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<!-- %\usepackage{fancyhdr} -->
<!-- %\begin{document} -->
<!-- %\SweaveOpts{concordance=TRUE} -->
<!-- % Table with Name -->
<!-- % Table with Points -->
<p></p>
<section id="problem-1-linear-regression" class="level1">
<h1>Problem 1: Linear Regression</h1>
<p>According to Figure 1 of <span class="citation" data-cites="Chen2023b">(<a href="#ref-Chen2023b" role="doc-biblioref">Chen et al. 2023</a>)</span> the concentration of citrate in milk between days in milk (DIM) 20 and 50 can be modeled by a linear regression. The dataset shown below contains measurements of 20 cows with their respective days in milk.</p>
<p></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Cow</th>
<th style="text-align: right;">DIM</th>
<th style="text-align: right;">Citrate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">9.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">9.23</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">9.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">8.68</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">9.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">9.14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8.69</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">8.85</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">8.93</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">8.67</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">8.54</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">9.34</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">8.63</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">8.66</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">8.78</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">8.29</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">8.86</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">8.34</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">8.72</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">8.26</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The dataset is available from</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>https://charlotte-ngs.github.io/asmasss2024/data/asm_exam_2024_p01.csv </code></pre>
</div>
</div>
<section id="solution" class="level2">
<h2 class="anchored" data-anchor-id="solution">Solution</h2>
<p>The regression model is given as</p>
<p><span class="math display">\[y = Xb + e\]</span></p>
<p>where vectors</p>
<ul>
<li><span class="math inline">\(y\)</span>: vector of length <span class="math inline">\(n=20\)</span> with known observations of the response variable</li>
<li><span class="math inline">\(b\)</span>: vector of length <span class="math inline">\(p=2\)</span> with unknown effects (intercept and slope)</li>
<li><span class="math inline">\(e\)</span>: vector of length <span class="math inline">\(n=20\)</span> with unknown random residuals</li>
</ul>
<p>and Matrix <span class="math inline">\(X\)</span> of dimension <span class="math inline">\(n\times p\)</span> contains a column of all ones and the column with DIM values.</p>
<p>The known components are <span class="math inline">\(y\)</span> and <span class="math inline">\(X\)</span> and they can be specified by the information from the dataset</p>
<p><span class="math display">\[
y = \begin{bmatrix} 9.1 \\9.23 \\9.1 \\8.68 \\9.1 \\9.14 \\8.69 \\8.85 \\8.93 \\8.67 \\8.54 \\9.34 \\8.63 \\8.66 \\8.78 \\8.29 \\8.86 \\8.34 \\8.72 \\8.26\end{bmatrix}
\text{, }
X = \begin{bmatrix} 1 &amp; 22 \\1 &amp; 22 \\1 &amp; 22 \\1 &amp; 24 \\1 &amp; 24 \\1 &amp; 24 \\1 &amp; 25 \\1 &amp; 26 \\1 &amp; 27 \\1 &amp; 29 \\1 &amp; 29 \\1 &amp; 30 \\1 &amp; 31 \\1 &amp; 33 \\1 &amp; 35 \\1 &amp; 36 \\1 &amp; 42 \\1 &amp; 44 \\1 &amp; 44 \\1 &amp; 46\end{bmatrix}
\]</span></p>
</section>
<section id="solution-1" class="level2">
<h2 class="anchored" data-anchor-id="solution-1">Solution</h2>
<p>The linear regression model fit is given by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lm_cit_dim <span class="ot">&lt;-</span> <span class="fu">lm</span>(Citrate <span class="sc">~</span> DIM, <span class="at">data =</span> tbl_p01)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_cit_dim)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Citrate ~ DIM, data = tbl_p01)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.37391 -0.16177 -0.01203  0.14531  0.52570 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  9.566262   0.221608  43.168  &lt; 2e-16 ***
DIM         -0.025065   0.006988  -3.587  0.00211 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2424 on 18 degrees of freedom
Multiple R-squared:  0.4168,    Adjusted R-squared:  0.3845 
F-statistic: 12.87 on 1 and 18 DF,  p-value: 0.002107</code></pre>
</div>
</div>
<p>The estimates for the quantities asked in the problem are listed in the following table</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: right;">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Slope</td>
<td style="text-align: right;">-0.0250654</td>
</tr>
<tr class="even">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">9.5662617</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance of Residuals</td>
<td style="text-align: right;">0.0587783</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-hook_convert_odg="true" data-fig_path="odg">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="odg/cit-dim-empty-p01.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hook_convert_odg="true" data-fig_path="odg">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="odg/cit-dim-empty-p02.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-2" class="level2">
<h2 class="anchored" data-anchor-id="solution-2">Solution</h2>
<p>The second plot is correct. The following components could be inserted into the plot</p>
<div class="cell" data-hook_convert_odg="true" data-fig_path="odg">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><embed src="odg/cit-dim-inserted.pdf" class="img-fluid" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-3" class="level2">
<h2 class="anchored" data-anchor-id="solution-3">Solution</h2>
<p>It is not possible, because DIM between 1 and 10 are outside of the DIM range of the dataset. Figure 1 in <span class="citation" data-cites="Chen2023b">(<a href="#ref-Chen2023b" role="doc-biblioref">Chen et al. 2023</a>)</span> shows that before DIM 20 the relationship is different from what was modelled in 1b). Hence a prediction of the citrate concentration would be <strong>extrapolation</strong> which is not allowed here.</p>
</section>
</section>
<section id="problem-2-fixed-linear-effects-model" class="level1">
<h1>Problem 2: Fixed Linear Effects Model</h1>
<p>In the dataset below, the influence of the breed on the citrate concentration in milk is investigated.</p>
<p></p>
<div id="tbl-p02-show" class="cell anchored">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Cow</th>
<th style="text-align: right;">DIM</th>
<th style="text-align: left;">Breed</th>
<th style="text-align: right;">Citrate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.71</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.99</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.84</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.87</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.57</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">27</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.57</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.66</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.80</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.80</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.67</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.63</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.83</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.76</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.95</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.67</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.56</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The dataset is available from</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>https://charlotte-ngs.github.io/asmasss2024/data/asm_exam_2024_p02.csv </code></pre>
</div>
</div>
<section id="solution-4" class="level2">
<h2 class="anchored" data-anchor-id="solution-4">Solution</h2>
<p>The fixed linear effects model is fitted as follows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lm_cit_dim_br <span class="ot">&lt;-</span> <span class="fu">lm</span>(Citrate <span class="sc">~</span> DIM <span class="sc">+</span> Breed, <span class="at">data =</span> tbl_p02)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_cit_dim_br)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Citrate ~ DIM + Breed, data = tbl_p02)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41096 -0.16520 -0.02042  0.18088  0.41835 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  9.481374   0.245866  38.563  &lt; 2e-16 ***
DIM         -0.023621   0.008004  -2.951 0.008936 ** 
BreedHO      0.609940   0.124814   4.887 0.000139 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2689 on 17 degrees of freedom
Multiple R-squared:  0.6144,    Adjusted R-squared:  0.569 
F-statistic: 13.54 on 2 and 17 DF,  p-value: 0.0003038</code></pre>
</div>
</div>
</section>
<section id="solution-5" class="level2">
<h2 class="anchored" data-anchor-id="solution-5">Solution</h2>
<p>Estimates for the regression slope is: -0.0236211</p>
<p>Group means are determined based on the dataset as check</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>tbl_gr_means_p02 <span class="ot">&lt;-</span> tbl_p02 <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Breed) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">GrM_Cit =</span> <span class="fu">mean</span>(Citrate),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">GrM_DIM =</span> <span class="fu">mean</span>(DIM))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>tbl_gr_means_p02</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  Breed GrM_Cit GrM_DIM
  &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 BS       8.80    29  
2 HO       9.31    32.9</code></pre>
</div>
</div>
<p>Group means based on modelling results for breed BS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>] <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  tbl_gr_means_p02<span class="sc">$</span>GrM_DIM[tbl_gr_means_p02<span class="sc">$</span>Breed <span class="sc">==</span> cur_breed] <span class="sc">*</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"DIM"</span>, <span class="st">"Estimate"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.796364</code></pre>
</div>
</div>
<p>Group means based on modelling results for breed HO</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>] <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  tbl_gr_means_p02<span class="sc">$</span>GrM_DIM[tbl_gr_means_p02<span class="sc">$</span>Breed <span class="sc">==</span> cur_breed] <span class="sc">*</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"DIM"</span>, <span class="st">"Estimate"</span>] <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"BreedHO"</span>, <span class="st">"Estimate"</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.314444</code></pre>
</div>
</div>
</section>
<section id="solution-6" class="level2">
<h2 class="anchored" data-anchor-id="solution-6">Solution</h2>
<p>Expected value of citrate concentration for animals of breed BS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>] <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  n_dim_pred <span class="sc">*</span> smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"DIM"</span>, <span class="st">"Estimate"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.772743</code></pre>
</div>
</div>
<p>Expected value of citrate concentration for animals of breed HO</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>] <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  n_dim_pred <span class="sc">*</span> smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"DIM"</span>, <span class="st">"Estimate"</span>] <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  smry_lm_cit_dim_br<span class="sc">$</span>coefficients[<span class="st">"BreedHO"</span>, <span class="st">"Estimate"</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.382683</code></pre>
</div>
</div>
</section>
</section>
<section id="problem-3-interactions" class="level1">
<h1>Problem 3: Interactions</h1>
<p>Use the following dataset to fit a fixed linear model assuming that the regression of <code>Citrate</code> on <code>DIM</code> shows an interaction with the <code>Breed</code> factor.</p>
<p></p>
<div id="tbl-p03-show" class="cell anchored">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Cow</th>
<th style="text-align: right;">DIM</th>
<th style="text-align: left;">Breed</th>
<th style="text-align: right;">Citrate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.21</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.51</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.34</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.37</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.53</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.07</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.75</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.74</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">27</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.30</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.20</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.75</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.36</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.30</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.49</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.17</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.06</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The dataset is available from</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>https://charlotte-ngs.github.io/asmasss2024/data/asm_exam_2024_p03.csv </code></pre>
</div>
</div>
<section id="solution-7" class="level2">
<h2 class="anchored" data-anchor-id="solution-7">Solution</h2>
<p>The fixed linear effects model including an interaction term between <code>DIM</code> and <code>Breed</code> is fitted to the data by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lm_cit_dim_br_inta <span class="ot">&lt;-</span> <span class="fu">lm</span>(Citrate <span class="sc">~</span> DIM <span class="sc">*</span> Breed, <span class="at">data =</span> tbl_p03)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br_inta <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_cit_dim_br_inta)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_dim_br_inta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Citrate ~ DIM * Breed, data = tbl_p03)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40476 -0.13973  0.00115  0.13979  0.40915 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.618906   0.274677  31.378 8.45e-16 ***
DIM         -0.011122   0.009131  -1.218  0.24084    
BreedHO      1.655131   0.481022   3.441  0.00336 ** 
DIM:BreedHO -0.032311   0.014883  -2.171  0.04531 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2423 on 16 degrees of freedom
Multiple R-squared:  0.7172,    Adjusted R-squared:  0.6642 
F-statistic: 13.53 on 3 and 16 DF,  p-value: 0.0001181</code></pre>
</div>
</div>
</section>
<section id="solution-8" class="level2">
<h2 class="anchored" data-anchor-id="solution-8">Solution</h2>
<p>The expected difference in citrate concentration in the milk for animals of breed</p>
<ul>
<li>BS corresponds to the regression coefficient times the difference in DIM</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n_delta_dim <span class="ot">&lt;-</span> n_dim_end_intac <span class="sc">-</span> n_dim_start_intac</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n_delta_citr_bs <span class="ot">&lt;-</span> smry_lm_cit_dim_br_inta<span class="sc">$</span>coefficients[<span class="st">"DIM"</span>, <span class="st">"Estimate"</span>] <span class="sc">*</span> n_delta_dim</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>n_delta_citr_bs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1112216</code></pre>
</div>
</div>
<ul>
<li>HO corresponds to the regression coefficient plus the interaction term times the difference in DIM</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>n_delta_dim <span class="ot">&lt;-</span> n_dim_end_intac <span class="sc">-</span> n_dim_start_intac</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>n_delta_citr_ho <span class="ot">&lt;-</span> (smry_lm_cit_dim_br_inta<span class="sc">$</span>coefficients[<span class="st">"DIM"</span>, <span class="st">"Estimate"</span>] <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                      smry_lm_cit_dim_br_inta<span class="sc">$</span>coefficients[<span class="st">"DIM:BreedHO"</span>, <span class="st">"Estimate"</span>]) <span class="sc">*</span> n_delta_dim</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>n_delta_citr_ho</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.4343358</code></pre>
</div>
</div>
<!--

\clearpage
\pagebreak


\begin{enumerate}
\item[c)] 

\textit{}
\end{enumerate}
\points{0}


## Solution

-->
</section>
</section>
<section id="problem-4-contrasts" class="level1">
<h1>Problem 4: Contrasts</h1>
<p>The dataset below is used to fit a fixed linear effects model with <code>Citrate</code> as response and <code>Breed</code> as fixed effect.</p>
<p></p>
<div id="tbl-p04-show" class="cell anchored">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Cow</th>
<th style="text-align: left;">Breed</th>
<th style="text-align: right;">Citrate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.71</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.99</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.84</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.87</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.57</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.57</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.66</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.80</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.80</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.67</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.63</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.83</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.76</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.95</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.67</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.56</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The dataset is available from</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>https://charlotte-ngs.github.io/asmasss2024/data/asm_exam_2024_p04.csv </code></pre>
</div>
</div>
<section id="solution-9" class="level2">
<h2 class="anchored" data-anchor-id="solution-9">Solution</h2>
<p>Treatment contrasts are used by default by <code>lm()</code> when fitting a FLEM. Hence the fit is obtained by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lm_cit_br <span class="ot">&lt;-</span> <span class="fu">lm</span>(Citrate <span class="sc">~</span> Breed, <span class="at">data =</span> tbl_p04)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_cit_br)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Citrate ~ Breed, data = tbl_p04)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.55444 -0.15886 -0.04136  0.23912  0.67556 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.7964     0.0969  90.774  &lt; 2e-16 ***
BreedHO       0.5181     0.1445   3.586  0.00211 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3214 on 18 degrees of freedom
Multiple R-squared:  0.4168,    Adjusted R-squared:  0.3844 
F-statistic: 12.86 on 1 and 18 DF,  p-value: 0.00211</code></pre>
</div>
</div>
<p>Assuming treatment contrasts, verification via group means is done as follows</p>
<ul>
<li>Intercept estimate corresponds to the mean of all BS animals</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tbl_p04<span class="sc">$</span>Citrate[tbl_p04<span class="sc">$</span>Breed <span class="sc">==</span> <span class="st">"BS"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.796364</code></pre>
</div>
</div>
<p>This is expected to be the same as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.796364</code></pre>
</div>
</div>
<ul>
<li>The difference between the group means of HO animals minus the group mean of the BS animals corresponds to the reported breed effect, hence</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tbl_p04<span class="sc">$</span>Citrate[tbl_p04<span class="sc">$</span>Breed <span class="sc">==</span> <span class="st">"HO"</span>]) <span class="sc">-</span> <span class="fu">mean</span>(tbl_p04<span class="sc">$</span>Citrate[tbl_p04<span class="sc">$</span>Breed <span class="sc">==</span> <span class="st">"BS"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5180808</code></pre>
</div>
</div>
<p>is expected to be the same as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br<span class="sc">$</span>coefficients[<span class="st">"BreedHO"</span>, <span class="st">"Estimate"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5180808</code></pre>
</div>
</div>
<ul>
<li>The breed effect estimated can also be verified via solutions of the least squares normal equations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mat_X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Citrate <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Breed, tbl_p04)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(mat_X, <span class="st">"assign"</span>) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(mat_X, <span class="st">"contrasts"</span>) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mat_X) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>mat_X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(mat_X)), <span class="at">ncol =</span> <span class="dv">1</span>), mat_X)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>mat_xtx <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>mat_xtx_ginv <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">ginv</span>(mat_xtx)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>mat_xty <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X, tbl_p04<span class="sc">$</span>Citrate)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>mat_b_sol <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_xtx_ginv, mat_xty)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>mat_b_sol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 6.036936
[2,] 2.759428
[3,] 3.277508</code></pre>
</div>
</div>
<p>Contrasts matrix for <code>treatment</code> contrasts</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fac_breed <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(tbl_p04<span class="sc">$</span>Breed)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>contr_mat_breed_treat <span class="ot">&lt;-</span> <span class="fu">contrasts</span>(fac_breed)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>contr_mat_breed_treat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(contr_mat_breed_treat)), <span class="at">ncol =</span> <span class="dv">1</span>), </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                               contr_mat_breed_treat)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>est_mat_breed_treat <span class="ot">&lt;-</span> <span class="fu">solve</span>(contr_mat_breed_treat)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>est_mat_breed_treat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   BS HO
    1  0
HO -1  1</code></pre>
</div>
</div>
<p>For the effects estimates, we are looking at the second and the third row of the matrix <code>est_mat_breed_treat</code>. We are prepending a column of zeroes to the second and the third row of <code>est_mat_breed_treat</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>n_nrow_est_mat <span class="ot">&lt;-</span> <span class="fu">nrow</span>(est_mat_breed_treat)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mat_q_efun <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> (<span class="fu">nrow</span>(est_mat_breed_treat)<span class="sc">-</span><span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">1</span>),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">matrix</span>(est_mat_breed_treat[<span class="dv">2</span><span class="sc">:</span>n_nrow_est_mat,], </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">nrow =</span> (<span class="fu">nrow</span>(est_mat_breed_treat)<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">crossprod</span>(<span class="fu">t</span>(mat_q_efun), mat_b_sol) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.5180808</code></pre>
</div>
</div>
</section>
<section id="solution-10" class="level2">
<h2 class="anchored" data-anchor-id="solution-10">Solution</h2>
<p>The fixed linear effects model using <code>sum</code> contrasts is fitted as shown below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>lm_cit_br_csum <span class="ot">&lt;-</span> <span class="fu">lm</span>(Citrate <span class="sc">~</span> Breed, <span class="at">data =</span> tbl_p04, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">Breed =</span> <span class="st">"contr.sum"</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br_csum <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_cit_br_csum)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br_csum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Citrate ~ Breed, data = tbl_p04, contrasts = list(Breed = "contr.sum"))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.55444 -0.15886 -0.04136  0.23912  0.67556 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  9.05540    0.07223 125.373  &lt; 2e-16 ***
Breed1      -0.25904    0.07223  -3.586  0.00211 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3214 on 18 degrees of freedom
Multiple R-squared:  0.4168,    Adjusted R-squared:  0.3844 
F-statistic: 12.86 on 1 and 18 DF,  p-value: 0.00211</code></pre>
</div>
</div>
<ul>
<li>Contrasts Matrix for Sum Contrasts From the contrasts matrix, we get the matrix of estimable functions.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fac_breed <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(tbl_p04<span class="sc">$</span>Breed)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>contr_mat_breed_sum <span class="ot">&lt;-</span> <span class="fu">contrasts</span>(<span class="fu">C</span>(fac_breed, sum))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>contr_mat_breed_sum <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(contr_mat_breed_sum)), <span class="at">ncol =</span> <span class="dv">1</span>), contr_mat_breed_sum)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>est_mat_breed_sum <span class="ot">&lt;-</span> <span class="fu">solve</span>(contr_mat_breed_sum)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>est_mat_breed_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      BS   HO
[1,] 0.5  0.5
[2,] 0.5 -0.5</code></pre>
</div>
</div>
<p>The matrix <code>est_mat_breed_sum</code> tells us that the estimate for the intercept (first row) is computed as the mean of the group means for the two breeds and the estimate for the breed effect (second row) is computed as half of the difference between group means for the first breed minus the group mean of the second breed.</p>
<p>Hence the estimate of the intercept is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="fu">mean</span>(tbl_p04<span class="sc">$</span>Citrate[tbl_p04<span class="sc">$</span>Breed <span class="sc">==</span> <span class="st">"BS"</span>]),</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mean</span>(tbl_p04<span class="sc">$</span>Citrate[tbl_p04<span class="sc">$</span>Breed <span class="sc">==</span> <span class="st">"HO"</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.055404</code></pre>
</div>
</div>
<p>and has to be equal to</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br_csum<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.055404</code></pre>
</div>
</div>
<p>The estimate for the breed-effect is obtained by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">mean</span>(tbl_p04<span class="sc">$</span>Citrate[tbl_p04<span class="sc">$</span>Breed <span class="sc">==</span> <span class="st">"BS"</span>]) <span class="sc">-</span> <span class="fu">mean</span>(tbl_p04<span class="sc">$</span>Citrate[tbl_p04<span class="sc">$</span>Breed <span class="sc">==</span> <span class="st">"HO"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2590404</code></pre>
</div>
</div>
<p>which is the same as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>smry_lm_cit_br_csum<span class="sc">$</span>coefficients[<span class="st">"Breed1"</span>, <span class="st">"Estimate"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2590404</code></pre>
</div>
</div>
<p>The verification with the solution of the least squares normal equation is done with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>n_nrow_est_mat <span class="ot">&lt;-</span> <span class="fu">nrow</span>(est_mat_breed_sum)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>mat_q_efun <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> (<span class="fu">nrow</span>(est_mat_breed_sum)<span class="sc">-</span><span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">1</span>),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">matrix</span>(est_mat_breed_sum[<span class="dv">2</span><span class="sc">:</span>n_nrow_est_mat,], </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">nrow =</span> (<span class="fu">nrow</span>(est_mat_breed_sum)<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">crossprod</span>(<span class="fu">t</span>(mat_q_efun), mat_b_sol) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] -0.2590404</code></pre>
</div>
</div>
<!--
\begin{enumerate}
\item[c)] 

\textit{}
\end{enumerate}
\points{0}


## Solution


\clearpage
\pagebreak

-->
</section>
</section>
<section id="problem-5-linear-mixed-effects-models" class="level1">
<h1>Problem 5: Linear Mixed Effects Models</h1>
<p>Use the dataset below to fit a linear mixed effects model. In this model <code>Citrate</code> is the response and <code>DIM</code> and <code>Breed</code> are regression variables and fixed effects, respectively. You do not have to include any interaction effects.</p>
<p></p>
<div id="tbl-p05-show" class="cell anchored">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ID</th>
<th style="text-align: right;">Sire</th>
<th style="text-align: right;">Dam</th>
<th style="text-align: right;">DIM</th>
<th style="text-align: left;">Breed</th>
<th style="text-align: right;">Citrate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.30</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.26</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.92</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.82</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.09</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">27</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.71</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.52</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">9.18</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.85</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.44</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">9.18</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">HO</td>
<td style="text-align: right;">8.96</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.74</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">BS</td>
<td style="text-align: right;">8.52</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The dataset is available from</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>https://charlotte-ngs.github.io/asmasss2024/data/asm_exam_2024_p05.csv </code></pre>
</div>
</div>
<section id="solution-11" class="level2">
<h2 class="anchored" data-anchor-id="solution-11">Solution</h2>
<ul>
<li>Model as equation:</li>
</ul>
<p><span class="math display">\[y = Xb + Zs + e\]</span> where</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y\)</span></td>
<td style="text-align: left;">vector of observations</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(b\)</span></td>
<td style="text-align: left;">vector of intercept, regression coefficient and fixed effects</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(s\)</span></td>
<td style="text-align: left;">vector of random sire breeding values</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(e\)</span></td>
<td style="text-align: left;">vector of random residuals</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(X\)</span></td>
<td style="text-align: left;">design matrix linking observations to fixed effects</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(Z\)</span></td>
<td style="text-align: left;">design matrix linking observations to sire breeding values</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Expected values and the variance-covariance matrices:</li>
</ul>
<p>Random effects are <span class="math inline">\(y\)</span>, <span class="math inline">\(s\)</span> and <span class="math inline">\(e\)</span>. Their expected values correspond to</p>
<p><span class="math display">\[E\left[\begin{array}{c}y \\ s \\ e \end{array}\right]
= \left[\begin{array}{c}Xb \\ 0 \\ 0 \end{array}\right]
\]</span></p>
<p>The variance-covariance matrices</p>
<p><span class="math display">\[
var\left[\begin{array}{c}y \\ s \\ e \end{array}\right]
= \left[\begin{array}{ccc} V &amp; ZS &amp; R \\ SZ^T &amp; S &amp; 0 \\ R &amp; 0 &amp; R \end{array}\right]
\]</span></p>
<p>where <span class="math inline">\(var(s) = S = I * \sigma_s^2\)</span>, <span class="math inline">\(var(e) = R = I * \sigma_e^2\)</span> and <span class="math inline">\(var(y) = V = ZSZ^T + R = ZZ^T\sigma_s^2 + R\)</span> with given sire-variance component <span class="math inline">\(\sigma_s^2\)</span> and given residual variance component <span class="math inline">\(\sigma_e^2\)</span>.</p>
<ul>
<li>Information from data to model components</li>
</ul>
<p><span class="math display">\[
y = \begin{bmatrix} 9.3 \\9.26 \\8.92 \\9.3 \\9.03 \\8.82 \\9.09 \\9.04 \\9.71 \\8.52 \\9.18 \\8.85 \\9.04 \\9.04 \\9.44 \\9.18 \\8.88 \\8.96 \\8.74 \\8.52\end{bmatrix}\text{, }b = \begin{bmatrix} b_0 \\b_{DIM} \\b_{BreedHO}\end{bmatrix}\text{, }s = \begin{bmatrix} s_{1} \\s_{2} \\s_{3} \\s_{4}\end{bmatrix}\text{, }e = \begin{bmatrix} e_{5} \\e_{6} \\e_{7} \\e_{8} \\e_{9} \\e_{10} \\e_{11} \\e_{12} \\e_{13} \\e_{14} \\e_{15} \\e_{16} \\e_{17} \\e_{18} \\e_{19} \\e_{20} \\e_{21} \\e_{22} \\e_{23} \\e_{24}\end{bmatrix}\]</span></p>
<p><span class="math display">\[
X = \begin{bmatrix} 1 &amp; 22 &amp; 0 \\1 &amp; 22 &amp; 1 \\1 &amp; 22 &amp; 0 \\1 &amp; 24 &amp; 0 \\1 &amp; 24 &amp; 0 \\1 &amp; 24 &amp; 0 \\1 &amp; 25 &amp; 0 \\1 &amp; 26 &amp; 1 \\1 &amp; 27 &amp; 1 \\1 &amp; 29 &amp; 0 \\1 &amp; 29 &amp; 0 \\1 &amp; 30 &amp; 0 \\1 &amp; 31 &amp; 1 \\1 &amp; 33 &amp; 1 \\1 &amp; 35 &amp; 1 \\1 &amp; 36 &amp; 1 \\1 &amp; 42 &amp; 1 \\1 &amp; 44 &amp; 1 \\1 &amp; 44 &amp; 0 \\1 &amp; 46 &amp; 0\end{bmatrix}\text{, }Z = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 0 \\0 &amp; 1 &amp; 0 &amp; 0 \\0 &amp; 1 &amp; 0 &amp; 0 \\0 &amp; 1 &amp; 0 &amp; 0 \\0 &amp; 1 &amp; 0 &amp; 0 \\0 &amp; 1 &amp; 0 &amp; 0 \\0 &amp; 0 &amp; 1 &amp; 0 \\0 &amp; 0 &amp; 1 &amp; 0 \\0 &amp; 0 &amp; 1 &amp; 0 \\0 &amp; 0 &amp; 1 &amp; 0 \\0 &amp; 0 &amp; 1 &amp; 0 \\0 &amp; 0 &amp; 1 &amp; 0 \\0 &amp; 0 &amp; 0 &amp; 1 \\0 &amp; 0 &amp; 0 &amp; 1 \\0 &amp; 0 &amp; 0 &amp; 1\end{bmatrix}\]</span></p>
<ul>
<li>Mixed model equations:</li>
</ul>
<p><span class="math display">\[
\left[
\begin{array}{cc}
X^TX  &amp;  X^TZ \\
Z^TX  &amp;  Z^TZ + \lambda_s * I
\end{array}
\right]
\left[
\begin{array}{c}
\hat{b} \\
\hat{s}
\end{array}
\right]
=
\left[
\begin{array}{c}
X^Ty \\
Z^Ty
\end{array}
\right]
\]</span></p>
<ul>
<li>Solutions of MME</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mat_xtx <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X_p05)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>mat_xtz <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X_p05, mat_Z_sire)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>mat_ztx <span class="ot">&lt;-</span> <span class="fu">t</span>(mat_xtz)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>mat_ztz_lAsinv <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_Z_sire) <span class="sc">+</span> n_lambda_s <span class="sc">*</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="at">nrow =</span> n_nr_sire)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>mat_coef_sire <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(mat_xtx, mat_xtz), <span class="fu">cbind</span>(mat_ztx, mat_ztz_lAsinv))</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>mat_rhs_sire <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">crossprod</span>(mat_X_p05, vec_y), <span class="fu">crossprod</span>(mat_Z_sire, vec_y))</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>mat_sol_sire <span class="ot">&lt;-</span> <span class="fu">solve</span>(mat_coef_sire, mat_rhs_sire)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>mat_sol_sire</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]
[1,]  9.5007575600
[2,] -0.0196080127
[3,]  0.3196246901
[4,]  0.0008951716
[5,]  0.0052561969
[6,] -0.0086811736
[7,]  0.0025298051</code></pre>
</div>
</div>
<ul>
<li>Estimates of intercept, regression coefficient and fixed effect for <code>BreedHO</code> are given by</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>tbl_sire_result <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">Effect =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Regression Coefficient"</span>, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"BreedHO Effect"</span>),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">Estimate =</span> mat_sol_sire[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,])</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tbl_sire_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: right;">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">9.5007576</td>
</tr>
<tr class="even">
<td style="text-align: left;">Regression Coefficient</td>
<td style="text-align: right;">-0.0196080</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BreedHO Effect</td>
<td style="text-align: right;">0.3196247</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Predicted breeding values for the sires are</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>vec_sire_pbv <span class="ot">&lt;-</span> mat_sol_sire[(<span class="fu">nrow</span>(mat_sol_sire)<span class="sc">-</span>n_nr_sire<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(mat_sol_sire),]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>vec_sire_pbv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.0008951716  0.0052561969 -0.0086811736  0.0025298051</code></pre>
</div>
</div>
<p>The order of the sires according to the predicted breeding values is given by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>vec_sire_pbv[<span class="fu">order</span>(vec_sire_pbv, <span class="at">decreasing =</span> T)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.0052561969  0.0025298051  0.0008951716 -0.0086811736</code></pre>
</div>
</div>
</section>
<section id="solution-12" class="level2">
<h2 class="anchored" data-anchor-id="solution-12">Solution</h2>
<ul>
<li>Model as equation:</li>
</ul>
<p><span class="math display">\[y = Xb + Zu + e\]</span> where</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y\)</span></td>
<td style="text-align: left;">vector of observations</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(b\)</span></td>
<td style="text-align: left;">vector of intercept, regression coefficient and fixed effects</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(u\)</span></td>
<td style="text-align: left;">vector of random breeding values</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(e\)</span></td>
<td style="text-align: left;">vector of random residuals</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(X\)</span></td>
<td style="text-align: left;">design matrix linking observations to fixed effects</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(Z\)</span></td>
<td style="text-align: left;">design matrix linking observations to sire breeding values</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Expected values and the variance-covariance matrices:</li>
</ul>
<p>Random effects are <span class="math inline">\(y\)</span>, <span class="math inline">\(u\)</span> and <span class="math inline">\(e\)</span>. Their expected values correspond to</p>
<p><span class="math display">\[E\left[\begin{array}{c}y \\ u \\ e \end{array}\right]
= \left[\begin{array}{c}Xb \\ 0 \\ 0 \end{array}\right]
\]</span></p>
<p>The variance-covariance matrices</p>
<p><span class="math display">\[
var\left[\begin{array}{c}y \\ u \\ e \end{array}\right]
= \left[\begin{array}{ccc} V &amp; ZU &amp; R \\ UZ^T &amp; U &amp; 0 \\ R &amp; 0 &amp; R \end{array}\right]
\]</span></p>
<p>where <span class="math inline">\(var(u) = U = A * \sigma_u^2\)</span>, <span class="math inline">\(var(e) = R = I * \sigma_e^2\)</span> and <span class="math inline">\(var(y) = V = ZUZ^T + R\)</span> with given additive genetic variance component <span class="math inline">\(\sigma_u^2\)</span> and given residual variance component <span class="math inline">\(\sigma_e^2\)</span>.</p>
<ul>
<li>Information from data to model components</li>
</ul>
<p><span class="math display">\[
y = \begin{bmatrix} 9.3 \\9.26 \\8.92 \\9.3 \\9.03 \\8.82 \\9.09 \\9.04 \\9.71 \\8.52 \\9.18 \\8.85 \\9.04 \\9.04 \\9.44 \\9.18 \\8.88 \\8.96 \\8.74 \\8.52\end{bmatrix}\text{, }b = \begin{bmatrix} b_0 \\b_{DIM} \\b_{BreedHO}\end{bmatrix}\text{, }u = \begin{bmatrix} u_{1} \\u_{2} \\u_{3} \\u_{4} \\u_{5} \\u_{6} \\u_{7} \\u_{8} \\u_{9} \\u_{10} \\u_{11} \\u_{12} \\u_{13} \\u_{14} \\u_{15} \\u_{16} \\u_{17} \\u_{18} \\u_{19} \\u_{20} \\u_{21} \\u_{22} \\u_{23} \\u_{24}\end{bmatrix}\text{, }e = \begin{bmatrix} e_{5} \\e_{6} \\e_{7} \\e_{8} \\e_{9} \\e_{10} \\e_{11} \\e_{12} \\e_{13} \\e_{14} \\e_{15} \\e_{16} \\e_{17} \\e_{18} \\e_{19} \\e_{20} \\e_{21} \\e_{22} \\e_{23} \\e_{24}\end{bmatrix}\]</span></p>
<p><span class="math display">\[
X = \begin{bmatrix} 1 &amp; 22 &amp; 0 \\1 &amp; 22 &amp; 1 \\1 &amp; 22 &amp; 0 \\1 &amp; 24 &amp; 0 \\1 &amp; 24 &amp; 0 \\1 &amp; 24 &amp; 0 \\1 &amp; 25 &amp; 0 \\1 &amp; 26 &amp; 1 \\1 &amp; 27 &amp; 1 \\1 &amp; 29 &amp; 0 \\1 &amp; 29 &amp; 0 \\1 &amp; 30 &amp; 0 \\1 &amp; 31 &amp; 1 \\1 &amp; 33 &amp; 1 \\1 &amp; 35 &amp; 1 \\1 &amp; 36 &amp; 1 \\1 &amp; 42 &amp; 1 \\1 &amp; 44 &amp; 1 \\1 &amp; 44 &amp; 0 \\1 &amp; 46 &amp; 0\end{bmatrix}\]</span></p>
<p><span class="math display">\[
Z = \]</span></p>
<ul>
<li>Mixed model equations:</li>
</ul>
<p><span class="math display">\[
\left[
\begin{array}{cc}
X^TX  &amp;  X^TZ \\
Z^TX  &amp;  Z^TZ + \lambda_u * A^{-1}
\end{array}
\right]
\left[
\begin{array}{c}
\hat{b} \\
\hat{u}
\end{array}
\right]
=
\left[
\begin{array}{c}
X^Ty \\
Z^Ty
\end{array}
\right]
\]</span></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lme4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>'as(&lt;dtTMatrix&gt;, "dtCMatrix")' is deprecated.
Use 'as(., "CsparseMatrix")' instead.
See help("Deprecated") and help("Matrix-deprecated").</code></pre>
</div>
</div>
<p>where <span class="math inline">\(\lambda_u = \frac{\sigma_e^2}{\sigma_u^2} = 1.78\)</span> and <span class="math inline">\(A\)</span> corresponds to the numerator relationship matrix given by</p>
<p><span class="math display">\[A =  \]</span></p>
<p>The inverse <span class="math inline">\(A_s^{-1}\)</span> is</p>
<p><span class="math display">\[A^{-1} = \]</span></p>
<ul>
<li>Solutions of MME</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>mat_xtx <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X_p05)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>mat_xtz <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X_p05, mat_Z_ani)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>mat_ztx <span class="ot">&lt;-</span> <span class="fu">t</span>(mat_xtz)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>mat_ztz_lAinv <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_Z_ani) <span class="sc">+</span> n_lambda_u <span class="sc">*</span> mat_A_inv</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>mat_coef_ani <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(mat_xtx, mat_xtz), <span class="fu">cbind</span>(mat_ztx, mat_ztz_lAinv))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>mat_rhs_ani <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">crossprod</span>(mat_X_p05, vec_y), <span class="fu">crossprod</span>(mat_Z_ani, vec_y))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>mat_sol_ani <span class="ot">&lt;-</span> <span class="fu">solve</span>(mat_coef_ani, mat_rhs_ani)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>mat_sol_ani</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
    9.539690005
   -0.021267432
    0.349117898
1  -0.019522398
2   0.015023764
3  -0.007240318
4   0.004130529
5   0.060900627
6  -0.069010391
7  -0.025382473
8   0.066991716
9  -0.015315320
10 -0.100579302
11  0.036875067
12 -0.065712408
13  0.109473105
14 -0.046579510
15  0.050600530
16 -0.019246384
17 -0.080664433
18 -0.072272549
19  0.076382029
20  0.024028396
21 -0.053822726
22 -0.022512425
23  0.074186722
24  0.035268929</code></pre>
</div>
</div>
<ul>
<li>Estimates of intercept, regression coefficient and fixed effect for <code>BreedHO</code> are given by</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>tbl_ani_result <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">Effect =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Regression Coefficient"</span>, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"BreedHO Effect"</span>),</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">Estimate =</span> mat_sol_ani[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,])</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tbl_ani_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: right;">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">9.5396900</td>
</tr>
<tr class="even">
<td style="text-align: left;">Regression Coefficient</td>
<td style="text-align: right;">-0.0212674</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BreedHO Effect</td>
<td style="text-align: right;">0.3491179</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Predicted breeding values for all animals: The first two elements are solutions of fixed effects, the remaining elements are predicted breeding values</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Animals</th>
<th style="text-align: right;">Predicted Breeding Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.0195224</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0150238</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-0.0072403</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0041305</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0609006</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">-0.0690104</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-0.0253825</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.0669917</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">-0.0153153</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">-0.1005793</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.0368751</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0657124</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.1094731</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.0465795</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.0506005</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">-0.0192464</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">-0.0806644</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">-0.0722725</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.0763820</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.0240284</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td style="text-align: right;">-0.0538227</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td style="text-align: right;">-0.0225124</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.0741867</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.0352689</td>
</tr>
</tbody>
</table>
</div>
</div>
<!--
\clearpage
\pagebreak


\begin{enumerate}
\item[c)] 

\textit{}
\end{enumerate}
\points{0}


## Solution

-->
</section>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Chen2023b" class="csl-entry" role="listitem">
Chen, Yansen, Hongqing Hu, Nicolas Gengler, Cl’ement Grelet, and Katrien Wijnrocx. 2023. <span>“<span class="nocase">Genetic analysis of milk citrate predicted by milk mid- infrared spectra of Holstein cows in early lactation</span>.”</span> <em>J. Dairy Sci.</em> <a href="https://doi.org/10.3168/jds.2023-23903">https://doi.org/10.3168/jds.2023-23903</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>