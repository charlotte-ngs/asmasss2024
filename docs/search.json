[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome to the Website of",
    "section": "",
    "text": "751-7602-00L Applied Statistical Methods in Animal Sciences"
  },
  {
    "objectID": "index.html#topics-for-master-theses",
    "href": "index.html#topics-for-master-theses",
    "title": "Welcome to the Website of",
    "section": "Topics for Master Theses",
    "text": "Topics for Master Theses\nTopics for Master Theses at Qualitas AG together with ETH will follow here …"
  },
  {
    "objectID": "index.html#information",
    "href": "index.html#information",
    "title": "Welcome to the Website of",
    "section": "Information",
    "text": "Information\n\nLecturer: Peter von Rohr\nDate: Montag 8-10\nRoom: LFW C11\n\n\nExercise Platform\nThree options are available\n\nWebr: https://webr.r-wasm.org/latest\nPosit cloud: https://posit.cloud\nRun your own platform: Follow steps on https://posit.co/download/rstudio-desktop\n\nA more detailed description is available from here\n\n\nExam\n\nWritten exam\nDate: 27.05.2024 - 08:15 - 10:00\nRoom: LFW C 11\nData Read Statements: asm_exam_read_data"
  },
  {
    "objectID": "index.html#description",
    "href": "index.html#description",
    "title": "Welcome to the Website of",
    "section": "Description",
    "text": "Description\nThe following descriptions are taken from the course catalog\n\nApplied Statistical Methods in Animal Science\nGenomic selection is currently the method of choice for improving the genetic potential of selection candidates in livestock breeding programs. This lecture introduces the reason why regression cannot be used in genomic selection. Alternatives to regression analysis that are suitable for genomic selection are presented. The concepts introduced are illustrated by excersises in R.\nThe students are familiar with the properties of multiple linear regression and they are able to analyse simple data sets using regression methods. The students know why multiple linear regression cannot be used for genomic selection. The students know the statistical methods used in genomic selection, such as BLUP-based approaches, Bayesian procedures and LASSO. The students are able to solve simple exercise problems using the statistical framework R."
  },
  {
    "objectID": "index.html#questions",
    "href": "index.html#questions",
    "title": "Welcome to the Website of",
    "section": "Questions",
    "text": "Questions\nQuestions can be asked during the lecture and during the exercise hour or via e-mail:\n\nPeter von Rohr (peter.vonrohr at usys.ethz.ch)"
  },
  {
    "objectID": "index.html#lecture-program",
    "href": "index.html#lecture-program",
    "title": "Welcome to the Website of",
    "section": "Lecture Program",
    "text": "Lecture Program\n\n\n\n\n\n\n\n\n\nWeek\nDate\nTopic\nLecture Mode\n\n\n\n\n1\n19.02\nIntroduction to Applied Statistical Methods in Animal Science\n\n\n\n2\n26.02\nLinear Regression Models\n\n\n\n3\n04.03\nLinear Fixed Effect Models\n\n\n\n4\n11.03\nModel Selection\n\n\n\n5\n18.03\nPedigree BLUP\n\n\n\n6\n25.03\nVariance Components\n\n\n\n7\n01.04\nEaster Monday (Ostermontag)\n\n\n\n8\n08.04\nGBLUP - Marker-Effects Models\n\n\n\n9\n15.04\nGBLUP - Breeding Value Models\n\n\n\n10\n22.04\nLasso\n\n\n\n11\n29.04\nSVM\n\n\n\n12\n06.05\nBayesian Approaches in Linear Mixed Effects Models\n\n\n\n13\n13.05\nTest Exam\n\n\n\n14\n20.05\nPentcote Monday (Pfingstmontag)\n\n\n\n15\n27.05\nExam"
  },
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Welcome to the Website of",
    "section": "License",
    "text": "License\nThis work is licensed under a Creative Commons Attribution 4.0 International License.\n\nLatest Changes: 2024-05-27 05:28:46 CEST (pvr)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Exam Data asm_exam_read_data"
  },
  {
    "objectID": "about.html#asmas---ss2024",
    "href": "about.html#asmas---ss2024",
    "title": "About",
    "section": "",
    "text": "Set up initial version of website"
  },
  {
    "objectID": "solutions.html",
    "href": "solutions.html",
    "title": "Solutions",
    "section": "",
    "text": "List of solutions to exercises\n\n\n\nNr\nDate\nTopic\n\n\n\n\n1\n2024-02-19\nIntroduction html | pdf\n\n\n2\n2024-02-26\nRead Data html | pdf\n\n\n3\n2024-03-11\nSimple Linear Regression html | pdf\n\n\n4\n2024-03-18\nMatrix-Vector-Notation html | pdf\n\n\n5\n2024-04-08\nGenomic Regression html | pdf\n\n\n6\n2024-04-29\nFixed Linear Effects Model html | pdf\n\n\n7\n2024-04-29\nContrasts html | pdf\n\n\n8\n2024-05-06\nInteractions and Simulation html | pdf\n\n\n9\n2024-05-13\nRepeated Observations html | pdf\n\n\n10\n2024-05-13\nTest Exam pdf\n\n\n11\n2024-05-20\nSire Model html | pdf\n\n\n12\n2024-05-20\nAnimal Model html | pdf\n\n\n\n\nLatest Changes: 2024-05-21 06:44:59 CEST (pvr)"
  },
  {
    "objectID": "course_notes.html",
    "href": "course_notes.html",
    "title": "Course Notes",
    "section": "",
    "text": "List of Chapters in the Course Notes"
  },
  {
    "objectID": "add_info.html",
    "href": "add_info.html",
    "title": "Additional Information",
    "section": "",
    "text": "Further information"
  },
  {
    "objectID": "exercises.html",
    "href": "exercises.html",
    "title": "Exercises",
    "section": "",
    "text": "List of exercises\n\n\n\nNr\nDate\nTopic\n\n\n\n\n1\n2024-02-19\nIntroduction\n\n\n2\n2024-02-26\nRead Data\n\n\n3\n2024-03-11\nLinear Regression\n\n\n4\n2024-03-18\nMatrix-Vector-Notation\n\n\n5\n2024-04-08\nGenomic Regression\n\n\n6\n2024-04-15\nFixed Linear Effects Model\n\n\n7\n2024-04-15\nContrasts\n\n\n8\n2024-04-29\nInteractions and Simulation\n\n\n9\n2024-05-06\nRepeated Observations\n\n\n10\n2024-05-13\nTest Exam\n\n\n11\n2024-05-20\nSire Model\n\n\n12\n2024-05-20\nAnimal Model\n\n\n\n\nLatest Changes: 2024-05-21 06:39:54 CEST (pvr)"
  },
  {
    "objectID": "exercises/asm_ex01/asm_ex01.html",
    "href": "exercises/asm_ex01/asm_ex01.html",
    "title": "Applied Statistical Methods - Solution 1",
    "section": "",
    "text": "The following dataset on body weight and on futher observations on a number of animals is given.\n\n\n?(caption)\n\n\n\n\n\n\nAnimal\nBreast Circumference\nBody Weight\nBCS\nHEI\n\n\n\n\n1\n176\n471\n5.0\n161\n\n\n2\n177\n463\n4.2\n121\n\n\n3\n178\n481\n4.9\n157\n\n\n4\n179\n470\n3.0\n165\n\n\n5\n179\n496\n6.8\n136\n\n\n6\n180\n491\n4.9\n123\n\n\n7\n181\n518\n4.4\n163\n\n\n8\n182\n511\n4.4\n149\n\n\n9\n183\n510\n3.5\n143\n\n\n10\n184\n541\n4.7\n130\n\n\n\n\n\n\nThe data can be read from https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_mult_reg.csv. The additional columns contain data on body condition score (BCS) and height (HEI).\n\n\n\nBuild a regression model of body weight on the other observations using the dataset given above.\nSet up the matrix \\(\\mathbf{X}\\) and the vectors \\(\\mathbf{y}\\), \\(\\mathbf{b}\\) and \\(\\mathbf{e}\\).\nCompute estimate for the regression coefficients in the model defined above.\n\n\n\n\n\n\nFirst, the data has to be read\ns_sol01_p01_path &lt;- \"https://charlotte-ngs.github.io/asmss2023/data/asm_bw_mult_reg.csv\"\ntbl_sol01_p01 &lt;- readr::read_csv(file = s_sol01_p01_path)"
  },
  {
    "objectID": "exercises/asm_ex01/asm_ex01.html#problem-1-regression-analysis",
    "href": "exercises/asm_ex01/asm_ex01.html#problem-1-regression-analysis",
    "title": "Applied Statistical Methods - Solution 1",
    "section": "",
    "text": "The following dataset on body weight and on futher observations on a number of animals is given.\n\n\n?(caption)\n\n\n\n\n\n\nAnimal\nBreast Circumference\nBody Weight\nBCS\nHEI\n\n\n\n\n1\n176\n471\n5.0\n161\n\n\n2\n177\n463\n4.2\n121\n\n\n3\n178\n481\n4.9\n157\n\n\n4\n179\n470\n3.0\n165\n\n\n5\n179\n496\n6.8\n136\n\n\n6\n180\n491\n4.9\n123\n\n\n7\n181\n518\n4.4\n163\n\n\n8\n182\n511\n4.4\n149\n\n\n9\n183\n510\n3.5\n143\n\n\n10\n184\n541\n4.7\n130\n\n\n\n\n\n\nThe data can be read from https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_mult_reg.csv. The additional columns contain data on body condition score (BCS) and height (HEI).\n\n\n\nBuild a regression model of body weight on the other observations using the dataset given above.\nSet up the matrix \\(\\mathbf{X}\\) and the vectors \\(\\mathbf{y}\\), \\(\\mathbf{b}\\) and \\(\\mathbf{e}\\).\nCompute estimate for the regression coefficients in the model defined above.\n\n\n\n\n\n\nFirst, the data has to be read\ns_sol01_p01_path &lt;- \"https://charlotte-ngs.github.io/asmss2023/data/asm_bw_mult_reg.csv\"\ntbl_sol01_p01 &lt;- readr::read_csv(file = s_sol01_p01_path)"
  },
  {
    "objectID": "slides/l01_intro/l01_intro.html#administration",
    "href": "slides/l01_intro/l01_intro.html#administration",
    "title": "Applied Statistical Methods In Animal Science",
    "section": "Administration",
    "text": "Administration\n\nCourse: 2 hours of lecture (2 V)\nPlan: 2 V \\(\\rightarrow\\) 1 U + 1 V (i.e., 1 hour of lecture intersperced with time to do exercises)\nExercises: Work on problems in R\nMaterial: course notes, slides, solution to exercises\nExam: written, date: 22.05.2023, 08:15-10:00"
  },
  {
    "objectID": "slides/l01_intro/l01_intro.html#objectives",
    "href": "slides/l01_intro/l01_intro.html#objectives",
    "title": "Applied Statistical Methods In Animal Science",
    "section": "Objectives",
    "text": "Objectives\nThe students\n\nare familiar with the properties of fixed linear effects models\nare able to analyse simple data sets\nknow why least squares cannot be used for genomic selection.\nknow the statistical methods used in genomic selection, such as\n\nBLUP-based approaches,\nBayesian procedures and\nLASSO.\n\nare able to solve simple exercise problems using the statistical framework R."
  },
  {
    "objectID": "slides/l01_intro/l01_intro.html#lecture-program",
    "href": "slides/l01_intro/l01_intro.html#lecture-program",
    "title": "Applied Statistical Methods In Animal Science",
    "section": "Lecture Program",
    "text": "Lecture Program\n\n\n\n\n\n\n\n\n\n\nWeek\nDate\nTopic\nLecture Mode\n\n\n\n\n1\n19.02\nIntroduction to Applied Statistical Methods in Animal Science\n\n\n\n2\n26.02\nLinear Regression Models\n\n\n\n3\n04.03\nLinear Fixed Effect Models\n\n\n\n4\n11.03\nModel Selection\n\n\n\n5\n18.03\nPedigree BLUP\n\n\n\n6\n25.03\nVariance Components\n\n\n\n7\n01.04\nEaster Monday (Ostermontag)\n\n\n\n8\n08.04\nGBLUP - Marker-Effects Models\n\n\n\n9\n15.04\nGBLUP - Breeding Value Models\n\n\n\n10\n22.04\nLasso\n\n\n\n11\n29.04\nSVM\n\n\n\n12\n06.05\nBayesian Approaches in Linear Mixed Effects Models\n\n\n\n13\n13.05\nTest Exam\n\n\n\n14\n20.05\nPentcote Monday (Pfingstmontag)\n\n\n\n15\n27.05\nExam"
  },
  {
    "objectID": "about.html#asmas---ss2024-v0.1.1",
    "href": "about.html#asmas---ss2024-v0.1.1",
    "title": "About",
    "section": "asmas - ss2024: v0.1.1",
    "text": "asmas - ss2024: v0.1.1\n\nChapters 1 and 2 of course notes\nSlides for introduction"
  },
  {
    "objectID": "about.html#asmas---ss2024-v0.1.0",
    "href": "about.html#asmas---ss2024-v0.1.0",
    "title": "About",
    "section": "asmas - ss2024: v0.1.0",
    "text": "asmas - ss2024: v0.1.0\n\nSet up initial version of website\n\n\nLatest Changes: 2024-05-27 05:26:13 CEST (pvr)"
  },
  {
    "objectID": "add_info.html#slides",
    "href": "add_info.html#slides",
    "title": "Additional Information",
    "section": "Slides",
    "text": "Slides\n\n\n\nNr\nDate\nTopic\n\n\n\n\n1\n2024-02-19\nIntroduction\n\n\n2\n2024-02-26\nLinear Regression\n\n\n3\n2024-03-18\nFixed Linear Effects Models\n\n\n4\n2024-03-25\nEstimable Functions\n\n\n5\n2024-04-15\nContrasts\n\n\n6\n2024-04-22\nInteractions\n\n\n7\n2024-04-22\nSimulation\n\n\n8\n2024-04-29\nRepeated Observations\n\n\n9\n2024-05-06\nTypes of Repeated Observations\n\n\n10\n2024-05-13\nApplications of LME"
  },
  {
    "objectID": "add_info.html#over-head-pictures",
    "href": "add_info.html#over-head-pictures",
    "title": "Additional Information",
    "section": "Over-Head Pictures",
    "text": "Over-Head Pictures\n\n\n\nNr\nDate\nTopic\n\n\n\n\n1\n2024-02-19\nIntroduction\n\n\n2\n2024-02-26\nRegression Residuals\n\n\n3\n2024-03-04\nDerive Regression Line\n\n\n4\n2024-03-11\nMultiple Linear Regression\n\n\n5\n2024-03-18\nFixed Linear Effects Models\n\n\n6\n2024-03-25\nLeast Squares Normal Equations\n\n\n7\n2024-04-08\nEstimable Functions\n\n\n8\n2024-04-15\nContrasts\n\n\n9\n2024-04-22\nInteractions and Simulation\n\n\n10\n2024-04-29\nRepeated Observations\n\n\n11\n2024-05-06\nType of Repeated Observations\n\n\n12\n2024-05-13\nApplications of LME\n\n\n\n\nLatest Changes: 2024-05-13 13:44:21 CEST (pvr)"
  },
  {
    "objectID": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-2",
    "href": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-2",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-3",
    "href": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-3",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-4",
    "href": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-4",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-5",
    "href": "ohp/20240219_ohp_l01/20240219_ohp_l01.html#ohp-picture-5",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "about.html#asmas---ss2024-v0.1.2",
    "href": "about.html#asmas---ss2024-v0.1.2",
    "title": "About",
    "section": "asmas - ss2024: v0.1.2",
    "text": "asmas - ss2024: v0.1.2\n\nOverhead pictures of lecture 1"
  },
  {
    "objectID": "misc/rexpf/rexpf_docu.html",
    "href": "misc/rexpf/rexpf_docu.html",
    "title": "Exercise Platform",
    "section": "",
    "text": "There are three different options available to work on examples and exercises. The table below (Table 1) provides some information on these options.\nTable 1: R Exercise Platforms\n\n\nNr\nPlatform\nLink\n\n\n\n\n1\nWebr\nhttps://webr.r-wasm.org/latest\n\n\n2\nPosit Cloud\nhttps://posit.cloud\n\n\n3\nYour own installation\nhttps://posit.co/download/rstudio-desktop"
  },
  {
    "objectID": "misc/rexpf/rexpf_docu.html#description",
    "href": "misc/rexpf/rexpf_docu.html#description",
    "title": "Exercise Platform",
    "section": "Description",
    "text": "Description\nThe three platforms all have advantages and disadvantages. Table 2 gives and overview of the characteristics of each platform\n\n\n\n\nTable 2: Characteristics of the three available R Exercise Platforms\n\n\n\n\n\n\n\nPlatform\nPros\nCons\n\n\n\n\nWebr\nRuns R in the browswer, no installation required.\nNo persistency, reloading browser removes everythiing\n\n\nPosit Cloud\nProvides full RStudio environment, accessible via browser\nNeed to register with posit, free version has limitations\n\n\nYour own installation\nFull flexibility and maximum possible freedom with respect to customisation, etc.\nAll problems are your responsibility, maybe need contacts to expert"
  },
  {
    "objectID": "misc/rexpf/rexpf_docu.html#further-details",
    "href": "misc/rexpf/rexpf_docu.html#further-details",
    "title": "Exercise Platform",
    "section": "Further Details",
    "text": "Further Details\n\nWebr\nPersistency means that R-code (programs or scripts) that you write are stored somewhere. With webr this storage is only kept as long as the current browser view is active. As soon as you hit the reload button or you close and re-open the browser window, all work (files and directories) is gone and cannot be restored.\nHence it is advisable to either write R-programs in a separate program called an editor (such as VSCode) and to import the programs to webr or to frequently export the R-programs to your local file-system storage.\nBecause webr runs completely in the browser, there. might be differences between different browsers. The material used in this course will be tested with Google Chrome. Other browsers might lead to a different user experience.\n\n\nPosit Cloud\nThe free version of posit cloud has limitations. They can be seen from the posit cloud website (https://posit.cloud/plans/free). These limitations should not be a problem for what we use the platform in our course.\n\n\nYour Own Installation\nRunning your own versions of R and RStudio gives you maximum flexibility with respect to adapting and configuring the environment. But one frequent problem with this option are the updates. R and RStudio publish new versions on a regular basis and these new versions must be installed. After installing a new version, some adaptations of installed packages must be done which is not always that easy."
  },
  {
    "objectID": "about.html#asmas---ss2024-v0.2.0",
    "href": "about.html#asmas---ss2024-v0.2.0",
    "title": "About",
    "section": "asmas - ss2024: v0.2.0",
    "text": "asmas - ss2024: v0.2.0\n\nDescription of R exercise platform\nData as Excel sheet on width and height\nData as comma separated list"
  },
  {
    "objectID": "my_nb/20240226_fitting_series_lines/20240226_fitting_series_lines.html",
    "href": "my_nb/20240226_fitting_series_lines/20240226_fitting_series_lines.html",
    "title": "Fitting a Series of Lines",
    "section": "",
    "text": "vec_width &lt;- c(82,65,76,80,78,70,72,70,65,73)\nvec_height &lt;-c(185,168,168,193,180,181,182,169,165,170)\nvec_height\n\n [1] 185 168 168 193 180 181 182 169 165 170\n\n# green line with \na &lt;- 170; b &lt;- 0.1\nvec_y_hat &lt;- a + vec_width * b\nvec_y_hat\n\n [1] 178.2 176.5 177.6 178.0 177.8 177.0 177.2 177.0 176.5 177.3\n\n# plot\n#plot(vec_width, vec_y_hat)\n#plot(vec_width, vec_height)\n\n# distance in y-direction\nvec_dist_y &lt;- vec_height - vec_y_hat\nvec_dist_y\n\n [1]   6.8  -8.5  -9.6  15.0   2.2   4.0   4.8  -8.0 -11.5  -7.3\n\nvec_dist_y^2\n\n [1]  46.24  72.25  92.16 225.00   4.84  16.00  23.04  64.00 132.25  53.29\n\nsum(vec_dist_y^2)\n\n[1] 729.07\n\n\nSeries of lines\n\nvec_width &lt;- c(82,65,76,80,78,70,72,70,65,73)\nvec_height &lt;-c(185,168,168,193,180,181,182,169,165,170)\n\n# green line with \na &lt;- 170; b &lt;- 0.1\nssq_min &lt;- .Machine$double.max.exp\nfor (a in c(min(vec_height):max(vec_height))){\n  for (b in seq(0.1,0.5,0.1)){\n    vec_y_hat &lt;- a + vec_width * b\n    vec_dist_y &lt;- vec_height - vec_y_hat\n    ssq &lt;- sum(vec_dist_y^2)\n    if (ssq &lt; ssq_min) ssq_min &lt;- ssq\n    cat(\"a: \", a, \" b: \", b, \" -- ssq: \", ssq, \" -- Min \", ssq_min, \"\\n\")\n  }\n}\n\na:  165  b:  0.1  -- ssq:  858.07  -- Min  858.07 \na:  165  b:  0.2  -- ssq:  778.08  -- Min  778.08 \na:  165  b:  0.3  -- ssq:  1773.03  -- Min  778.08 \na:  165  b:  0.4  -- ssq:  3842.92  -- Min  778.08 \na:  165  b:  0.5  -- ssq:  6987.75  -- Min  778.08 \na:  166  b:  0.1  -- ssq:  792.27  -- Min  778.08 \na:  166  b:  0.2  -- ssq:  858.48  -- Min  778.08 \na:  166  b:  0.3  -- ssq:  1999.63  -- Min  778.08 \na:  166  b:  0.4  -- ssq:  4215.72  -- Min  778.08 \na:  166  b:  0.5  -- ssq:  7506.75  -- Min  778.08 \na:  167  b:  0.1  -- ssq:  746.47  -- Min  746.47 \na:  167  b:  0.2  -- ssq:  958.88  -- Min  746.47 \na:  167  b:  0.3  -- ssq:  2246.23  -- Min  746.47 \na:  167  b:  0.4  -- ssq:  4608.52  -- Min  746.47 \na:  167  b:  0.5  -- ssq:  8045.75  -- Min  746.47 \na:  168  b:  0.1  -- ssq:  720.67  -- Min  720.67 \na:  168  b:  0.2  -- ssq:  1079.28  -- Min  720.67 \na:  168  b:  0.3  -- ssq:  2512.83  -- Min  720.67 \na:  168  b:  0.4  -- ssq:  5021.32  -- Min  720.67 \na:  168  b:  0.5  -- ssq:  8604.75  -- Min  720.67 \na:  169  b:  0.1  -- ssq:  714.87  -- Min  714.87 \na:  169  b:  0.2  -- ssq:  1219.68  -- Min  714.87 \na:  169  b:  0.3  -- ssq:  2799.43  -- Min  714.87 \na:  169  b:  0.4  -- ssq:  5454.12  -- Min  714.87 \na:  169  b:  0.5  -- ssq:  9183.75  -- Min  714.87 \na:  170  b:  0.1  -- ssq:  729.07  -- Min  714.87 \na:  170  b:  0.2  -- ssq:  1380.08  -- Min  714.87 \na:  170  b:  0.3  -- ssq:  3106.03  -- Min  714.87 \na:  170  b:  0.4  -- ssq:  5906.92  -- Min  714.87 \na:  170  b:  0.5  -- ssq:  9782.75  -- Min  714.87 \na:  171  b:  0.1  -- ssq:  763.27  -- Min  714.87 \na:  171  b:  0.2  -- ssq:  1560.48  -- Min  714.87 \na:  171  b:  0.3  -- ssq:  3432.63  -- Min  714.87 \na:  171  b:  0.4  -- ssq:  6379.72  -- Min  714.87 \na:  171  b:  0.5  -- ssq:  10401.75  -- Min  714.87 \na:  172  b:  0.1  -- ssq:  817.47  -- Min  714.87 \na:  172  b:  0.2  -- ssq:  1760.88  -- Min  714.87 \na:  172  b:  0.3  -- ssq:  3779.23  -- Min  714.87 \na:  172  b:  0.4  -- ssq:  6872.52  -- Min  714.87 \na:  172  b:  0.5  -- ssq:  11040.75  -- Min  714.87 \na:  173  b:  0.1  -- ssq:  891.67  -- Min  714.87 \na:  173  b:  0.2  -- ssq:  1981.28  -- Min  714.87 \na:  173  b:  0.3  -- ssq:  4145.83  -- Min  714.87 \na:  173  b:  0.4  -- ssq:  7385.32  -- Min  714.87 \na:  173  b:  0.5  -- ssq:  11699.75  -- Min  714.87 \na:  174  b:  0.1  -- ssq:  985.87  -- Min  714.87 \na:  174  b:  0.2  -- ssq:  2221.68  -- Min  714.87 \na:  174  b:  0.3  -- ssq:  4532.43  -- Min  714.87 \na:  174  b:  0.4  -- ssq:  7918.12  -- Min  714.87 \na:  174  b:  0.5  -- ssq:  12378.75  -- Min  714.87 \na:  175  b:  0.1  -- ssq:  1100.07  -- Min  714.87 \na:  175  b:  0.2  -- ssq:  2482.08  -- Min  714.87 \na:  175  b:  0.3  -- ssq:  4939.03  -- Min  714.87 \na:  175  b:  0.4  -- ssq:  8470.92  -- Min  714.87 \na:  175  b:  0.5  -- ssq:  13077.75  -- Min  714.87 \na:  176  b:  0.1  -- ssq:  1234.27  -- Min  714.87 \na:  176  b:  0.2  -- ssq:  2762.48  -- Min  714.87 \na:  176  b:  0.3  -- ssq:  5365.63  -- Min  714.87 \na:  176  b:  0.4  -- ssq:  9043.72  -- Min  714.87 \na:  176  b:  0.5  -- ssq:  13796.75  -- Min  714.87 \na:  177  b:  0.1  -- ssq:  1388.47  -- Min  714.87 \na:  177  b:  0.2  -- ssq:  3062.88  -- Min  714.87 \na:  177  b:  0.3  -- ssq:  5812.23  -- Min  714.87 \na:  177  b:  0.4  -- ssq:  9636.52  -- Min  714.87 \na:  177  b:  0.5  -- ssq:  14535.75  -- Min  714.87 \na:  178  b:  0.1  -- ssq:  1562.67  -- Min  714.87 \na:  178  b:  0.2  -- ssq:  3383.28  -- Min  714.87 \na:  178  b:  0.3  -- ssq:  6278.83  -- Min  714.87 \na:  178  b:  0.4  -- ssq:  10249.32  -- Min  714.87 \na:  178  b:  0.5  -- ssq:  15294.75  -- Min  714.87 \na:  179  b:  0.1  -- ssq:  1756.87  -- Min  714.87 \na:  179  b:  0.2  -- ssq:  3723.68  -- Min  714.87 \na:  179  b:  0.3  -- ssq:  6765.43  -- Min  714.87 \na:  179  b:  0.4  -- ssq:  10882.12  -- Min  714.87 \na:  179  b:  0.5  -- ssq:  16073.75  -- Min  714.87 \na:  180  b:  0.1  -- ssq:  1971.07  -- Min  714.87 \na:  180  b:  0.2  -- ssq:  4084.08  -- Min  714.87 \na:  180  b:  0.3  -- ssq:  7272.03  -- Min  714.87 \na:  180  b:  0.4  -- ssq:  11534.92  -- Min  714.87 \na:  180  b:  0.5  -- ssq:  16872.75  -- Min  714.87 \na:  181  b:  0.1  -- ssq:  2205.27  -- Min  714.87 \na:  181  b:  0.2  -- ssq:  4464.48  -- Min  714.87 \na:  181  b:  0.3  -- ssq:  7798.63  -- Min  714.87 \na:  181  b:  0.4  -- ssq:  12207.72  -- Min  714.87 \na:  181  b:  0.5  -- ssq:  17691.75  -- Min  714.87 \na:  182  b:  0.1  -- ssq:  2459.47  -- Min  714.87 \na:  182  b:  0.2  -- ssq:  4864.88  -- Min  714.87 \na:  182  b:  0.3  -- ssq:  8345.23  -- Min  714.87 \na:  182  b:  0.4  -- ssq:  12900.52  -- Min  714.87 \na:  182  b:  0.5  -- ssq:  18530.75  -- Min  714.87 \na:  183  b:  0.1  -- ssq:  2733.67  -- Min  714.87 \na:  183  b:  0.2  -- ssq:  5285.28  -- Min  714.87 \na:  183  b:  0.3  -- ssq:  8911.83  -- Min  714.87 \na:  183  b:  0.4  -- ssq:  13613.32  -- Min  714.87 \na:  183  b:  0.5  -- ssq:  19389.75  -- Min  714.87 \na:  184  b:  0.1  -- ssq:  3027.87  -- Min  714.87 \na:  184  b:  0.2  -- ssq:  5725.68  -- Min  714.87 \na:  184  b:  0.3  -- ssq:  9498.43  -- Min  714.87 \na:  184  b:  0.4  -- ssq:  14346.12  -- Min  714.87 \na:  184  b:  0.5  -- ssq:  20268.75  -- Min  714.87 \na:  185  b:  0.1  -- ssq:  3342.07  -- Min  714.87 \na:  185  b:  0.2  -- ssq:  6186.08  -- Min  714.87 \na:  185  b:  0.3  -- ssq:  10105.03  -- Min  714.87 \na:  185  b:  0.4  -- ssq:  15098.92  -- Min  714.87 \na:  185  b:  0.5  -- ssq:  21167.75  -- Min  714.87 \na:  186  b:  0.1  -- ssq:  3676.27  -- Min  714.87 \na:  186  b:  0.2  -- ssq:  6666.48  -- Min  714.87 \na:  186  b:  0.3  -- ssq:  10731.63  -- Min  714.87 \na:  186  b:  0.4  -- ssq:  15871.72  -- Min  714.87 \na:  186  b:  0.5  -- ssq:  22086.75  -- Min  714.87 \na:  187  b:  0.1  -- ssq:  4030.47  -- Min  714.87 \na:  187  b:  0.2  -- ssq:  7166.88  -- Min  714.87 \na:  187  b:  0.3  -- ssq:  11378.23  -- Min  714.87 \na:  187  b:  0.4  -- ssq:  16664.52  -- Min  714.87 \na:  187  b:  0.5  -- ssq:  23025.75  -- Min  714.87 \na:  188  b:  0.1  -- ssq:  4404.67  -- Min  714.87 \na:  188  b:  0.2  -- ssq:  7687.28  -- Min  714.87 \na:  188  b:  0.3  -- ssq:  12044.83  -- Min  714.87 \na:  188  b:  0.4  -- ssq:  17477.32  -- Min  714.87 \na:  188  b:  0.5  -- ssq:  23984.75  -- Min  714.87 \na:  189  b:  0.1  -- ssq:  4798.87  -- Min  714.87 \na:  189  b:  0.2  -- ssq:  8227.68  -- Min  714.87 \na:  189  b:  0.3  -- ssq:  12731.43  -- Min  714.87 \na:  189  b:  0.4  -- ssq:  18310.12  -- Min  714.87 \na:  189  b:  0.5  -- ssq:  24963.75  -- Min  714.87 \na:  190  b:  0.1  -- ssq:  5213.07  -- Min  714.87 \na:  190  b:  0.2  -- ssq:  8788.08  -- Min  714.87 \na:  190  b:  0.3  -- ssq:  13438.03  -- Min  714.87 \na:  190  b:  0.4  -- ssq:  19162.92  -- Min  714.87 \na:  190  b:  0.5  -- ssq:  25962.75  -- Min  714.87 \na:  191  b:  0.1  -- ssq:  5647.27  -- Min  714.87 \na:  191  b:  0.2  -- ssq:  9368.48  -- Min  714.87 \na:  191  b:  0.3  -- ssq:  14164.63  -- Min  714.87 \na:  191  b:  0.4  -- ssq:  20035.72  -- Min  714.87 \na:  191  b:  0.5  -- ssq:  26981.75  -- Min  714.87 \na:  192  b:  0.1  -- ssq:  6101.47  -- Min  714.87 \na:  192  b:  0.2  -- ssq:  9968.88  -- Min  714.87 \na:  192  b:  0.3  -- ssq:  14911.23  -- Min  714.87 \na:  192  b:  0.4  -- ssq:  20928.52  -- Min  714.87 \na:  192  b:  0.5  -- ssq:  28020.75  -- Min  714.87 \na:  193  b:  0.1  -- ssq:  6575.67  -- Min  714.87 \na:  193  b:  0.2  -- ssq:  10589.28  -- Min  714.87 \na:  193  b:  0.3  -- ssq:  15677.83  -- Min  714.87 \na:  193  b:  0.4  -- ssq:  21841.32  -- Min  714.87 \na:  193  b:  0.5  -- ssq:  29079.75  -- Min  714.87"
  },
  {
    "objectID": "ohp/20240226_ohp_l02/20240226_ohp_l02.html#ohp-picture-2",
    "href": "ohp/20240226_ohp_l02/20240226_ohp_l02.html#ohp-picture-2",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240226_ohp_l02/20240226_ohp_l02.html#ohp-picture-3",
    "href": "ohp/20240226_ohp_l02/20240226_ohp_l02.html#ohp-picture-3",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "about.html#asmasss2024-0.2.1",
    "href": "about.html#asmasss2024-0.2.1",
    "title": "About",
    "section": "asmasss2024 0.2.1",
    "text": "asmasss2024 0.2.1\n\nOHP-L02"
  },
  {
    "objectID": "NEWS.html",
    "href": "NEWS.html",
    "title": "asmasss2024 0.13.0",
    "section": "",
    "text": "asmasss2024 0.13.0\n\n\nasmasss2024 0.12.5\n\n\nasmasss2024 0.12.4\n\n\nasmasss2024 0.12.3\n\n\nasmasss2024 0.12.2\n\n\nasmasss2024 0.12.1\n\n\nasmasss2024 0.12.0\n\n\nasmasss2024 0.11.2\n\n\nasmasss2024 0.11.1\n\n\nasmasss2024 0.11.0\n\n\nasmasss2024 0.10.4\n\n\nasmasss2024 0.10.3\n\n\nasmasss2024 0.10.2\n\n\nasmasss2024 0.10.1\n\n\nasmasss2024 0.10.0\n\n\nasmasss2024 0.9.4\n\n\nasmasss2024 0.9.3\n\n\nasmasss2024 0.9.2\n\n\nasmasss2024 0.9.1\n\n\nasmasss2024 0.9.0\n\n\nasmasss2024 0.8.1\n\n\nasmasss2024 0.8.0\n\n\nasmasss2024 0.7.2\n\n\nasmasss2024 0.7.1\n\n\nasmasss2024 0.7.0\n\n\nasmasss2024 0.6.1\n\n\nasmasss2024 0.6.0\n\n\nasmasss2024 0.5.3\n\n\nasmasss2024 0.5.2\n\n\nasmasss2024 0.5.1\n\n\nasmasss2024 0.5.0\n\n\nasmasss2024 0.4.4\n\n\nasmasss2024 0.4.3\n\n\nasmasss2024 0.4.2\n\n\nasmasss2024 0.4.1\n\n\nasmasss2024 0.4.0\n\n\nasmasss2024 0.3.1\n\n\nasmasss2024 0.3.0\n\n\nasmasss2024 0.2.3\n\n\nasmasss2024 0.2.2\n\n\nasmasss2024 0.2.1\n\nInitial CRAN submission."
  },
  {
    "objectID": "about.html#asmasss2024-0.2.2",
    "href": "about.html#asmasss2024-0.2.2",
    "title": "About",
    "section": "asmasss2024 0.2.2",
    "text": "asmasss2024 0.2.2\n\nExercise 2: asm-ex02\nSolutions 1: html | pdf\nSolutions 2: html | pdf"
  },
  {
    "objectID": "about.html#asmasss2024-0.2.3",
    "href": "about.html#asmasss2024-0.2.3",
    "title": "About",
    "section": "asmasss2024 0.2.3",
    "text": "asmasss2024 0.2.3\n\nSlides l02_lin_regr"
  },
  {
    "objectID": "about.html#asmasss2024-0.3.0",
    "href": "about.html#asmasss2024-0.3.0",
    "title": "About",
    "section": "asmasss2024 0.3.0",
    "text": "asmasss2024 0.3.0\n\nAppendix on Linear Algebra"
  },
  {
    "objectID": "about.html#asmasss2024-0.3.1",
    "href": "about.html#asmasss2024-0.3.1",
    "title": "About",
    "section": "asmasss2024 0.3.1",
    "text": "asmasss2024 0.3.1\n\nOHP-L03"
  },
  {
    "objectID": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-2",
    "href": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-2",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-3",
    "href": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-3",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-4",
    "href": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-4",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-5",
    "href": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-5",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-6",
    "href": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-6",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 6",
    "text": "OHP Picture 6"
  },
  {
    "objectID": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-7",
    "href": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-7",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 7",
    "text": "OHP Picture 7"
  },
  {
    "objectID": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-8",
    "href": "ohp/20240304_ohp_l03/20240304_ohp_l03.html#ohp-picture-8",
    "title": "ASMAS-SS2024",
    "section": "OHP Picture 8",
    "text": "OHP Picture 8"
  },
  {
    "objectID": "about.html#asmasss2024-0.4.1",
    "href": "about.html#asmasss2024-0.4.1",
    "title": "About",
    "section": "asmasss2024 0.4.1",
    "text": "asmasss2024 0.4.1\n\nExercise asm_ex03"
  },
  {
    "objectID": "about.html#asmasss2024-0.4.2",
    "href": "about.html#asmasss2024-0.4.2",
    "title": "About",
    "section": "asmasss2024 0.4.2",
    "text": "asmasss2024 0.4.2\n\nCourse notes chapter 3"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html",
    "href": "slides/l03_flem/l03_flem.html",
    "title": "Fixed Linear Effects Models",
    "section": "",
    "text": "Animal\nBC\nBody Weight\nBCS\nHEI\nBreed\n\n\n\n\n1\n176\n471\n5.0\n161\nAngus\n\n\n2\n177\n463\n4.2\n121\nAngus\n\n\n3\n178\n481\n4.9\n157\nSimmental\n\n\n4\n179\n470\n3.0\n165\nAngus\n\n\n5\n179\n496\n6.8\n136\nSimmental\n\n\n6\n180\n491\n4.9\n123\nSimmental\n\n\n7\n181\n518\n4.4\n163\nLimousin\n\n\n8\n182\n511\n4.4\n149\nLimousin\n\n\n9\n183\n510\n3.5\n143\nLimousin\n\n\n10\n184\n541\n4.7\n130\nLimousin"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#extension-of-dataset-on-body-weight",
    "href": "slides/l03_flem/l03_flem.html#extension-of-dataset-on-body-weight",
    "title": "Fixed Linear Effects Models",
    "section": "",
    "text": "Animal\nBC\nBody Weight\nBCS\nHEI\nBreed\n\n\n\n\n1\n176\n471\n5.0\n161\nAngus\n\n\n2\n177\n463\n4.2\n121\nAngus\n\n\n3\n178\n481\n4.9\n157\nSimmental\n\n\n4\n179\n470\n3.0\n165\nAngus\n\n\n5\n179\n496\n6.8\n136\nSimmental\n\n\n6\n180\n491\n4.9\n123\nSimmental\n\n\n7\n181\n518\n4.4\n163\nLimousin\n\n\n8\n182\n511\n4.4\n149\nLimousin\n\n\n9\n183\n510\n3.5\n143\nLimousin\n\n\n10\n184\n541\n4.7\n130\nLimousin"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#include-breed-into-model",
    "href": "slides/l03_flem/l03_flem.html#include-breed-into-model",
    "title": "Fixed Linear Effects Models",
    "section": "Include Breed into Model",
    "text": "Include Breed into Model\n\nBreed has an influence on body weight\nPredictor variables must be numeric\nBreed must be converted to numeric code\nAssignment of codes to breeds is rather arbitrary"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#breed-codes",
    "href": "slides/l03_flem/l03_flem.html#breed-codes",
    "title": "Fixed Linear Effects Models",
    "section": "Breed Codes",
    "text": "Breed Codes\n\n\n\n\n\nCode\nBreed\n\n\n\n\n1\nAngus\n\n\n2\nLimousin\n\n\n3\nSimmental\n\n\n\n\n\nIn R: Encoding based on alpha-numeric order of factor names\n\nlevels(as.factor(tbl_flem$Breed))\n\n[1] \"Angus\"     \"Limousin\"  \"Simmental\"\n\n\n\nas.integer(as.factor(tbl_flem$Breed))\n\n [1] 1 1 3 1 3 3 2 2 2 2"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#dataset-with-breed-codes",
    "href": "slides/l03_flem/l03_flem.html#dataset-with-breed-codes",
    "title": "Fixed Linear Effects Models",
    "section": "Dataset with Breed Codes",
    "text": "Dataset with Breed Codes\n\n\n\n\n\nAnimal\nBody Weight\nBreed\nBreed Code\n\n\n\n\n1\n471\nAngus\n1\n\n\n2\n463\nAngus\n1\n\n\n3\n481\nSimmental\n3\n\n\n4\n470\nAngus\n1\n\n\n5\n496\nSimmental\n3\n\n\n6\n491\nSimmental\n3\n\n\n7\n518\nLimousin\n2\n\n\n8\n511\nLimousin\n2\n\n\n9\n510\nLimousin\n2\n\n\n10\n541\nLimousin\n2"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#modelling-effect-of-breed",
    "href": "slides/l03_flem/l03_flem.html#modelling-effect-of-breed",
    "title": "Fixed Linear Effects Models",
    "section": "Modelling Effect of Breed",
    "text": "Modelling Effect of Breed\n\nSimplification: “breed” is the only predictor\nTake breed code of animal \\(i\\) as the predictor value \\(x_i\\)\nExpected body weight (\\(y_i\\)) for animal \\(i\\)\n\n\\[E(y_i) = b_0 + b_1 x_i\\]"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#problems",
    "href": "slides/l03_flem/l03_flem.html#problems",
    "title": "Fixed Linear Effects Models",
    "section": "Problems",
    "text": "Problems\n\nNothing wrong with previous model\nBut the following relations might give a hint to some problems\n\n\\[\\begin{equation}\n\\left.\n\\begin{array}{l}\n\\text{Animal i of breed Angus} \\\\\n\\text{Animal j of breed Limousin} \\\\\n\\text{Animal k of breed Simmental}\n\\end{array}\n\\right\\}\n\\rightarrow\n\\left\\{\n\\begin{array}{l}\nE(y_i) = b_0 + b_1 * 1 \\\\\nE(y_j) = b_0 + b_1 * 2 \\\\\nE(y_k) = b_0 + b_1 * 3 \\\\\n\\end{array}\n\\right.\n\\notag\n\\end{equation}\\]\nThis means, for expected differences between body weights of animals of different breeds\n\\[\\begin{align}\nE(y_j) - E(y_i) &= E(y_k) - E(y_j) = b_1 \\notag \\\\\nE(y_k) - E(y_i) &= 2 * b_1  \\notag\n\\end{align}\\]"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#consequences",
    "href": "slides/l03_flem/l03_flem.html#consequences",
    "title": "Fixed Linear Effects Models",
    "section": "Consequences",
    "text": "Consequences\n\nAllocation of numerical codes imposes relations between expected values\nRelations might be unreasonable\nRegression analysis only yields estimates for \\(b_0\\) and \\(b_1\\), effects of other breeds are determined\nConclusion: regression on numerical codes of discrete variables are in most cases unreasonable\nException: Estimation of marker effects"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#linear-regression-analysis-for-genomic-data",
    "href": "slides/l03_flem/l03_flem.html#linear-regression-analysis-for-genomic-data",
    "title": "Fixed Linear Effects Models",
    "section": "Linear Regression Analysis for Genomic Data",
    "text": "Linear Regression Analysis for Genomic Data"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#marker-effect-estimation",
    "href": "slides/l03_flem/l03_flem.html#marker-effect-estimation",
    "title": "Fixed Linear Effects Models",
    "section": "Marker Effect Estimation",
    "text": "Marker Effect Estimation\n\nAssume: marker and QTL are very close, such they can no longer be distinguished\nFit regression of observations (y) on marker genotypes of locus \\(G\\)\nAssume \\(G_1\\) is the allele with a positive effect on observed trait\nUse the following encoding of marker genotypes to numeric values\n\n\n\n\n\n\nGenotype\nCode\n\n\n\n\n\\(G_1G_1\\)\n2\n\n\n\\(G_1G_2\\)\n1\n\n\n\\(G_2G_2\\)\n0\n\n\n\n\n\n\\(\\rightarrow\\) Biological meaning of genotype code: count number of \\(G_1\\) alleles"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#genomic-regression",
    "href": "slides/l03_flem/l03_flem.html#genomic-regression",
    "title": "Fixed Linear Effects Models",
    "section": "Genomic Regression",
    "text": "Genomic Regression"
  },
  {
    "objectID": "slides/l03_flem/l03_flem.html#model-fit",
    "href": "slides/l03_flem/l03_flem.html#model-fit",
    "title": "Fixed Linear Effects Models",
    "section": "Model Fit",
    "text": "Model Fit\n\nTake only homozygous genotypes \\(G_1G1\\) and \\(G_2G_2\\) from dataset\nWhy only homozygotes? Look at extreme values for \\(d\\) with over- and under-dominance\nFit regression line and compute marker effect \\(a\\)\nShift \\(x\\)- axis, such that homozygotes have values \\(-a\\) and \\(a\\)\nCompute \\(d\\) as deviation of heterozygotes from \\(0\\)"
  },
  {
    "objectID": "about.html#asmasss2024-0.4.3",
    "href": "about.html#asmasss2024-0.4.3",
    "title": "About",
    "section": "asmasss2024 0.4.3",
    "text": "asmasss2024 0.4.3\n\nSolutions asm_sol03"
  },
  {
    "objectID": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-2",
    "href": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.4.3",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-3",
    "href": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.4.3",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-4",
    "href": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.4.3",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-5",
    "href": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-5",
    "title": "ASMAS-SS2024 | 0.4.3",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-6",
    "href": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-6",
    "title": "ASMAS-SS2024 | 0.4.3",
    "section": "OHP Picture 6",
    "text": "OHP Picture 6"
  },
  {
    "objectID": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-7",
    "href": "ohp/20240311_ohp_l04/20240311_ohp_l04.html#ohp-picture-7",
    "title": "ASMAS-SS2024 | 0.4.3",
    "section": "OHP Picture 7",
    "text": "OHP Picture 7"
  },
  {
    "objectID": "about.html#asmasss2024-0.5.0",
    "href": "about.html#asmasss2024-0.5.0",
    "title": "About",
    "section": "asmasss2024 0.5.0",
    "text": "asmasss2024 0.5.0\n\nChapter 3.6 on Interactions"
  },
  {
    "objectID": "about.html#asmasss2024-0.5.1",
    "href": "about.html#asmasss2024-0.5.1",
    "title": "About",
    "section": "asmasss2024 0.5.1",
    "text": "asmasss2024 0.5.1\n\nExercise asm_ex04\nSlides on fixed linear effects models l03_flem"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html",
    "href": "slides/l04_est_fun/l04_est_fun.html",
    "title": "Estimable Functions",
    "section": "",
    "text": "Animal\nBreed\nObservation\n\n\n\n\n1\nAngus\n16\n\n\n2\nAngus\n10\n\n\n3\nAngus\n19\n\n\n4\nLimousin\n27\n\n\n5\nSimmental\n11\n\n\n6\nSimmental\n13"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#estimable-functions",
    "href": "slides/l04_est_fun/l04_est_fun.html#estimable-functions",
    "title": "Estimable Functions",
    "section": "",
    "text": "Animal\nBreed\nObservation\n\n\n\n\n1\nAngus\n16\n\n\n2\nAngus\n10\n\n\n3\nAngus\n19\n\n\n4\nLimousin\n27\n\n\n5\nSimmental\n11\n\n\n6\nSimmental\n13"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#model",
    "href": "slides/l04_est_fun/l04_est_fun.html#model",
    "title": "Estimable Functions",
    "section": "Model",
    "text": "Model\n\\[\\mathbf{y} = \\mathbf{Xb} + \\mathbf{e}\\]\n\\[\n\\mathbf{y} = \\begin{bmatrix} 16 \\\\10 \\\\19 \\\\27 \\\\11 \\\\13\\end{bmatrix}\\text{, }\\mathbf{X} = \\begin{bmatrix} 1 & 1 & 0 & 0 \\\\1 & 1 & 0 & 0 \\\\1 & 1 & 0 & 0 \\\\1 & 0 & 1 & 0 \\\\1 & 0 & 0 & 1 \\\\1 & 0 & 0 & 1\\end{bmatrix}\\text{ and }\\mathbf{b} = \\begin{bmatrix} \\mu \\\\\\alpha_1 \\\\\\alpha_2 \\\\\\alpha_3\\end{bmatrix}\n\\]"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#normal-equations",
    "href": "slides/l04_est_fun/l04_est_fun.html#normal-equations",
    "title": "Estimable Functions",
    "section": "Normal Equations",
    "text": "Normal Equations\n\\[ X^TXb^{(0)} = X^Ty\\]\n\\[\n\\begin{bmatrix} 6 & 3 & 1 & 2 \\\\3 & 3 & 0 & 0 \\\\1 & 0 & 1 & 0 \\\\2 & 0 & 0 & 2\\end{bmatrix}\\begin{bmatrix} \\mu^0 \\\\\\alpha_1^0 \\\\\\alpha_2^0 \\\\\\alpha_3^0\\end{bmatrix} = \\begin{bmatrix} 96 \\\\45 \\\\27 \\\\24\\end{bmatrix}\\]\nA solution\n\\[b^{(0)} = \\begin{bmatrix} 13.5 \\\\1.5 \\\\13.5 \\\\-1.5\\end{bmatrix}\\]"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#solutions-to-normal-equations",
    "href": "slides/l04_est_fun/l04_est_fun.html#solutions-to-normal-equations",
    "title": "Estimable Functions",
    "section": "Solutions to Normal Equations",
    "text": "Solutions to Normal Equations\n\n\n\n\n\nElements of Solution\n\\(b_1^0\\)\n\\(b_2^0\\)\n\\(b_3^0\\)\n\\(b_4^0\\)\n\n\n\n\n\\(\\mu^0\\)\n13.5\n15\n15.25\n15.5\n\n\n\\(\\alpha_1^0\\)\n1.5\n0\n-0.25\n-0.5\n\n\n\\(\\alpha_2^0\\)\n13.5\n12\n11.75\n11.5\n\n\n\\(\\alpha_3^0\\)\n-1.5\n-3\n-3.25\n-3.5"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#functions-of-solutions",
    "href": "slides/l04_est_fun/l04_est_fun.html#functions-of-solutions",
    "title": "Estimable Functions",
    "section": "Functions of Solutions",
    "text": "Functions of Solutions\n\n\n\n\n\n\n\n\n\n\n\n\nLinear Function\n\\(b_1^0\\)\n\\(b_2^0\\)\n\\(b_3^0\\)\n\\(b_4^0\\)\n\n\n\n\n\\(\\alpha_1^0 - \\alpha_2^0\\)\n-12.0\n-12.0\n-12.0\n-12.0\n\n\n\\(\\mu^0 + \\alpha_1^0\\)\n15.0\n15.0\n15.0\n15.0\n\n\n\\(\\mu^0 + 1/2(\\alpha_2^0 + \\alpha_3^0)\\)\n19.5\n19.5\n19.5\n19.5\n\n\n\n\n\n\n\\(\\alpha_1^0 - \\alpha_2^0\\): estimate of the difference between breed effects for Angus and Simmental\n\\(\\mu^0 + \\alpha_1^0\\): estimate of the general mean plus the breed effect of Angus\n\\(\\mu^0 + 1/2(\\alpha_2^0 + \\alpha_3^0)\\): estimate of the general mean plus mean effect of breeds Simmental and Limousin"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#definition-of-estimable-functions",
    "href": "slides/l04_est_fun/l04_est_fun.html#definition-of-estimable-functions",
    "title": "Estimable Functions",
    "section": "Definition of Estimable Functions",
    "text": "Definition of Estimable Functions\n\\[\\mathbf{q}^T\\mathbf{b} = \\mathbf{t}^TE(\\mathbf{y})\\]\n\nWhy is \\(\\mathbf{q}^T\\mathbf{b}\\) estimable?\nBased on the defintion of \\(\\mathbf{b}\\) and \\(E(\\mathbf{y})\\)\n\n\\[\\mathbf{q}^T\\mathbf{b} = \\mathbf{t}^T\\mathbf{XGX}^T\\mathbf{b} \\leftrightarrow\n\\mathbf{q}^T = \\mathbf{t}^T\\mathbf{X}\\] where \\(\\mathbf{XGX}^T\\) is the same for all choices of \\(\\mathbf{G}\\)"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#examples",
    "href": "slides/l04_est_fun/l04_est_fun.html#examples",
    "title": "Estimable Functions",
    "section": "Examples",
    "text": "Examples\n\\[E(y_{1j} - y_{2j}) = \\alpha_1 - \\alpha_2\\] with \\(\\mathbf{t}^T = \\left[\\begin{array}{cccccc} 1 & 1 & 1 & 0 & 0 & 0 \\end{array}\\right]\\) and \\(\\mathbf{q}^T = \\left[\\begin{array}{cccc} 0 & 1 & -1 & 0 \\end{array} \\right]\\)\n\\[E(y_{1j}) = \\mu + \\alpha_1\\] with \\(\\mathbf{t}^T = \\left[\\begin{array}{cccccc} 1 & 1 & 1 & 0 & 0 & 0 \\end{array}\\right]\\) and \\(\\mathbf{q}^T = \\left[\\begin{array}{cccc} 1 & 1 & 0 & 0 \\end{array} \\right]\\)\n\\[E(y_{2j}) = \\mu + \\alpha_2\\]\n\\[E(y_{3j}) = \\mu + \\alpha_3\\]"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#property",
    "href": "slides/l04_est_fun/l04_est_fun.html#property",
    "title": "Estimable Functions",
    "section": "Property",
    "text": "Property\nBased on the definition, the following property can be derived\n\\[\\mathbf{q}^t = \\mathbf{t}^T\\mathbf{X}\\] with the definition of an estimable function \\(\\mathbf{q}^T\\mathbf{b}\\), we get\n\\[\\mathbf{q}^T\\mathbf{b} = \\mathbf{t}^TE(\\mathbf{y})\\] \\[\\mathbf{q}^T\\mathbf{G}\\mathbf{X}^T\\mathbf{y} = \\mathbf{t}^T\\mathbf{X}\\mathbf{G}\\mathbf{X}^T\\mathbf{y}\\] hence for any \\(\\mathbf{G}\\), \\(\\mathbf{q}^t = \\mathbf{t}^T\\mathbf{X}\\) which is helpful to find \\(\\mathbf{q}\\) for a given \\(\\mathbf{t}\\)"
  },
  {
    "objectID": "slides/l04_est_fun/l04_est_fun.html#test",
    "href": "slides/l04_est_fun/l04_est_fun.html#test",
    "title": "Estimable Functions",
    "section": "Test",
    "text": "Test\nWhen we want to test whether a certain vector \\(\\mathbf{q}\\) can establish an estimable function, we can test wheter\n\\[\\mathbf{q}^T\\mathbf{H} = \\mathbf{q}^T\\]\nwith \\(\\mathbf{H} = \\mathbf{GX}^T\\mathbf{X}\\)\nSetting \\(\\mathbf{q}^T = \\mathbf{t}^T\\mathbf{X}\\), we get\n\\[\\mathbf{q}^T\\mathbf{H} = \\mathbf{t}^T\\mathbf{X}\\mathbf{H} = \\mathbf{t}^T\\mathbf{X} =  \\mathbf{q}^T \\]"
  },
  {
    "objectID": "about.html#asmasss2024-0.4.4",
    "href": "about.html#asmasss2024-0.4.4",
    "title": "About",
    "section": "asmasss2024 0.4.4",
    "text": "asmasss2024 0.4.4\n\nOverhead ohp_l04"
  },
  {
    "objectID": "about.html#asmasss2024-0.5.2",
    "href": "about.html#asmasss2024-0.5.2",
    "title": "About",
    "section": "asmasss2024 0.5.2",
    "text": "asmasss2024 0.5.2\n\nSolution asm_sol04"
  },
  {
    "objectID": "about.html#asmasss2024-0.5.3",
    "href": "about.html#asmasss2024-0.5.3",
    "title": "About",
    "section": "asmasss2024 0.5.3",
    "text": "asmasss2024 0.5.3\n\nOverhead ohp_l05"
  },
  {
    "objectID": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-2",
    "href": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.5.2",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-3",
    "href": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.5.2",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-4",
    "href": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.5.2",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-5",
    "href": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-5",
    "title": "ASMAS-SS2024 | 0.5.2",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-6",
    "href": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-6",
    "title": "ASMAS-SS2024 | 0.5.2",
    "section": "OHP Picture 6",
    "text": "OHP Picture 6"
  },
  {
    "objectID": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-7",
    "href": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-7",
    "title": "ASMAS-SS2024 | 0.5.2",
    "section": "OHP Picture 7",
    "text": "OHP Picture 7"
  },
  {
    "objectID": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-8",
    "href": "ohp/20240318_ohp_l05/20240318_ohp_l05.html#ohp-picture-8",
    "title": "ASMAS-SS2024 | 0.5.2",
    "section": "OHP Picture 8",
    "text": "OHP Picture 8"
  },
  {
    "objectID": "about.html#asmasss2024-0.6.0",
    "href": "about.html#asmasss2024-0.6.0",
    "title": "About",
    "section": "asmasss2024 0.6.0",
    "text": "asmasss2024 0.6.0\n\nSlides on estimable functions l04_est_fun"
  },
  {
    "objectID": "my_scripts/02_least_squares_regression/02_least_squares_regression.html",
    "href": "my_scripts/02_least_squares_regression/02_least_squares_regression.html",
    "title": "Validation of Least Squares Regression",
    "section": "",
    "text": "# read beef cattle data\ns_bw_bc_url &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_bc_reg.csv\"\ndf_bw_bc &lt;- read.table(s_bw_bc_url, header = T, sep = \",\")\ndf_bw_bc\n\n   Animal Breast.Circumference Body.Weight\n1       1                  176         471\n2       2                  177         463\n3       3                  178         481\n4       4                  179         470\n5       5                  179         496\n6       6                  180         491\n7       7                  181         518\n8       8                  182         511\n9       9                  183         510\n10     10                  184         541\n\n# Computations for slope estimate\nx &lt;- df_bw_bc$Breast.Circumference\ny &lt;- df_bw_bc$Body.Weight\nN &lt;- nrow(df_bw_bc)\n\nx_y_dot &lt;- sum(x*y)\nx_dot_bar &lt;- mean(x)\ny_dot_bar &lt;- mean(y)\nx_sq_dot &lt;- sum(x*x)\nb_1_hat &lt;- (x_y_dot - N * x_dot_bar * y_dot_bar) / (x_sq_dot - N * x_dot_bar^2)\nb_1_hat\n\n[1] 8.673235\n\n# Compuations for intercept\nb_0_hat &lt;- y_dot_bar - b_1_hat * x_dot_bar\nb_0_hat\n\n[1] -1065.115\n\n# Validation\nlm_bw_bc &lt;- lm(Body.Weight ~ Breast.Circumference, data = df_bw_bc)\nsummary(lm_bw_bc)\n\n\nCall:\nlm(formula = Body.Weight ~ Breast.Circumference, data = df_bw_bc)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17.3941  -6.5525  -0.0673   9.3707  13.2594 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)          -1065.115    255.483  -4.169 0.003126 ** \nBreast.Circumference     8.673      1.420   6.108 0.000287 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.08 on 8 degrees of freedom\nMultiple R-squared:  0.8234,    Adjusted R-squared:  0.8014 \nF-statistic: 37.31 on 1 and 8 DF,  p-value: 0.000287"
  },
  {
    "objectID": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-2",
    "href": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.6.0",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-3",
    "href": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.6.0",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-4",
    "href": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.6.0",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-5",
    "href": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-5",
    "title": "ASMAS-SS2024 | 0.6.0",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-6",
    "href": "ohp/20240325_ohp_l06/20240325_ohp_l06.html#ohp-picture-6",
    "title": "ASMAS-SS2024 | 0.6.0",
    "section": "OHP Picture 6",
    "text": "OHP Picture 6"
  },
  {
    "objectID": "about.html#asmasss2024-0.6.1",
    "href": "about.html#asmasss2024-0.6.1",
    "title": "About",
    "section": "asmasss2024 0.6.1",
    "text": "asmasss2024 0.6.1\n\nOverhead ohp_l06"
  },
  {
    "objectID": "about.html#asmasss2024-0.7.0",
    "href": "about.html#asmasss2024-0.7.0",
    "title": "About",
    "section": "asmasss2024 0.7.0",
    "text": "asmasss2024 0.7.0\n\nCorrections of course notes chapter 3"
  },
  {
    "objectID": "course_notes.html#list-of-appendix-chapters",
    "href": "course_notes.html#list-of-appendix-chapters",
    "title": "Course Notes",
    "section": "List of Appendix Chapters",
    "text": "List of Appendix Chapters\n\n\n\nNr\nDate\nTopic\n\n\n\n\n1\n2024-03-04\nLinear Algebra\n\n\n\n\nLatest Changes: 2024-05-13 05:04:17 CEST (pvr)"
  },
  {
    "objectID": "about.html#asmasss2024-0.7.1",
    "href": "about.html#asmasss2024-0.7.1",
    "title": "About",
    "section": "asmasss2024 0.7.1",
    "text": "asmasss2024 0.7.1\n\nData set on estimable functions\nExercise on genomic regression asm_ex05\nSolutions on genomic regression asm_sol05"
  },
  {
    "objectID": "about.html#asmasss2024-0.7.2",
    "href": "about.html#asmasss2024-0.7.2",
    "title": "About",
    "section": "asmasss2024 0.7.2",
    "text": "asmasss2024 0.7.2\n\nOverhead ohp_l07"
  },
  {
    "objectID": "about.html#asmasss2024-0.8.0",
    "href": "about.html#asmasss2024-0.8.0",
    "title": "About",
    "section": "asmasss2024 0.8.0",
    "text": "asmasss2024 0.8.0\n\nExercise on contrasts asm_ex07\nExercise on fixed linear effects model asm_ex06"
  },
  {
    "objectID": "about.html#asmasss2024-0.8.1",
    "href": "about.html#asmasss2024-0.8.1",
    "title": "About",
    "section": "asmasss2024 0.8.1",
    "text": "asmasss2024 0.8.1\n\nOverhead ohp_l08"
  },
  {
    "objectID": "my_scripts/20240415_contrasts/contrasts.html",
    "href": "my_scripts/20240415_contrasts/contrasts.html",
    "title": "Contrasts in Linear Models",
    "section": "",
    "text": "s_bw_br &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_breed.csv\"\ndf_bw_br &lt;- read.table(s_bw_br, header = T, sep=\",\")\ndf_bw_br\n\n   Animal Body.Weight     Breed\n1       1         471     Angus\n2       2         463     Angus\n3       4         470     Angus\n4       7         518  Limousin\n5       8         511  Limousin\n6       9         510  Limousin\n7      10         541  Limousin\n8       3         481 Simmental\n9       5         496 Simmental\n10      6         491 Simmental\n\n# contrasts for breed\nmat_ctr &lt;- contrasts(as.factor(df_bw_br$Breed))\n\n# assignment of new variable\nmodel.matrix(Body.Weight ~ Breed, df_bw_br)\n\n   (Intercept) BreedLimousin BreedSimmental\n1            1             0              0\n2            1             0              0\n3            1             0              0\n4            1             1              0\n5            1             1              0\n6            1             1              0\n7            1             1              0\n8            1             0              1\n9            1             0              1\n10           1             0              1\nattr(,\"assign\")\n[1] 0 1 1\nattr(,\"contrasts\")\nattr(,\"contrasts\")$Breed\n[1] \"contr.treatment\"\n\n# understand output of\nsummary(lm(Body.Weight ~ Breed, df_bw_br))\n\n\nCall:\nlm(formula = Body.Weight ~ Breed, data = df_bw_br)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.0000  -7.5000  -0.1667   2.7500  21.0000 \n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     468.000      6.097  76.758 1.68e-11 ***\nBreedLimousin    52.000      8.066   6.447 0.000351 ***\nBreedSimmental   21.333      8.623   2.474 0.042575 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.56 on 7 degrees of freedom\nMultiple R-squared:  0.8597,    Adjusted R-squared:  0.8196 \nF-statistic: 21.44 on 2 and 7 DF,  p-value: 0.001035\n\n# extend mat_ctr\nmat_ctr_ext &lt;- cbind(matrix(rep(1, nrow(mat_ctr))), mat_ctr)\ncolnames(mat_ctr_ext)[1] &lt;- \"(Intercept)\"\nmat_ctr_ext\n\n          (Intercept) Limousin Simmental\nAngus               1        0         0\nLimousin            1        1         0\nSimmental           1        0         1\n\n# inverse\nmat_ctr_ext_inv &lt;- solve(mat_ctr_ext)\nmat_ctr_ext_inv\n\n            Angus Limousin Simmental\n(Intercept)     1        0         0\nLimousin       -1        1         0\nSimmental      -1        0         1\n\n# group means\nn_mean_bw_an &lt;- mean(df_bw_br$Body.Weight[df_bw_br$Breed == \"Angus\"])\nn_mean_bw_li &lt;- mean(df_bw_br$Body.Weight[df_bw_br$Breed == \"Limousin\"])\nn_mean_bw_si &lt;- mean(df_bw_br$Body.Weight[df_bw_br$Breed == \"Simmental\"])\nvec_gr_mean_bw &lt;- c(n_mean_bw_an, n_mean_bw_li, n_mean_bw_si)\nvec_gr_mean_bw\n\n[1] 468.0000 520.0000 489.3333\n\n# estimates\nvec_b_hat &lt;- mat_ctr_ext_inv %*% vec_gr_mean_bw\nvec_b_hat\n\n                 [,1]\n(Intercept) 468.00000\nLimousin     52.00000\nSimmental    21.33333\n\n# solutions of least squares normal equations\nmat_X &lt;- model.matrix(Body.Weight ~ 0 + Breed, df_bw_br)\nmat_X &lt;- cbind(matrix(rep(1, nrow(mat_X))), mat_X)\nmat_X\n\n     BreedAngus BreedLimousin BreedSimmental\n1  1          1             0              0\n2  1          1             0              0\n3  1          1             0              0\n4  1          0             1              0\n5  1          0             1              0\n6  1          0             1              0\n7  1          0             1              0\n8  1          0             0              1\n9  1          0             0              1\n10 1          0             0              1\n\nmat_xtx &lt;- crossprod(mat_X)\nmat_xtx_ginv &lt;- MASS::ginv(mat_xtx)\nmat_xty &lt;- crossprod(mat_X, df_bw_br$Body.Weight)\nmat_sol &lt;- crossprod(mat_xtx_ginv, mat_xty)\nmat_sol\n\n          [,1]\n[1,] 369.33333\n[2,]  98.66667\n[3,] 150.66667\n[4,] 120.00000\n\nmat_sol[3] - mat_sol[2]\n\n[1] 52\n\nmat_sol[4] - mat_sol[2]\n\n[1] 21.33333"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html",
    "href": "slides/l06_interactions/l06_interactions.html",
    "title": "Interactions",
    "section": "",
    "text": "Effect of given predictor variable depends on level or value of other predictor variable\nExamples:\n\nRegression of Body Weight on Breast Circumference is different for different breeds\nEffect of Breed on Body Weight is different for different male and female animals"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#definition",
    "href": "slides/l06_interactions/l06_interactions.html#definition",
    "title": "Interactions",
    "section": "",
    "text": "Effect of given predictor variable depends on level or value of other predictor variable\nExamples:\n\nRegression of Body Weight on Breast Circumference is different for different breeds\nEffect of Breed on Body Weight is different for different male and female animals"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#types-of-interactions",
    "href": "slides/l06_interactions/l06_interactions.html#types-of-interactions",
    "title": "Interactions",
    "section": "Types of Interactions",
    "text": "Types of Interactions\n\ncontinuous by continuous\ncontinuous by categorical\ncategorical by categorical"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#continuous-by-categorical",
    "href": "slides/l06_interactions/l06_interactions.html#continuous-by-categorical",
    "title": "Interactions",
    "section": "Continuous by Categorical",
    "text": "Continuous by Categorical\n\nIn a model, expected value of response depends on regression variable plus discrete factor\nExample: Regression of Body Weight on Breast Circumference plus the factor Breed\nInteraction is present, if regression of Body Weight on Breast Circumference is different for different breeds"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#interaction-plot",
    "href": "slides/l06_interactions/l06_interactions.html#interaction-plot",
    "title": "Interactions",
    "section": "Interaction Plot",
    "text": "Interaction Plot"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#interaction-model",
    "href": "slides/l06_interactions/l06_interactions.html#interaction-model",
    "title": "Interactions",
    "section": "Interaction Model",
    "text": "Interaction Model\n\nStart with model without interactions\n\n\\[y_i = b_0 + b_1 \\times BC_i + b_2 \\times BrLi_i + b_3 \\times BrSi_i + e_i\\]\n\nAssume linear relationship of \\(b_1\\) with Breed\n\n\\[b_1 = a + b_4 \\times BrLi + b_5 \\times BrSi\\]\n\nInsert\n\n\\[y_i = b_0 + (a + b_4 \\times BrLi + b_5 \\times BrSi) \\times BC_i + b_2 \\times BrLi_i + b_3 \\times BrSi_i + e_i\\]\n\nSimplify\n\n\\[\\begin{align}\ny_i &= b_0 + a \\times BC_i + b_2 \\times BrLi_i + b_3 \\times BrSi_i \\notag \\\\\n    &  + b_4 \\times BrLi \\times BC_i + b_5 \\times BrSi \\times BC_i + e_i \\notag\n\\end{align}\\]"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#continuous-by-continuous",
    "href": "slides/l06_interactions/l06_interactions.html#continuous-by-continuous",
    "title": "Interactions",
    "section": "Continuous by Continuous",
    "text": "Continuous by Continuous\n\nSimilar to continuous by categorical\nNo interaction\n\n\\[\\begin{equation}\ny_0 = b_0 + b_1 \\times BC_i + b_2 \\times HE_i + e_i \\notag\n\\end{equation}\\]\n\nInteraction by dependence of one regression coefficient on other coefficient\n\n\\[b_1 = b_3 + b_4 \\times HE_i \\]\n\\[y_0 = b_0 + b_2 \\times HE_i + b_3 \\times BC_i + b_4 \\times HE_i \\times BC_i + e_i\\]"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#categorical-by-categorical",
    "href": "slides/l06_interactions/l06_interactions.html#categorical-by-categorical",
    "title": "Interactions",
    "section": "Categorical by Categorical",
    "text": "Categorical by Categorical"
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#model-matrix",
    "href": "slides/l06_interactions/l06_interactions.html#model-matrix",
    "title": "Interactions",
    "section": "Model Matrix",
    "text": "Model Matrix\n\n\n   (Intercept) BreedLimousin BreedSimmental SexM BreedLimousin:SexM\n1            1             0              0    1                  0\n2            1             0              0    0                  0\n3            1             0              0    0                  0\n4            1             1              0    0                  0\n5            1             1              0    0                  0\n6            1             1              0    1                  1\n7            1             1              0    0                  0\n8            1             0              1    0                  0\n9            1             0              1    1                  0\n10           1             0              1    0                  0\n   BreedSimmental:SexM\n1                    0\n2                    0\n3                    0\n4                    0\n5                    0\n6                    0\n7                    0\n8                    0\n9                    1\n10                   0\nattr(,\"assign\")\n[1] 0 1 1 2 3 3\nattr(,\"contrasts\")\nattr(,\"contrasts\")$Breed\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$Sex\n[1] \"contr.treatment\""
  },
  {
    "objectID": "slides/l06_interactions/l06_interactions.html#summary",
    "href": "slides/l06_interactions/l06_interactions.html#summary",
    "title": "Interactions",
    "section": "Summary",
    "text": "Summary\n\n\n\nCall:\nlm(formula = `Body Weight` ~ Breed * Sex, data = tbl_flem_bw_br_sex)\n\nResiduals:\n         1          2          3          4          5          6          7 \n 3.726e-15 -3.500e+00  3.500e+00 -5.333e+00 -1.233e+01 -1.703e-15  1.767e+01 \n         8          9         10 \n-5.000e+00 -6.458e-16  5.000e+00 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           466.50       8.42  55.404 6.35e-07 ***\nBreedLimousin          56.83      10.87   5.228  0.00639 ** \nBreedSimmental         19.50      11.91   1.638  0.17685    \nSexM                    4.50      14.58   0.309  0.77306    \nBreedLimousin:SexM    -17.83      20.04  -0.890  0.42389    \nBreedSimmental:SexM     5.50      20.62   0.267  0.80291    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.91 on 4 degrees of freedom\nMultiple R-squared:  0.8981,    Adjusted R-squared:  0.7706 \nF-statistic: 7.048 on 5 and 4 DF,  p-value: 0.04092"
  },
  {
    "objectID": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-2",
    "href": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.8.1",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-3",
    "href": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.8.1",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-4",
    "href": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.8.1",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-5",
    "href": "ohp/20240415_ohp_l08/20240415_ohp_l08.html#ohp-picture-5",
    "title": "ASMAS-SS2024 | 0.8.1",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html",
    "title": "Estimable Functions and Contrasts in R",
    "section": "",
    "text": "This is an update on the synthesis and derivation notebook of the two previous years. After the lecture, we start with the development of new material. The new material is only based on group means and contrasts of group means."
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#disclaimer",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#disclaimer",
    "title": "Estimable Functions and Contrasts in R",
    "section": "",
    "text": "This is an update on the synthesis and derivation notebook of the two previous years. After the lecture, we start with the development of new material. The new material is only based on group means and contrasts of group means."
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#data",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#data",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Data",
    "text": "Data\nWe are using the dataset on body weight and breed.\n\ns_bw_breed_path &lt;- here::here(\"docs\", \"data\", \"asm_bw_breed.csv\")\ntbl_bw_breed &lt;- readr::read_delim(s_bw_breed_path, delim = \",\")\n\nRows: 10 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Breed\ndbl (2): Animal, Body Weight\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntbl_bw_breed\n\n# A tibble: 10 × 3\n   Animal `Body Weight` Breed    \n    &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    \n 1      1           471 Angus    \n 2      2           463 Angus    \n 3      4           470 Angus    \n 4      7           518 Limousin \n 5      8           511 Limousin \n 6      9           510 Limousin \n 7     10           541 Limousin \n 8      3           481 Simmental\n 9      5           496 Simmental\n10      6           491 Simmental"
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#regression-on-dummy-variables",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#regression-on-dummy-variables",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Regression on Dummy Variables",
    "text": "Regression on Dummy Variables\nLet us assume that we are interested in the difference between body weights of animals of the breed Limousin compared to the body weight of animals of breed Angus. This difference can be visualized by the following plot\n\n# filter data\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ntbl_bw_an_li &lt;- tbl_bw_breed %&gt;% \n  filter(Breed != \"Simmental\")\ntbl_bw_an_li\n\n# A tibble: 7 × 3\n  Animal `Body Weight` Breed   \n   &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;   \n1      1           471 Angus   \n2      2           463 Angus   \n3      4           470 Angus   \n4      7           518 Limousin\n5      8           511 Limousin\n6      9           510 Limousin\n7     10           541 Limousin\n\n\nShow the plot\n\nlibrary(ggplot2)\nplot_bw_diff_li_an &lt;- ggplot(tbl_bw_an_li, aes(x = Breed, y = `Body Weight`)) + \n  geom_point(color = \"blue\")\nplot_bw_diff_li_an\n\n\n\n\n\n\n\n\nThe difference of mean body weight between animals of the two breeds can be shown by fitting a regression of body weight on a breed code where Angus animals are assigned the code \\(0\\) and animals of breed Limousin are assigned the code \\(1\\).\n\ntbl_bw_an_li$BreedCodeLi &lt;- as.numeric(as.factor(tbl_bw_an_li$Breed)) - 1\ntbl_bw_an_li\n\n# A tibble: 7 × 4\n  Animal `Body Weight` Breed    BreedCodeLi\n   &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;\n1      1           471 Angus              0\n2      2           463 Angus              0\n3      4           470 Angus              0\n4      7           518 Limousin           1\n5      8           511 Limousin           1\n6      9           510 Limousin           1\n7     10           541 Limousin           1\n\n\nThe regression of Body Weight on BreedCode is\n\nlm_bw_brc_li &lt;- lm(`Body Weight` ~ BreedCodeLi, data = tbl_bw_an_li)\n(smry_bw_brc_li &lt;- summary(lm_bw_brc_li))\n\n\nCall:\nlm(formula = `Body Weight` ~ BreedCodeLi, data = tbl_bw_an_li)\n\nResiduals:\n  1   2   3   4   5   6   7 \n  3  -5   2  -2  -9 -10  21 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  468.000      6.653  70.341  1.1e-08 ***\nBreedCodeLi   52.000      8.802   5.908  0.00198 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.52 on 5 degrees of freedom\nMultiple R-squared:  0.8747,    Adjusted R-squared:  0.8496 \nF-statistic: 34.91 on 1 and 5 DF,  p-value: 0.001978\n\n\nAdding the resuting regression line to the above plot leads to\n\nplot_bw_brc_li_an &lt;- ggplot(tbl_bw_an_li, aes(x = BreedCodeLi, y = `Body Weight`)) + \n  geom_point(color = \"blue\") + \n  geom_abline(intercept = smry_bw_brc_li$coefficients[\"(Intercept)\", \"Estimate\"],\n              slope = smry_bw_brc_li$coefficients[\"BreedCodeLi\", \"Estimate\"],\n              color = \"red\")\nplot_bw_brc_li_an\n\n\n\n\n\n\n\n\nThe intersection of the red regression line with \\(x=0\\) on the one hand shows the intercept of the regression line and on the other hand corresponds to the mean Angus body weight"
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#old-stuff-below-here",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#old-stuff-below-here",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Old Stuff Below Here",
    "text": "Old Stuff Below Here\nThe material from 2024 and before was mostly based on explaining parameter estimates via estimable functions of solutions of least squares normal equations. While this is possible and can work, it adds un-necessary complexity. For documentation, the previously used material is left in here."
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#references",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#references",
    "title": "Estimable Functions and Contrasts in R",
    "section": "References",
    "text": "References\n[1] Notebooks on contrasts from previous years [2] Material from https://bookdown.org/pingapang9/linear_models_bookdown/chap-contrasts.html"
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#data-1",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#data-1",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Data",
    "text": "Data\nThe data set used is the one on a synthetic observation and on breeds of animals.\n\ns_data_path &lt;- here::here(\"docs\", \"data\", \"est_fun_breed_data.csv\")\ntbl_est_fun &lt;- readr::read_delim(s_data_path, delim = \",\")\n\nRows: 6 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Breed\ndbl (2): Animal, Observation\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntbl_est_fun\n\n# A tibble: 6 × 3\n  Animal Breed     Observation\n   &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;\n1      1 Angus              16\n2      2 Angus              10\n3      3 Angus              19\n4      4 Simmental          11\n5      5 Simmental          13\n6      6 Limousin           27\n\n\nUse a second dataset with body weight and breed\n\ns_bw_breed_path &lt;- here::here(\"docs\", \"data\", \"asm_bw_breed.csv\")\ntbl_bw_breed &lt;- readr::read_delim(s_bw_breed_path, delim = \",\")\n\nRows: 10 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Breed\ndbl (2): Animal, Body Weight\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntbl_bw_breed\n\n# A tibble: 10 × 3\n   Animal `Body Weight` Breed    \n    &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    \n 1      1           471 Angus    \n 2      2           463 Angus    \n 3      4           470 Angus    \n 4      7           518 Limousin \n 5      8           511 Limousin \n 6      9           510 Limousin \n 7     10           541 Limousin \n 8      3           481 Simmental\n 9      5           496 Simmental\n10      6           491 Simmental"
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#use-regression-to-describe-group-means",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#use-regression-to-describe-group-means",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Use Regression To Describe Group Means",
    "text": "Use Regression To Describe Group Means\nStart by looking only at breeds Angus and Limousin in the dataset on body weight. Then use the dummy coding where Angus animals receive a value of \\(0\\) and Limousin animals receive a code of \\(1\\). The regression of body weight on that dummy coding results in a regression line that goes through the mean body weights for both breeds. That means, we get\n\nlibrary(dplyr)\ntbl_bw_breed &lt;- tbl_bw_breed %&gt;%\n  filter(Breed != \"Simmental\")\ntbl_bw_breed$BreedFactor &lt;- as.numeric(as.factor(tbl_bw_breed$Breed))-1\ntbl_bw_breed\n\n# A tibble: 7 × 4\n  Animal `Body Weight` Breed    BreedFactor\n   &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;\n1      1           471 Angus              0\n2      2           463 Angus              0\n3      4           470 Angus              0\n4      7           518 Limousin           1\n5      8           511 Limousin           1\n6      9           510 Limousin           1\n7     10           541 Limousin           1\n\n\nFit regression\n\nlm_bw_breed &lt;- lm(`Body Weight` ~ BreedFactor, data = tbl_bw_breed)\n(smry_bw_breed &lt;- summary(lm_bw_breed))\n\n\nCall:\nlm(formula = `Body Weight` ~ BreedFactor, data = tbl_bw_breed)\n\nResiduals:\n  1   2   3   4   5   6   7 \n  3  -5   2  -2  -9 -10  21 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  468.000      6.653  70.341  1.1e-08 ***\nBreedFactor   52.000      8.802   5.908  0.00198 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.52 on 5 degrees of freedom\nMultiple R-squared:  0.8747,    Adjusted R-squared:  0.8496 \nF-statistic: 34.91 on 1 and 5 DF,  p-value: 0.001978\n\n\nCreate a plot\n\nlibrary(ggplot2)\npl_bw_breed &lt;- ggplot(tbl_bw_breed, aes(x = BreedFactor, y = `Body Weight`)) + \n  geom_point() + \n  geom_abline(slope = smry_bw_breed$coefficients[\"BreedFactor\", \"Estimate\"], \n              intercept = smry_bw_breed$coefficients[\"(Intercept)\", \"Estimate\"])\npl_bw_breed\n\n\n\n\n\n\n\n\nThe intersection of the regression line at the two values \\(0\\) and \\(1\\) for BreedFactor are at the mean value for body weight for the two breeds AN and LI. The writing the parameter vector \\(b\\) as\n\\[b = \\left[ \\begin{array}{c} b_0 \\\\ b_1 \\end{array}\\right] \\]\nWe see in the next section how to express \\(b\\) as contrasts of group means \\(M_{AN}\\) and \\(M_{LI}\\)."
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#idea-of-contrasts",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#idea-of-contrasts",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Idea of Contrasts",
    "text": "Idea of Contrasts\nAccording to chapter 7 of [2], contrasts can be explained as follows.\nA contrast is a linear combination of parameters or statistics. An alternative term for “linear combination” is weighted sum. We are currently focusing on statistics from two levels of a given factor. In our dataset this corresponds to two levels of the factor breed. As an example, we have a look at the observation for Simmental and for Angus animals.\nLet \\(M_{AN}\\) be the mean observation for all animals of breed Angus and \\(M_{SI}\\) be the mean observation for all Simmental animals. The sum of the two means can be written as\n\\[L_1 = M_{AN} + M_{SI}\n= \\left[\\begin{array}{cc} 1 & 1 \\end{array}\\right] \\cdot \\left[ \\begin{array}{c} M_{AN} \\\\  M_{SI}  \\end{array}\\right]\n= l_1^T \\cdot m\\]\nA different contrast (\\(L_2\\)) insepects the difference between the two means.\n\\[L_2 = M_{AN} - M_{SI}\n= \\left[\\begin{array}{cc} 1 & -1 \\end{array}\\right] \\cdot \\left[ \\begin{array}{c} M_{AN} \\\\  M_{SI}  \\end{array}\\right]\n= l_2^T \\cdot m\\]\nThese contrasts \\(l_1\\) and \\(l_2\\) can be combined into a matrix \\(L\\)\n\\[L = \\left[\\begin{array}{cc} l_1 & l_2 \\end{array} \\right] \\]\nThen we can write the above two contrasts as\n\\[L^T \\cdot m\\]\nAs seen in the previous section, the estimate of the parameter vector \\(b\\) can be written as contrasts of group means and as a consequence, the group means can be written as a function of parameter estimates\n\\[m =  \\left[ \\begin{array}{c} M_{AN} \\\\  M_{SI}  \\end{array}\\right]\n= \\left[ \\begin{array}{c} \\widehat{b_0} \\\\  \\widehat{b_0} + \\widehat{b_1}  \\end{array}\\right]\n=  \\left[\\begin{array}{cc} 1 & 0 \\\\ 1 & 1 \\end{array}\\right]\n    \\cdot \\left[ \\begin{array}{c} \\widehat{b_0} \\\\  \\widehat{b_1}  \\end{array}\\right]\n= L^T \\cdot  \\widehat{b}\\]\nWith this, the vector of group means \\(m\\) is expressed as linear function or linear transformation of the vector of parameter estimates $ $. Solving for \\(\\widehat{b}\\) yields the parameter estimates as linear function of group means.\n\\[\\widehat{b} = (L^T)^{-1} \\cdot m\\]\nAs shown below, the matrix \\(L^T\\) is used to determine what type of contrasts are used in R."
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#contrasts-in-r",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#contrasts-in-r",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Contrasts in R",
    "text": "Contrasts in R\nFor a given dataset, the contrast matrix can be obtained as a result of the function contrasts(). For our original example with three breeds this yields in\n\ntbl_bw_breed &lt;- readr::read_delim(s_bw_breed_path, delim = \",\")\nmat_ctr_br &lt;- contrasts(as.factor(tbl_bw_breed$Breed))\nmat_ctr_br\n\n          Limousin Simmental\nAngus            0         0\nLimousin         1         0\nSimmental        0         1\n\n\nThe above shown contrasts matrix shows in the rows, the original factor levels in the dataset. The columns stand for the new variables that are introduced in the re-dimensioned model. How the codes for the new model are assigned to the observations can be seen from the result of the function model.matrix.\n\nmat_mod_br &lt;- model.matrix(`Body Weight` ~ Breed, tbl_bw_breed)\nmat_mod_br\n\n   (Intercept) BreedLimousin BreedSimmental\n1            1             0              0\n2            1             0              0\n3            1             0              0\n4            1             1              0\n5            1             1              0\n6            1             1              0\n7            1             1              0\n8            1             0              1\n9            1             0              1\n10           1             0              1\nattr(,\"assign\")\n[1] 0 1 1\nattr(,\"contrasts\")\nattr(,\"contrasts\")$Breed\n[1] \"contr.treatment\"\n\n\nAdding a column representing the intercept to the contrasts matrix and taking its inverse, results in the matrix of estimable functions\n\nmat_ctr_br_ext &lt;- cbind(matrix(rep(1, nrow(mat_ctr_br))), mat_ctr_br)\ncolnames(mat_ctr_br_ext)[1] &lt;- \"(Intercept)\"\nmat_ctr_br_ext\n\n          (Intercept) Limousin Simmental\nAngus               1        0         0\nLimousin            1        1         0\nSimmental           1        0         1\n\n\nThen the inverse\n\nmat_est_fun &lt;- solve(mat_ctr_br_ext)\nmat_est_fun\n\n            Angus Limousin Simmental\n(Intercept)     1        0         0\nLimousin       -1        1         0\nSimmental      -1        0         1\n\n\nThe first row indicates which group mean is used for the intercept. The remaining rows represent the estimable functions used for the effect with the corresponding row name."
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#validation",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#validation",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Validation",
    "text": "Validation\nThe results on the investigated connection between contrasts and estimable functions is validated with our example dataset. For this validation, we first need a set of solutions to the least squares normal equations. As the first step, we set up the design matrix \\(\\mathbf{X}\\) and use it to compute the crossproduct \\(\\mathbf{X}^T\\mathbf{X}\\)\n\n#tbl_flem_bw_breed\nmat_X &lt;- model.matrix(`Body Weight` ~ 0 + Breed, tbl_bw_breed)\nmat_X &lt;- cbind(matrix(1, nrow = nrow(tbl_bw_breed), ncol = 1), mat_X)\ndimnames(mat_X) &lt;- NULL\nmat_xtx &lt;- crossprod(mat_X)\nmat_xtx\n\n     [,1] [,2] [,3] [,4]\n[1,]   10    3    4    3\n[2,]    3    3    0    0\n[3,]    4    0    4    0\n[4,]    3    0    0    3\n\n\nThe solution to the normal equations are obtained by\n\nvec_y &lt;- tbl_bw_breed$`Body Weight`\nmat_xty &lt;- crossprod(mat_X, vec_y)\nmat_xtx_ginv &lt;- MASS::ginv(mat_xtx)\nmat_b_sol &lt;- crossprod(t(mat_xtx_ginv), mat_xty)\nmat_b_sol\n\n          [,1]\n[1,] 369.33333\n[2,]  98.66667\n[3,] 150.66667\n[4,] 120.00000\n\n\nThe intercept in the treatment contrasts are computed as the mean observations for the first factor level. For the factor Breed this corresponds to the mean of all animals of breed Angus. This is verified by\n\nlibrary(dplyr)\nmean((tbl_bw_breed %&gt;% filter(Breed == \"Angus\"))$`Body Weight`)\n\n[1] 468\n\n\nBased on the matrix of estimable functions, the effect assigned to the BreedLimousin corresponds to the difference between the third and the second component of the solution vector\n\nmat_b_sol[3] - mat_b_sol[2] \n\n[1] 52\n\n\nThe effect assigned to BreedSimmental is the difference between the last and the second component of the solution vector\n\nmat_b_sol[4] - mat_b_sol[2]\n\n[1] 21.33333\n\n\nThese effects can also be found in the summary output of the lm -object.\n\nlm_bw_br &lt;- lm(`Body Weight` ~ Breed, data = tbl_bw_breed)\n(smry_lm_bw_br &lt;- summary(lm_bw_br))\n\n\nCall:\nlm(formula = `Body Weight` ~ Breed, data = tbl_bw_breed)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.0000  -7.5000  -0.1667   2.7500  21.0000 \n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     468.000      6.097  76.758 1.68e-11 ***\nBreedLimousin    52.000      8.066   6.447 0.000351 ***\nBreedSimmental   21.333      8.623   2.474 0.042575 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.56 on 7 degrees of freedom\nMultiple R-squared:  0.8597,    Adjusted R-squared:  0.8196 \nF-statistic: 21.44 on 2 and 7 DF,  p-value: 0.001035"
  },
  {
    "objectID": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#vector-of-group-means",
    "href": "misc/20240414_est_fun_contrasts/20240413_est_fun_contrasts.html#vector-of-group-means",
    "title": "Estimable Functions and Contrasts in R",
    "section": "Vector of Group Means",
    "text": "Vector of Group Means\nThe vector \\(m\\) is the vector of group means\n\nn_mean_AN &lt;- mean((tbl_bw_breed %&gt;% filter(Breed == \"Angus\"))$`Body Weight`)\nn_mean_LI &lt;- mean((tbl_bw_breed %&gt;% filter(Breed == \"Limousin\"))$`Body Weight`)\nn_mean_SI &lt;- mean((tbl_bw_breed %&gt;% filter(Breed == \"Simmental\"))$`Body Weight`)\n(vec_group_mean &lt;- c(n_mean_AN, n_mean_LI, n_mean_SI))\n\n[1] 468.0000 520.0000 489.3333\n\n\nPre-multiplication of the vector of group means with the matrix of estimable functions yields\n\ncrossprod(t(mat_est_fun), vec_group_mean)\n\n                 [,1]\n(Intercept) 468.00000\nLimousin     52.00000\nSimmental    21.33333"
  },
  {
    "objectID": "about.html#asmasss2024-0.9.0",
    "href": "about.html#asmasss2024-0.9.0",
    "title": "About",
    "section": "asmasss2024 0.9.0",
    "text": "asmasss2024 0.9.0\n\nSlides on interactions l06_interactions"
  },
  {
    "objectID": "about.html#asmasss2024-0.9.1",
    "href": "about.html#asmasss2024-0.9.1",
    "title": "About",
    "section": "asmasss2024 0.9.1",
    "text": "asmasss2024 0.9.1\n\nSlides on simulation l07_simulation"
  },
  {
    "objectID": "about.html#asmasss2024-0.9.2",
    "href": "about.html#asmasss2024-0.9.2",
    "title": "About",
    "section": "asmasss2024 0.9.2",
    "text": "asmasss2024 0.9.2\n\nData for simulation asm_bw_bc_reg\nData on interactions asm_bw_flem"
  },
  {
    "objectID": "my_scripts/20240422_interactions/20240422_interactions.html",
    "href": "my_scripts/20240422_interactions/20240422_interactions.html",
    "title": "Interactions",
    "section": "",
    "text": "b_is_online &lt;- TRUE\nif (b_is_online){\n  s_flem_path &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_flem.csv\"\n} else {\n  s_flem_path &lt;- here::here()(\"docs\", \"data\", \"asm_bw_flem.csv\")\n}\n\ndf_flem &lt;- read.table(s_flem_path, header = T, sep = \",\")\ndf_flem\n\n   Animal Breast.Circumference Body.Weight BCS HEI     Breed\n1       1                  176         471 5.0 161     Angus\n2       2                  177         463 4.2 121     Angus\n3       3                  178         481 4.9 157 Simmental\n4       4                  179         470 3.0 165     Angus\n5       5                  179         496 6.8 136 Simmental\n6       6                  180         491 4.9 123 Simmental\n7       7                  181         518 4.4 163  Limousin\n8       8                  182         511 4.4 149  Limousin\n9       9                  183         510 3.5 143  Limousin\n10     10                  184         541 4.7 130  Limousin\n\nlm_bw_bc_br &lt;- lm(Body.Weight ~ Breast.Circumference * Breed, data = df_flem)\nsummary(lm_bw_bc_br)\n\n\nCall:\nlm(formula = Body.Weight ~ Breast.Circumference * Breed, data = df_flem)\n\nResiduals:\n      1       2       3       4       5       6       7       8       9      10 \n  3.286  -4.929  -3.333   1.643   6.667  -3.333   8.200  -5.600 -13.400  10.800 \n\nCoefficients:\n                                      Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)                           430.0000   917.1235   0.469    0.664\nBreast.Circumference                    0.2143     5.1716   0.041    0.969\nBreedLimousin                       -1151.0000  1293.2741  -0.890    0.424\nBreedSimmental                       -835.6667  1685.4451  -0.496    0.646\nBreast.Circumference:BreedLimousin      6.5857     7.1908   0.916    0.412\nBreast.Circumference:BreedSimmental     4.7857     9.4420   0.507    0.639\n\nResidual standard error: 11.17 on 4 degrees of freedom\nMultiple R-squared:  0.9103,    Adjusted R-squared:  0.7981 \nF-statistic: 8.115 on 5 and 4 DF,  p-value: 0.03212"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html",
    "href": "slides/l07_simulation/l07_simulation.html",
    "title": "Simulations",
    "section": "",
    "text": "When is the best time to think about data analysis?"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#timing-of-data-analysis",
    "href": "slides/l07_simulation/l07_simulation.html#timing-of-data-analysis",
    "title": "Simulations",
    "section": "",
    "text": "When is the best time to think about data analysis?"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#problems",
    "href": "slides/l07_simulation/l07_simulation.html#problems",
    "title": "Simulations",
    "section": "Problems",
    "text": "Problems\n\nDataset is given\nAnalysis comes after data collection\nStructure of data cannot be changed"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#improvement",
    "href": "slides/l07_simulation/l07_simulation.html#improvement",
    "title": "Simulations",
    "section": "Improvement",
    "text": "Improvement"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#solution",
    "href": "slides/l07_simulation/l07_simulation.html#solution",
    "title": "Simulations",
    "section": "Solution",
    "text": "Solution\n\nPlan data analysis before data collection\nExperimental design\nUse simulation …"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#simulation",
    "href": "slides/l07_simulation/l07_simulation.html#simulation",
    "title": "Simulations",
    "section": "Simulation",
    "text": "Simulation\nWhat is simulation?"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#procedure",
    "href": "slides/l07_simulation/l07_simulation.html#procedure",
    "title": "Simulations",
    "section": "Procedure",
    "text": "Procedure\n\nGiven there is an effect between characteristics of variables\nGenerate data that contains the effects\nRe-analyse generated data\nCan effects be found?"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#first-example",
    "href": "slides/l07_simulation/l07_simulation.html#first-example",
    "title": "Simulations",
    "section": "First Example",
    "text": "First Example\nBody Weight on Breast Circumference\n\n# read data\ndf_bw_bc &lt;- read.table(s_bw_bc_url, header = T, sep = \",\")\n# fit regression\nlm_bw_bc &lt;- lm(Body.Weight ~ Breast.Circumference, \n               data = df_bw_bc)\nsmry_bw_bc &lt;- summary(lm_bw_bc)"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#first-example-ii-simulation",
    "href": "slides/l07_simulation/l07_simulation.html#first-example-ii-simulation",
    "title": "Simulations",
    "section": "First Example II: Simulation",
    "text": "First Example II: Simulation\n\n# parameter from results\nb_0 &lt;- smry_bw_bc$coefficients[\"(Intercept)\", \"Estimate\"]\nb_1 &lt;- smry_bw_bc$coefficients[\"Breast.Circumference\", \n                               \"Estimate\"]\nsd_e &lt;- smry_bw_bc$sigma\n# simulate data\nset.seed(2204)\nn_nr_sim_obs &lt;- 30\nX_sim &lt;- rnorm(n_nr_sim_obs, \n               mean = mean(df_bw_bc$Breast.Circumference), \n               sd = sd(df_bw_bc$Breast.Circumference))\nY_sim &lt;- b_0 + b_1 * X_sim + \n  rnorm(n_nr_sim_obs, mean = 0, sd = sd_e)"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#first-example-iii-data-analysis",
    "href": "slides/l07_simulation/l07_simulation.html#first-example-iii-data-analysis",
    "title": "Simulations",
    "section": "First Example III: Data Analysis",
    "text": "First Example III: Data Analysis\n\ndf_sim &lt;- data.frame(X.sim = X_sim, Y.sim = Y_sim)\nlm_sim &lt;- lm(Y.sim ~ X.sim, data = df_sim)\nsummary(lm_sim)\n\n\nCall:\nlm(formula = Y.sim ~ X.sim, data = df_sim)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19.1698  -4.7765   0.4339   7.0468  17.1173 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -1294.5609   127.0850  -10.19 6.39e-11 ***\nX.sim           9.9453     0.7107   13.99 3.66e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 9.78 on 28 degrees of freedom\nMultiple R-squared:  0.8749,    Adjusted R-squared:  0.8704 \nF-statistic: 195.8 on 1 and 28 DF,  p-value: 3.656e-14"
  },
  {
    "objectID": "slides/l07_simulation/l07_simulation.html#more-examples",
    "href": "slides/l07_simulation/l07_simulation.html#more-examples",
    "title": "Simulations",
    "section": "More Examples",
    "text": "More Examples\n\nDifferences between feeds …\nDifferences between treatment and controls …\nDifferences betwween healthy and diseased …"
  },
  {
    "objectID": "about.html#asmasss2024-0.9.3",
    "href": "about.html#asmasss2024-0.9.3",
    "title": "About",
    "section": "asmasss2024 0.9.3",
    "text": "asmasss2024 0.9.3\n\nCourse notes 04_mlem"
  },
  {
    "objectID": "about.html#asmasss2024-0.9.4",
    "href": "about.html#asmasss2024-0.9.4",
    "title": "About",
    "section": "asmasss2024 0.9.4",
    "text": "asmasss2024 0.9.4\n\nOverhead pictures ohp_l09"
  },
  {
    "objectID": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-2",
    "href": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.9.3",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-3",
    "href": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.9.3",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-4",
    "href": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.9.3",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-5",
    "href": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-5",
    "title": "ASMAS-SS2024 | 0.9.3",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-6",
    "href": "ohp/20240422_ohp_l09/20240422_ohp_l09.html#ohp-picture-6",
    "title": "ASMAS-SS2024 | 0.9.3",
    "section": "OHP Picture 6",
    "text": "OHP Picture 6"
  },
  {
    "objectID": "about.html#asmasss2024-0.10.0",
    "href": "about.html#asmasss2024-0.10.0",
    "title": "About",
    "section": "asmasss2024 0.10.0",
    "text": "asmasss2024 0.10.0\n\nSolution asm_sol07\nSolution asm_sol06"
  },
  {
    "objectID": "about.html#asmasss2024-0.10.1",
    "href": "about.html#asmasss2024-0.10.1",
    "title": "About",
    "section": "asmasss2024 0.10.1",
    "text": "asmasss2024 0.10.1\n\nExercise asm_ex08"
  },
  {
    "objectID": "my_scripts/20240429_mlem/repeated_observations.html",
    "href": "my_scripts/20240429_mlem/repeated_observations.html",
    "title": "Repeated Observations",
    "section": "",
    "text": "# read data to a data frame\ns_bw_breed_rep_obs_path &lt;- \"https://charlotte-ngs.github.io/asmss2022/data/asm_bw_bc_rep_obs.csv\"\ndf_rep_obs_breed &lt;- read.table(s_bw_breed_rep_obs_path, \n header = T, sep = \",\")\ndf_rep_obs_breed\n\n   Animal Breast.Circumference Body.Weight\n1       2             177.0000    463.0000\n2       2             177.3129    468.8940\n3       2             177.3292    467.8753\n4       5             179.0000    496.0000\n5       5             178.6501    495.0033\n6       5             178.7485    493.6563\n7       7             181.0000    518.0000\n8       7             180.9819    509.3221\n9       7             181.1467    506.5958\n10     10             184.0000    541.0000\n11     10             184.5957    547.3609\n12     10             183.1749    533.9288\n\n# convert animal into a factor\ndf_rep_obs_breed$Animal &lt;- as.factor(df_rep_obs_breed$Animal)\n\n# plot\nlibrary(ggplot2)\np &lt;- ggplot(data = df_rep_obs_breed, \n            mapping = aes(x = Breast.Circumference,\n                          y = Body.Weight)) + \n       geom_point(aes(color = Animal, \n                      size = 3))\np"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html",
    "href": "slides/l08_mlem/l08_mlem.html",
    "title": "Mixed Linear Effects Models",
    "section": "",
    "text": "Same characteristics (Body Weight, BC, …) measured multiple times for the same animal\n\n\n\n\n\n\nAnimal\nBreast Circumference\nBody Weight\n\n\n\n\n2\n177.0000\n463.0000\n\n\n2\n177.3129\n468.8940\n\n\n2\n177.3292\n467.8753\n\n\n5\n179.0000\n496.0000\n\n\n5\n178.6501\n495.0033\n\n\n5\n178.7485\n493.6563\n\n\n7\n181.0000\n518.0000\n\n\n7\n180.9819\n509.3221\n\n\n\n\n\n\nColumn Animal no longer just a counter, it becomes a model factor"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#repeated-measurements",
    "href": "slides/l08_mlem/l08_mlem.html#repeated-measurements",
    "title": "Mixed Linear Effects Models",
    "section": "",
    "text": "Same characteristics (Body Weight, BC, …) measured multiple times for the same animal\n\n\n\n\n\n\nAnimal\nBreast Circumference\nBody Weight\n\n\n\n\n2\n177.0000\n463.0000\n\n\n2\n177.3129\n468.8940\n\n\n2\n177.3292\n467.8753\n\n\n5\n179.0000\n496.0000\n\n\n5\n178.6501\n495.0033\n\n\n5\n178.7485\n493.6563\n\n\n7\n181.0000\n518.0000\n\n\n7\n180.9819\n509.3221\n\n\n\n\n\n\nColumn Animal no longer just a counter, it becomes a model factor"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#properties",
    "href": "slides/l08_mlem/l08_mlem.html#properties",
    "title": "Mixed Linear Effects Models",
    "section": "Properties",
    "text": "Properties\n\nWhat is the benefit of repeated measurements?\nEquivalent to more animals in the dataset?\nAssumption: repeated observations of the same animal are more “similar”\nNo longer independence of observations"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#data-scatterplot",
    "href": "slides/l08_mlem/l08_mlem.html#data-scatterplot",
    "title": "Mixed Linear Effects Models",
    "section": "Data Scatterplot",
    "text": "Data Scatterplot"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#statistical-analysis",
    "href": "slides/l08_mlem/l08_mlem.html#statistical-analysis",
    "title": "Mixed Linear Effects Models",
    "section": "Statistical Analysis",
    "text": "Statistical Analysis\n\nTechnically, same regression analysis is possible\n\n\nBut assumption of independence is violoted\nConsequence of independence\n\n\\[var(\\mathbf{e}) = \\mathbf{I} * \\sigma_e^2\\] * Check residuals plot"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#diagnostics-plot",
    "href": "slides/l08_mlem/l08_mlem.html#diagnostics-plot",
    "title": "Mixed Linear Effects Models",
    "section": "Diagnostics Plot",
    "text": "Diagnostics Plot\n\nplot(lm_rep_obs)"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#anova",
    "href": "slides/l08_mlem/l08_mlem.html#anova",
    "title": "Mixed Linear Effects Models",
    "section": "ANOVA",
    "text": "ANOVA\n\naov_bw_breed &lt;- aov(`Body Weight` ~ Breed, \n                           data = tbl_rep_obs_breed)\nsummary(aov_bw_breed)\n\n            Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nBreed        2   7356    3678   22.29 0.000327 ***\nResiduals    9   1485     165                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#anova-i-breed-and-animal",
    "href": "slides/l08_mlem/l08_mlem.html#anova-i-breed-and-animal",
    "title": "Mixed Linear Effects Models",
    "section": "ANOVA I: Breed and Animal",
    "text": "ANOVA I: Breed and Animal\n\naov_bw_breed_animal &lt;- aov(`Body Weight` ~ Breed + Animal, \n                           data = tbl_rep_obs_breed)\nsummary(aov_bw_breed_animal)\n\n            Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nBreed        2   7356    3678  160.06 3.53e-07 ***\nAnimal       1   1302    1302   56.64 6.76e-05 ***\nResiduals    8    184      23                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#anova-ii",
    "href": "slides/l08_mlem/l08_mlem.html#anova-ii",
    "title": "Mixed Linear Effects Models",
    "section": "ANOVA II",
    "text": "ANOVA II\n\naov_bw_no_breed_rep &lt;- aov(`Body Weight` ~ Error(Animal), \n                           data = tbl_rep_obs_no_breed)\nsummary(aov_bw_no_breed_rep)\n\n\nError: Animal\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nResiduals  3   8658    2886               \n\nError: Within\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nResiduals  8  183.8   22.98"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#anova-iii",
    "href": "slides/l08_mlem/l08_mlem.html#anova-iii",
    "title": "Mixed Linear Effects Models",
    "section": "ANOVA III",
    "text": "ANOVA III\n\naov_bw_breed_rep &lt;- aov(`Body Weight` ~ Breed + \n                             Error(Animal), \n                           data = tbl_rep_obs_breed)\nsummary(aov_bw_breed_rep)\n\n\nError: Animal\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nBreed      2   7356    3678   2.826  0.388\nResiduals  1   1302    1302               \n\nError: Within\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nResiduals  8  183.8   22.98"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#lme4",
    "href": "slides/l08_mlem/l08_mlem.html#lme4",
    "title": "Mixed Linear Effects Models",
    "section": "lme4",
    "text": "lme4\n\nlme_bw_no_breed_rep &lt;- lme4::lmer(`Body Weight` ~ \n                                    (1|Animal), \n                       data = tbl_rep_obs_no_breed)\nsummary(lme_bw_no_breed_rep)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: `Body Weight` ~ (1 | Animal)\n   Data: tbl_rep_obs_no_breed\n\nREML criterion at convergence: 82.7\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-1.36360 -0.50301  0.06086  0.26850  1.43838 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Animal   (Intercept) 954.34   30.892  \n Residual              22.98    4.794  \nNumber of obs: 12, groups:  Animal, 4\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)   503.39      15.51   32.46"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#with-breed",
    "href": "slides/l08_mlem/l08_mlem.html#with-breed",
    "title": "Mixed Linear Effects Models",
    "section": "With Breed",
    "text": "With Breed\n\n\n\n\n\nAnimal\nBody Weight\nBreed\n\n\n\n\n2\n463.0000\nAngus\n\n\n2\n468.8940\nAngus\n\n\n2\n467.8753\nAngus\n\n\n5\n496.0000\nSimmental\n\n\n5\n495.0033\nSimmental\n\n\n5\n493.6563\nSimmental\n\n\n7\n518.0000\nLimousin\n\n\n7\n509.3221\nLimousin\n\n\n7\n506.5958\nLimousin\n\n\n10\n541.0000\nLimousin\n\n\n10\n547.3609\nLimousin\n\n\n10\n533.9288\nLimousin"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#anova-1",
    "href": "slides/l08_mlem/l08_mlem.html#anova-1",
    "title": "Mixed Linear Effects Models",
    "section": "ANOVA",
    "text": "ANOVA\n\naov_bw_breed_rep &lt;- aov(`Body Weight` ~ Breed + \n                          Error(Animal), \n                           data = tbl_rep_obs_breed)\nsummary(aov_bw_breed_rep)\n\n\nError: Animal\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nBreed      2   7356    3678   2.826  0.388\nResiduals  1   1302    1302               \n\nError: Within\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nResiduals  8  183.8   22.98"
  },
  {
    "objectID": "slides/l08_mlem/l08_mlem.html#lme4-1",
    "href": "slides/l08_mlem/l08_mlem.html#lme4-1",
    "title": "Mixed Linear Effects Models",
    "section": "lme4",
    "text": "lme4\n\nlme_bw_breed_rep &lt;- lme4::lmer(`Body Weight` ~ Breed + \n                                 (1|Animal), \n                                  data = tbl_rep_obs_breed)\nsummary(lme_bw_breed_rep)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: `Body Weight` ~ Breed + (1 | Animal)\n   Data: tbl_rep_obs_breed\n\nREML criterion at convergence: 61.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.3714 -0.5383  0.0640  0.3213  1.4305 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Animal   (Intercept) 426.21   20.645  \n Residual              22.98    4.794  \nNumber of obs: 12, groups:  Animal, 4\n\nFixed effects:\n               Estimate Std. Error t value\n(Intercept)      466.59      20.83  22.400\nBreedLimousin     59.44      25.51   2.330\nBreedSimmental    28.30      29.46   0.961\n\nCorrelation of Fixed Effects:\n            (Intr) BrdLms\nBreedLimosn -0.816       \nBreedSmmntl -0.707  0.577"
  },
  {
    "objectID": "about.html#asmasss2024-0.10.2",
    "href": "about.html#asmasss2024-0.10.2",
    "title": "About",
    "section": "asmasss2024 0.10.2",
    "text": "asmasss2024 0.10.2\n\nRepeated Observation Data on BW and Breed asm_bw_breed_rep_obs\nRepeated Observation Data on BW and BC asm_bw_bc_rep_obs\nSlides l08_mlem"
  },
  {
    "objectID": "ohp/20240429_ohp_l10/20240429_ohp_l10.html#ohp-picture-2",
    "href": "ohp/20240429_ohp_l10/20240429_ohp_l10.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.10.2",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240429_ohp_l10/20240429_ohp_l10.html#ohp-picture-3",
    "href": "ohp/20240429_ohp_l10/20240429_ohp_l10.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.10.2",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240429_ohp_l10/20240429_ohp_l10.html#ohp-picture-4",
    "href": "ohp/20240429_ohp_l10/20240429_ohp_l10.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.10.2",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "my_nb/20240429_rep_obs/20240429_rep_obs.html",
    "href": "my_nb/20240429_rep_obs/20240429_rep_obs.html",
    "title": "Repeated Observations",
    "section": "",
    "text": "Some facts on analysis of repeated observations are prepared in this notebook."
  },
  {
    "objectID": "my_nb/20240429_rep_obs/20240429_rep_obs.html#disclaimer",
    "href": "my_nb/20240429_rep_obs/20240429_rep_obs.html#disclaimer",
    "title": "Repeated Observations",
    "section": "",
    "text": "Some facts on analysis of repeated observations are prepared in this notebook."
  },
  {
    "objectID": "my_nb/20240429_rep_obs/20240429_rep_obs.html#data",
    "href": "my_nb/20240429_rep_obs/20240429_rep_obs.html#data",
    "title": "Repeated Observations",
    "section": "Data",
    "text": "Data\nThe data we are using is on beef cattle and on blood pressure measurements.\n\ns_rep_path_bw_bc &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_bc_rep_obs.csv\"\ntbl_bw_bc_rep &lt;- readr::read_delim(s_rep_path_bw_bc, delim = \",\")\n\nRows: 12 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (3): Animal, Breast Circumference, Body Weight\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntbl_bw_bc_rep\n\n# A tibble: 12 × 3\n   Animal `Breast Circumference` `Body Weight`\n    &lt;dbl&gt;                  &lt;dbl&gt;         &lt;dbl&gt;\n 1      2                   177           463 \n 2      2                   177.          469.\n 3      2                   177.          468.\n 4      5                   179           496 \n 5      5                   179.          495.\n 6      5                   179.          494.\n 7      7                   181           518 \n 8      7                   181.          509.\n 9      7                   181.          507.\n10     10                   184           541 \n11     10                   185.          547.\n12     10                   183.          534.\n\n\nThe second data set is on body weight and breed, also with repeated observations.\n\ns_rep_path_bw_br &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_breed_rep_obs.csv\"\ntbl_bw_br_rep &lt;- readr::read_delim(s_rep_path_bw_br, delim = \",\")\n\nRows: 12 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Breed, Time\ndbl (2): Animal, Body Weight\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntbl_bw_br_rep\n\n# A tibble: 12 × 4\n   Animal `Body Weight` Breed     Time  \n    &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; \n 1      2          463  Angus     first \n 2      2          469. Angus     second\n 3      2          468. Angus     third \n 4      5          496  Simmental first \n 5      5          495. Simmental second\n 6      5          494. Simmental third \n 7      7          518  Limousin  first \n 8      7          509. Limousin  second\n 9      7          507. Limousin  third \n10     10          541  Limousin  first \n11     10          547. Limousin  second\n12     10          534. Limousin  third"
  },
  {
    "objectID": "my_nb/20240429_rep_obs/20240429_rep_obs.html#plots",
    "href": "my_nb/20240429_rep_obs/20240429_rep_obs.html#plots",
    "title": "Repeated Observations",
    "section": "Plots",
    "text": "Plots\nThe plots of the data already show certain patterns which are important to be considered in any statistical analysis.\n\nlibrary(ggplot2)\np_bw_bc_rep &lt;- ggplot(data = tbl_bw_bc_rep,\n                      mapping = aes(x = `Breast Circumference`,\n                                    y = `Body Weight`)) + \n  geom_point(aes(color = as.factor(Animal)))\np_bw_bc_rep\n\n\n\n\n\n\n\n\nA similar plot with Breed\n\nlibrary(ggplot2)\np_bw_br_rep &lt;- ggplot(data = tbl_bw_br_rep,\n                      mapping = aes(x = as.factor(Breed),\n                                    y = `Body Weight`)) + \n  geom_point(aes(color = as.factor(Animal)))\np_bw_br_rep\n\n\n\n\n\n\n\n\n\nStatistical Model\nAnalysis according to ChatGPT\n\n# Install and load necessary packages\ninstall.packages(\"lme4\")\nlibrary(lme4)\n\n# Assuming your dataset is called 'data' with columns 'animal_id', 'body_weight', and 'breast_circumference'\n# Fit a linear mixed-effects model\nmodel &lt;- lmer(body_weight ~ breast_circumference + (1 | animal_id), data = data)\nsummary(model)\n\nApplying the above for the BW-BC dataset we get\n\nif (!is.element(\"lme4\", installed.packages())) install.packages(\"lme4\")\nlibrary(lme4)\n\nlmer_bw_bc &lt;- lmer(`Body Weight` ~ `Breast Circumference` + (1 | Animal) , data = tbl_bw_bc_rep)\nsummary(lmer_bw_bc)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: `Body Weight` ~ `Breast Circumference` + (1 | Animal)\n   Data: tbl_bw_bc_rep\n\nREML criterion at convergence: 64.5\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-1.67538 -0.23499 -0.08804  0.19610  2.04354 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Animal   (Intercept) 30.02    5.479   \n Residual             12.07    3.474   \nNumber of obs: 12, groups:  Animal, 4\n\nFixed effects:\n                        Estimate Std. Error t value\n(Intercept)            -1357.727    196.186  -6.921\n`Breast Circumference`    10.325      1.088   9.488\n\nCorrelation of Fixed Effects:\n            (Intr)\n`BCrcmfrnc` -1.000\n\n\nIs the fixed part of the regression also obtained with fitting a regression through the mean observations\n\nlibrary(dplyr)\n\ntbl_bw_bc_mean &lt;- tbl_bw_bc_rep %&gt;%\n  group_by(Animal) %&gt;% \n  summarise(mean_bw = mean(`Body Weight`),\n            mean_bc = mean(`Breast Circumference`))\ntbl_bw_bc_mean\n\n# A tibble: 4 × 3\n  Animal mean_bw mean_bc\n   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1      2    467.    177.\n2      5    495.    179.\n3      7    511.    181.\n4     10    541.    184.\n\n\nFit the regression model\n\nlm_bw_bc_mean &lt;- lm(mean_bw ~ mean_bc, data = tbl_bw_bc_mean)\nsummary(lm_bw_bc_mean)\n\n\nCall:\nlm(formula = mean_bw ~ mean_bc, data = tbl_bw_bc_mean)\n\nResiduals:\n      1       2       3       4 \n-4.9165  6.7035 -0.4726 -1.3144 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept) -1392.453    213.013  -6.537   0.0226 *\nmean_bc        10.518      1.182   8.901   0.0124 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.961 on 2 degrees of freedom\nMultiple R-squared:  0.9754,    Adjusted R-squared:  0.9631 \nF-statistic: 79.23 on 1 and 2 DF,  p-value: 0.01239"
  },
  {
    "objectID": "about.html#asmasss2024-0.10.3",
    "href": "about.html#asmasss2024-0.10.3",
    "title": "About",
    "section": "asmasss2024 0.10.3",
    "text": "asmasss2024 0.10.3\n\nOverhead pictures ohp_l10"
  },
  {
    "objectID": "about.html#asmasss2024-0.10.4",
    "href": "about.html#asmasss2024-0.10.4",
    "title": "About",
    "section": "asmasss2024 0.10.4",
    "text": "asmasss2024 0.10.4\n\nBlood pressure data 20240429_bp_data"
  },
  {
    "objectID": "my_nb/20240429_rep_obs/20240429_rep_obs.html#data-on-blood-pressure",
    "href": "my_nb/20240429_rep_obs/20240429_rep_obs.html#data-on-blood-pressure",
    "title": "Repeated Observations",
    "section": "Data on Blood Pressure",
    "text": "Data on Blood Pressure\nWhen asking ChatGPT the following question\n\n“How to analyse a dataset with single observations in the response variable and repeated observations in the predictor variable using a regression model in R”\n\nThe following answer is provided in summary, the data has to be analysed using\n\ninstall.packages(\"lme4\")\nlibrary(lme4)\n\n# Assuming your response variable is called 'response' and predictor variable is called 'predictor'\n# 'group' represents the grouping variable (e.g., individual ID or time point)\n# 'data' is your dataset\n\nmodel &lt;- lmer(response ~ predictor + (1 | group), data = data)\n\n# results\nsummary(model)\n\n# diagnostics\nplot(model)\n\nThe blood pressure data is given as\n\ns_bp_data_path &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/20240429_bp_data.csv\"\ndf_bp &lt;- read.table(s_bp_data_path, header = T, sep = \",\")\ndf_bp\n\n   Nr SYS DIA PUL MP_Rep ManualPulseFreq\n1   1 150  95  92    MP1             104\n2   1 150  95  92    MP2              92\n3   1 150  95  92    MP3              84\n4   2 135  89  70    MP1              72\n5   2 135  89  70    MP2              70\n6   2 135  89  70    MP3              76\n7   3 121  85  69    MP1              66\n8   3 121  85  69    MP2              72\n9   3 121  85  69    MP3              70\n10  4 122  82  65    MP1              62\n11  4 122  82  65    MP2              68\n12  4 122  82  65    MP3              66\n13  5 113  79  76    MP1              85\n14  5 113  79  76    MP2              84\n15  5 113  79  76    MP3              91\n16  6 139  83  64    MP1              56\n17  6 139  83  64    MP2              72\n18  6 139  83  64    MP3              64\n19  7 116  75  72    MP1              60\n20  7 116  75  72    MP2              64\n21  7 116  75  72    MP3              68\n22  8 137  85  93    MP1              76\n23  8 137  85  93    MP2              84\n24  8 137  85  93    MP3              80\n25  9 133  83  90    MP1              64\n26  9 133  83  90    MP2              68\n27  9 133  83  90    MP3              68\n28 10 129  83  65    MP1              60\n29 10 129  83  65    MP2              68\n30 10 129  83  65    MP3              68\n31 11 105  72  64    MP1              72\n32 11 105  72  64    MP2              80\n33 11 105  72  64    MP3              68\n\n\nThis data can be used to fit a regression of either SYS, DIA or PUL on the average of the repeated observations of ManualPulseFreq. To do this, we have to create a dataset with the means of ManualPulseFreq\n\nlibrary(dplyr)\ntbl_bp_mean &lt;- df_bp %&gt;% \n  group_by(Nr) %&gt;%\n  summarise(mean_man_freq = mean(ManualPulseFreq),\n            mean_sys = mean(SYS),\n            mean_dia = mean(DIA),\n            mean_pul = mean(PUL))\ntbl_bp_mean\n\n# A tibble: 11 × 5\n      Nr mean_man_freq mean_sys mean_dia mean_pul\n   &lt;int&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n 1     1          93.3      150       95       92\n 2     2          72.7      135       89       70\n 3     3          69.3      121       85       69\n 4     4          65.3      122       82       65\n 5     5          86.7      113       79       76\n 6     6          64        139       83       64\n 7     7          64        116       75       72\n 8     8          80        137       85       93\n 9     9          66.7      133       83       90\n10    10          65.3      129       83       65\n11    11          73.3      105       72       64\n\n\nThe computation of the regression coefficient has to be adapted to be able to account for the variability of the repeated observations of the predictors."
  },
  {
    "objectID": "about.html#asmasss2024-0.11.0",
    "href": "about.html#asmasss2024-0.11.0",
    "title": "About",
    "section": "asmasss2024 0.11.0",
    "text": "asmasss2024 0.11.0\n\nExercise 9 asm_ex09\nSolution 8 asm_sol08"
  },
  {
    "objectID": "my_nb/20240429_rep_obs/20240429_rep_obs.html#classification-of-repeated-observation-data",
    "href": "my_nb/20240429_rep_obs/20240429_rep_obs.html#classification-of-repeated-observation-data",
    "title": "Repeated Observations",
    "section": "Classification of Repeated Observation Data",
    "text": "Classification of Repeated Observation Data\nThe following three classes of repeated observation data can be distinguished\n\nRepeated observations in the predictors\nRepeated observations in the response variables\nRepeated observations in both the predictors and the responses\n\n\nRepeated Observations in Predictors\nThis corresponds to the dataset of blood pressure and pulse frequency. This dataset is given by\n\ns_bp_data_path &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/20240429_bp_data.csv\"\ndf_bp &lt;- read.table(s_bp_data_path, header = T, sep = \",\")\ndf_bp\n\n   Nr SYS DIA PUL MP_Rep ManualPulseFreq\n1   1 150  95  92    MP1             104\n2   1 150  95  92    MP2              92\n3   1 150  95  92    MP3              84\n4   2 135  89  70    MP1              72\n5   2 135  89  70    MP2              70\n6   2 135  89  70    MP3              76\n7   3 121  85  69    MP1              66\n8   3 121  85  69    MP2              72\n9   3 121  85  69    MP3              70\n10  4 122  82  65    MP1              62\n11  4 122  82  65    MP2              68\n12  4 122  82  65    MP3              66\n13  5 113  79  76    MP1              85\n14  5 113  79  76    MP2              84\n15  5 113  79  76    MP3              91\n16  6 139  83  64    MP1              56\n17  6 139  83  64    MP2              72\n18  6 139  83  64    MP3              64\n19  7 116  75  72    MP1              60\n20  7 116  75  72    MP2              64\n21  7 116  75  72    MP3              68\n22  8 137  85  93    MP1              76\n23  8 137  85  93    MP2              84\n24  8 137  85  93    MP3              80\n25  9 133  83  90    MP1              64\n26  9 133  83  90    MP2              68\n27  9 133  83  90    MP3              68\n28 10 129  83  65    MP1              60\n29 10 129  83  65    MP2              68\n30 10 129  83  65    MP3              68\n31 11 105  72  64    MP1              72\n32 11 105  72  64    MP2              80\n33 11 105  72  64    MP3              68\n\n\nThis data can be displayed as\n\nlibrary(ggplot2)\np_sys_nr &lt;- ggplot(data = df_bp,\n               mapping = aes(x = ManualPulseFreq,\n                             y = SYS)) + \n  geom_point(aes(color = as.factor(Nr))) + \n  labs(color = \"Individual\")\np_sys_nr\n\n\n\n\n\n\n\n\nThis type of datastructure is comparable to the example where repeated observations are used to predict the breeding value of an animal. The analysis of this type of dataset is done by fitting a linear regression model of the response on the mean of the repeated observations. Hence, we first have to compute the mean of the predictors and then fit the regression model.\n\n# compute the mean\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ntbl_bp_mfreq_mean &lt;- df_bp %&gt;%\n  group_by(Nr) %&gt;%\n  summarise(mean_sys = mean(SYS),\n            mean_dia = mean(DIA),\n            mean_pul = mean(PUL),\n            mean_mfreq = mean(ManualPulseFreq))\ntbl_bp_mfreq_mean\n\n# A tibble: 11 × 5\n      Nr mean_sys mean_dia mean_pul mean_mfreq\n   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n 1     1      150       95       92       93.3\n 2     2      135       89       70       72.7\n 3     3      121       85       69       69.3\n 4     4      122       82       65       65.3\n 5     5      113       79       76       86.7\n 6     6      139       83       64       64  \n 7     7      116       75       72       64  \n 8     8      137       85       93       80  \n 9     9      133       83       90       66.7\n10    10      129       83       65       65.3\n11    11      105       72       64       73.3\n\n\nThe fit of the regression model is\n\nlm_msys_mfreq &lt;- lm(mean_sys ~ mean_mfreq, data = tbl_bp_mfreq_mean)\nsummary(lm_msys_mfreq)\n\n\nCall:\nlm(formula = mean_sys ~ mean_mfreq, data = tbl_bp_mfreq_mean)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-22.459  -6.685   4.270   7.792  15.720 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept) 102.4456    31.4616   3.256   0.0099 **\nmean_mfreq    0.3411     0.4286   0.796   0.4467   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 13.43 on 9 degrees of freedom\nMultiple R-squared:  0.06573,   Adjusted R-squared:  -0.03808 \nF-statistic: 0.6332 on 1 and 9 DF,  p-value: 0.4467\n\n\nIf there are concerns about outliers in the predictors, then the median is more robust against outliers.\n\n\nRepeated Observations in the Response\nThis example corresponds to the dataset with the influence of breed on body weight observed for beef animals. The dataset is given by\n\ns_rep_path_bw_br &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_breed_rep_obs.csv\"\ndf_bw_br_rep &lt;- read.table(s_rep_path_bw_br, header = T, sep = \",\")\ndf_bw_br_rep\n\n   Animal Body.Weight     Breed   Time\n1       2    463.0000     Angus  first\n2       2    468.8940     Angus second\n3       2    467.8753     Angus  third\n4       5    496.0000 Simmental  first\n5       5    495.0033 Simmental second\n6       5    493.6563 Simmental  third\n7       7    518.0000  Limousin  first\n8       7    509.3221  Limousin second\n9       7    506.5958  Limousin  third\n10     10    541.0000  Limousin  first\n11     10    547.3609  Limousin second\n12     10    533.9288  Limousin  third\n\n\nThe plot\n\nlibrary(ggplot2)\nggplot(data = df_bw_br_rep, aes(x = Breed, y = Body.Weight)) + \n  geom_point(aes(color = as.factor(Animal))) + \n  labs(color = \"Animal\")\n\n\n\n\n\n\n\n\nThis dataset is analysed with a linear model using the factor as a random effect which accounts for the variance structure\n\nlibrary(lme4)\n\nLoading required package: Matrix\n\nlmer_bw_br &lt;- lmer(Body.Weight ~ Breed + (1 | Animal), data = df_bw_br_rep)\nsummary(lmer_bw_br)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: Body.Weight ~ Breed + (1 | Animal)\n   Data: df_bw_br_rep\n\nREML criterion at convergence: 61.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.3714 -0.5383  0.0640  0.3213  1.4305 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Animal   (Intercept) 426.21   20.645  \n Residual              22.98    4.794  \nNumber of obs: 12, groups:  Animal, 4\n\nFixed effects:\n               Estimate Std. Error t value\n(Intercept)      466.59      20.83  22.400\nBreedLimousin     59.44      25.51   2.330\nBreedSimmental    28.30      29.46   0.961\n\nCorrelation of Fixed Effects:\n            (Intr) BrdLms\nBreedLimosn -0.816       \nBreedSmmntl -0.707  0.577\n\n\nComparing the variance part of the results of lmer with the results of aov is shown below\n\naov_bw_br &lt;- aov(Body.Weight ~ Breed + Error(Animal), data = df_bw_br_rep)\nsummary(aov_bw_br)\n\n\nError: Animal\n      Df Sum Sq Mean Sq\nBreed  1   8651    8651\n\nError: Within\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nBreed      2   7.38   3.689   0.161  0.854\nResiduals  8 183.84  22.980               \n\n\n\n\nRepeated Observations in Both Predictors and Response\nThis corresponds to the dataset on BW and BC of beef cattle animals. An analysis of such a dataset could be done using Machine Learning techniques. Alternatively, we could also average over the BC-values and treat the data as an instance of the second type by fitting a regression of BW on mean BC.\nThe dataset is given by\n\ns_rep_path_bw_bc &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data/asm_bw_bc_rep_obs.csv\"\ntbl_bw_bc_rep &lt;- readr::read_delim(s_rep_path_bw_bc, delim = \",\")\n\nRows: 12 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (3): Animal, Breast Circumference, Body Weight\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntbl_bw_bc_rep\n\n# A tibble: 12 × 3\n   Animal `Breast Circumference` `Body Weight`\n    &lt;dbl&gt;                  &lt;dbl&gt;         &lt;dbl&gt;\n 1      2                   177           463 \n 2      2                   177.          469.\n 3      2                   177.          468.\n 4      5                   179           496 \n 5      5                   179.          495.\n 6      5                   179.          494.\n 7      7                   181           518 \n 8      7                   181.          509.\n 9      7                   181.          507.\n10     10                   184           541 \n11     10                   185.          547.\n12     10                   183.          534.\n\n\nThe plot shows variation in both predictor and response\n\nlibrary(ggplot2)\np_bw_bc_rep &lt;- ggplot(data = tbl_bw_bc_rep,\n                      mapping = aes(x = `Breast Circumference`,\n                                    y = `Body Weight`)) + \n  geom_point(aes(color = as.factor(Animal))) + \n  labs(color = \"Animal\")\np_bw_bc_rep\n\n\n\n\n\n\n\n\nA simplified analysis is to run a linear model of repeated observations of body weight on the mean of Breast Circumference\n\nlibrary(dplyr)\ntbl_bc_mean &lt;- tbl_bw_bc_rep %&gt;%\n  group_by(Animal) %&gt;% \n  summarise(mean_bc = mean(`Breast Circumference`))\ntbl_bc_mean\n\n# A tibble: 4 × 2\n  Animal mean_bc\n   &lt;dbl&gt;   &lt;dbl&gt;\n1      2    177.\n2      5    179.\n3      7    181.\n4     10    184.\n\n\nJoin back the mean values to the original data set\n\ntbl_bw_bc_mean &lt;- tbl_bw_bc_rep %&gt;%\n  inner_join(tbl_bc_mean, by = c(\"Animal\" = \"Animal\")) %&gt;%\n  select(Animal, `Body Weight`, mean_bc)\ntbl_bw_bc_mean\n\n# A tibble: 12 × 3\n   Animal `Body Weight` mean_bc\n    &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;\n 1      2          463     177.\n 2      2          469.    177.\n 3      2          468.    177.\n 4      5          496     179.\n 5      5          495.    179.\n 6      5          494.    179.\n 7      7          518     181.\n 8      7          509.    181.\n 9      7          507.    181.\n10     10          541     184.\n11     10          547.    184.\n12     10          534.    184.\n\n\nFit the linear model\n\nlibrary(lme4)\nlmer_bw_bc &lt;- lmer(`Body Weight` ~ mean_bc + (1 | Animal), data = tbl_bw_bc_mean)\nsummary(lmer_bw_bc)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: `Body Weight` ~ mean_bc + (1 | Animal)\n   Data: tbl_bw_bc_mean\n\nREML criterion at convergence: 69.6\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-1.48481 -0.56881  0.04596  0.37782  1.37516 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Animal   (Intercept) 27.87    5.279   \n Residual             22.98    4.794   \nNumber of obs: 12, groups:  Animal, 4\n\nFixed effects:\n             Estimate Std. Error t value\n(Intercept) -1392.453    213.013  -6.537\nmean_bc        10.518      1.182   8.901\n\nCorrelation of Fixed Effects:\n        (Intr)\nmean_bc -1.000"
  },
  {
    "objectID": "my_nb/20240429_rep_obs/20240429_rep_obs.html#old-material-is-below-here",
    "href": "my_nb/20240429_rep_obs/20240429_rep_obs.html#old-material-is-below-here",
    "title": "Repeated Observations",
    "section": "Old Material is Below Here",
    "text": "Old Material is Below Here\nThe material below is kept for reference purposes."
  },
  {
    "objectID": "about.html#asmasss2024-0.11.1",
    "href": "about.html#asmasss2024-0.11.1",
    "title": "About",
    "section": "asmasss2024 0.11.1",
    "text": "asmasss2024 0.11.1\n\nSlides l09_rep_obs"
  },
  {
    "objectID": "about.html#asmasss2024-0.11.2",
    "href": "about.html#asmasss2024-0.11.2",
    "title": "About",
    "section": "asmasss2024 0.11.2",
    "text": "asmasss2024 0.11.2\n\nOverhead ohp_l11"
  },
  {
    "objectID": "my_nb/20240506_balanced_rep_obs/20240506_balanced_rep_obs.html",
    "href": "my_nb/20240506_balanced_rep_obs/20240506_balanced_rep_obs.html",
    "title": "Repeated Observations – Second Thoughts and Considerations",
    "section": "",
    "text": "When teaching the topic of repeated observations in Applied Statistical Methods (ASM), the completely unbalanced dataset came to my attention only very late. This might be the reason why the replication of the lme4::lmer() results with aov() was not successful."
  },
  {
    "objectID": "my_nb/20240506_balanced_rep_obs/20240506_balanced_rep_obs.html#disclaimer",
    "href": "my_nb/20240506_balanced_rep_obs/20240506_balanced_rep_obs.html#disclaimer",
    "title": "Repeated Observations – Second Thoughts and Considerations",
    "section": "",
    "text": "When teaching the topic of repeated observations in Applied Statistical Methods (ASM), the completely unbalanced dataset came to my attention only very late. This might be the reason why the replication of the lme4::lmer() results with aov() was not successful."
  },
  {
    "objectID": "my_nb/20240506_balanced_rep_obs/20240506_balanced_rep_obs.html#balanced-dataset",
    "href": "my_nb/20240506_balanced_rep_obs/20240506_balanced_rep_obs.html#balanced-dataset",
    "title": "Repeated Observations – Second Thoughts and Considerations",
    "section": "Balanced Dataset",
    "text": "Balanced Dataset\nTo have an easier understanding of repeated observations, we start with a balanced dataset. At the beginning, we have a dataset of 5 each having 3 observations of Body.Weight. Such a dataset can be generated by first sampling mean body weight for each animal\n\nvec_mean_bw &lt;- rnorm(n_nr_animals, mean = n_bw_mean, sd = n_bw_sd_acc)\nvec_mean_bw\n\n[1] 457.1551 463.8557 463.7186 448.9985 454.1195\n\n\nBased on these means, we add some random deviates to generate individual observations\n\ntbl_bw_rep &lt;- NULL\nfor (i in 1:n_nr_animals){\n  vec_bw_dev &lt;- rnorm(n_nr_rep, sd = n_bw_sd_win)\n  tbl_cur_obs &lt;- tibble::tibble(Animal = rep(i, n_nr_rep),\n                                Body.Weight = vec_mean_bw[i] + vec_bw_dev)\n  if (is.null(tbl_bw_rep)){\n    tbl_bw_rep &lt;- tbl_cur_obs\n  } else {\n    tbl_bw_rep &lt;- dplyr::bind_rows(tbl_bw_rep, tbl_cur_obs)\n  }\n}\ntbl_bw_rep\n\n# A tibble: 15 × 2\n   Animal Body.Weight\n    &lt;int&gt;       &lt;dbl&gt;\n 1      1        457.\n 2      1        458.\n 3      1        457.\n 4      2        465.\n 5      2        463.\n 6      2        464.\n 7      3        463.\n 8      3        463.\n 9      3        465.\n10      4        447.\n11      4        448.\n12      4        448.\n13      5        455.\n14      5        453.\n15      5        454.\n\n\nCheck by the following plot\n\nlibrary(ggplot2)\nggplot(data = tbl_bw_rep,\n       mapping = aes(x = Animal,\n                     y = Body.Weight)) + \n  geom_point(aes(color = as.factor(Animal))) + \n  labs(color = \"Animal\")\n\n\n\n\n\n\n\n\n\nAnalysis\nSeparate variation using the following\n\nAnimal effect\n\n\naov_bw_rep &lt;- aov(Body.Weight ~ Animal, data = tbl_bw_rep)\n(smry_aov_bw_rep &lt;- summary(aov_bw_rep))\n\n            Df Sum Sq Mean Sq F value Pr(&gt;F)  \nAnimal       1  157.5  157.48   4.969 0.0441 *\nResiduals   13  412.0   31.69                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nAnimal in error term\n\n\naov_bw_err &lt;- aov(Body.Weight ~ Error(Animal), data = tbl_bw_rep)\nsummary(aov_bw_err)\n\n\nError: Animal\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nResiduals  1  157.5   157.5               \n\nError: Within\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\nResiduals 13    412   31.69               \n\n\n\n\nMethod of Moments Estimate\nEstimates of variance components are defined by\n\\[E(MSq_R) = \\sigma_R^2\\] and\n\\[E(MSq_A) = \\sigma_R^2 + n * \\sigma_A^2 \\]\nFrom the above we get:\n\nn_msq_res &lt;- smry_aov_bw_rep[[1]][\"Residuals\", \"Mean Sq\"]\n\n\\[\\widehat{\\sigma_R^2} =  31.6933174\\]\n\nn_msq_ani &lt;- smry_aov_bw_rep[[1]][\"Animal\", \"Mean Sq\"]\nn_sigma_a_hat &lt;- (n_msq_ani - n_msq_res) / n_nr_rep\n\n\\[\\widehat{\\sigma_A^2} = \\frac{E(MSq_A) - \\widehat{\\sigma_R^2}}{n} = 41.9273499\\]"
  },
  {
    "objectID": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-2",
    "href": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.11.1",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-3",
    "href": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.11.1",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-4",
    "href": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.11.1",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-5",
    "href": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-5",
    "title": "ASMAS-SS2024 | 0.11.1",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-6",
    "href": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-6",
    "title": "ASMAS-SS2024 | 0.11.1",
    "section": "OHP Picture 6",
    "text": "OHP Picture 6"
  },
  {
    "objectID": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-7",
    "href": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-7",
    "title": "ASMAS-SS2024 | 0.11.1",
    "section": "OHP Picture 7",
    "text": "OHP Picture 7"
  },
  {
    "objectID": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-8",
    "href": "ohp/20240506_ohp_l11/20240506_ohp_l11.html#ohp-picture-8",
    "title": "ASMAS-SS2024 | 0.11.1",
    "section": "OHP Picture 8",
    "text": "OHP Picture 8"
  },
  {
    "objectID": "about.html#asmasss2024-0.12.0",
    "href": "about.html#asmasss2024-0.12.0",
    "title": "About",
    "section": "asmasss2024 0.12.0",
    "text": "asmasss2024 0.12.0\n\nCourse notes 042_rep_model.pdf"
  },
  {
    "objectID": "my_nb/20240510_facts_lme/20240510_facts_lme.html",
    "href": "my_nb/20240510_facts_lme/20240510_facts_lme.html",
    "title": "Facts about Usage of LME in Livestock Breeding",
    "section": "",
    "text": "Facts important for usage of LME in livestock breeding are presented"
  },
  {
    "objectID": "my_nb/20240510_facts_lme/20240510_facts_lme.html#disclaimer",
    "href": "my_nb/20240510_facts_lme/20240510_facts_lme.html#disclaimer",
    "title": "Facts about Usage of LME in Livestock Breeding",
    "section": "",
    "text": "Facts important for usage of LME in livestock breeding are presented"
  },
  {
    "objectID": "my_nb/20240510_facts_lme/20240510_facts_lme.html#background",
    "href": "my_nb/20240510_facts_lme/20240510_facts_lme.html#background",
    "title": "Facts about Usage of LME in Livestock Breeding",
    "section": "Background",
    "text": "Background\nParents do not pass phenotypes to their offspring but just a random sample of their alleles. This can be seen by the following scheme\n\n\n\n\n\n\n\n\n\nAs a consequence it is not efficient to select animals as parents based on their phenotypic record. What we need is a measure for the random sample of alleles that are passed from parents to offspring. This measure is called the breeding value and is often termed by the variable \\(u\\). As such, the breeding value \\(u_i\\) of animal \\(i\\) cannot be observed. The above figure shows the relationship between the phenotype \\(y_i\\) of animal \\(i\\) and its breeding value \\(u_i\\). Since, the breeding value \\(u_i\\) cannot be observed or measured, we try to predict it based on phenotypic observations \\(y_i\\)."
  },
  {
    "objectID": "my_nb/20240510_facts_lme/20240510_facts_lme.html#prediction-of-breeding-values",
    "href": "my_nb/20240510_facts_lme/20240510_facts_lme.html#prediction-of-breeding-values",
    "title": "Facts about Usage of LME in Livestock Breeding",
    "section": "Prediction of Breeding Values",
    "text": "Prediction of Breeding Values\nLet us assume for a moment that breeding values can be observed or measured for a group of animals. Furthermore each of these animals also has a phenotypic observation. Then the breeding values \\(u_i\\) and the phenotypic observations \\(y_i\\) can be plotted in a coordinate system where the breeding values are shown on the ordinate. For a given number of animals this might look as follows\n\nset.seed(1205)\nn_mu_u &lt;- 9.3\nn_sd_u &lt;- 1.7\nn_mu_y &lt;- 12.4\nn_h2 &lt;- 0.36\nn_sd_y &lt;- n_sd_u / sqrt(n_h2)\nn_nr_ani &lt;- 10\nvec_y &lt;- rnorm(n_nr_ani, mean = n_mu_y, sd = n_sd_y)\nvec_u &lt;- n_h2 * vec_y + rnorm(n_nr_ani, sd = 0.2)\nvec_u &lt;- vec_u - mean(vec_u) + n_mu_u\ntbl_data &lt;- tibble::tibble(`Breeding Value` = vec_u,\n                           Phenotype = vec_y)\nlm_bv_phen &lt;- lm(`Breeding Value` ~ Phenotype, data = tbl_data)\n# plot\nlibrary(ggplot2)\np &lt;- ggplot(data = tbl_data, \n       mapping = aes(x = Phenotype,\n                     y = `Breeding Value`)) + \n  geom_point() + \n  geom_abline(slope = lm_bv_phen$coefficients[[\"Phenotype\"]],\n              intercept = lm_bv_phen$coefficients[[\"(Intercept)\"]],\n              colour = \"red\")\nggsave(\"bv-phen.pdf\", p)\n\nSaving 7 x 5 in image\n\nggsave(\"bv-phen.png\", p)\n\nSaving 7 x 5 in image\n\n\nFor a new animal \\(i\\) with a phenotypic observation \\(y_i\\), the breeding value can be predicted using the regression line. From that we get\n\\[\\widehat{u_i} = \\mu_u + b * (y_i - \\mu_y)\\]\nwith \\(\\mu_u\\), the mean or the expected value of \\(u\\), similarly for \\(\\mu_y\\). The regression coefficient \\(b\\) is computed as\n\\[b = \\frac{cov(u,y)}{var(y)}\\]\nLooking at this prediction process from the point of view of distributions and assuming that \\(y\\) and \\(u\\) are normally distributed, then the above regression equation corresponds to the conditional expectation of \\(u\\) given \\(y\\) interpreted as a function of \\(y\\). Hence\n\\[\\widehat{u_i} = E(u_i | y_i) = E(u_i) + \\frac{cov(u_i, y_i)}{var(y_i)} * (y_i - E(y_i))\\]"
  },
  {
    "objectID": "my_nb/20240510_facts_lme/20240510_facts_lme.html#generalisation",
    "href": "my_nb/20240510_facts_lme/20240510_facts_lme.html#generalisation",
    "title": "Facts about Usage of LME in Livestock Breeding",
    "section": "Generalisation",
    "text": "Generalisation\nThe above developed prediction process can be generalized. Given that we have the linear mixed effects model for a vector \\(y\\) of length \\(n\\) with observations, we can write\n\\[y = Xb + Zu + e\\]\nwith vectors\n\n\\(b\\) of length \\(p\\) containing fixed effects,\n\\(u\\) of length \\(q\\) with random breeding values and\n\\(e\\) of length \\(n\\) with random residuals.\n\nIn the above model, there are two vectors with random effects, hence this model is a linear mixed effects model. The expected values and the variance-covariance matrices of the random components can be specified as\n\\[\nE\\left[\\begin{array}{c} y \\\\ u \\\\ e \\end{array} \\right] = \\left[\\begin{array}{c} Xb \\\\ 0 \\\\ 0 \\end{array} \\right]\n\\]\n\\[\nvar\\left[\\begin{array}{c} y \\\\ u \\\\ e \\end{array} \\right] = \\left[\\begin{array}{ccc} V  & ZU  &  R\\\\  UZ^T  &  U  &  0\\\\ R  &  0  &  R\\end{array} \\right]\n\\]\nwith\n\n\\(R = I * \\sigma_e^2\\)\n\\(U = A * \\sigma_u^2\\), where \\(A\\) is a genetic relationship matrix\n\\(V = ZUZ^T + R\\)\n\nThe prediction of the breeding values in vector \\(u\\), is also based on the conditional mean \\(E(u | y)\\). This can be written as shown above\n\\[\\widehat{u} = E(u | y) = E(u) + cov(u, y^T) \\cdot var(y)^{-1} \\cdot (y - E(y))\\]\nInserting the above made specification, we obtain\n\\[\\widehat{u} = UZ^T \\cdot V^{-1} \\cdot (y - Xb)\\]\nBecause \\(b\\) is not known, it is replaced by the BLUE estimate \\(\\widehat{b}\\) which is given by\n\\[\\widehat{b} = (X^TV^{-1}X)^- X^TV^{-1}y \\]"
  },
  {
    "objectID": "my_nb/20240510_facts_lme/20240510_facts_lme.html#properties-of-estimates",
    "href": "my_nb/20240510_facts_lme/20240510_facts_lme.html#properties-of-estimates",
    "title": "Facts about Usage of LME in Livestock Breeding",
    "section": "Properties of Estimates",
    "text": "Properties of Estimates\nThe following properties of the estimates can be shown\n\nFixed Effects\nWith\n\\[\\widehat{b} = (X^TV^{-1}X)^- X^TV^{-1}y \\]\n\nThe expected value is obtained by\n\n\\[E((X^TV^{-1}X)\\widehat{b}) = E((X^TV^{-1}X)(X^TV^{-1}X)^- X^TV^{-1}y) = X(X^TV^{-1}X)^- X^TV^{-1} \\cdot E(y) =  (X^TV^{-1}X)(X^TV^{-1}X)^- X^TV^{-1}Xb = (X^TV^{-1}X)b\\] Hence, estimable functions are unbiased.\n\nThe variance of the estimater is\n\n\\[var(\\widehat{b}) = var((X^TV^{-1}X)^- X^TV^{-1}y) = (X^TV^{-1}X)^- X^TV^{-1} var(y) V^{-1} X (X^TV^{-1}X)^- = (X^TV^{-1}X)^- X^T V^{-1} X (X^TV^{-1}X)^- =  (X^TV^{-1}X)^-\\]\nAlternative estimator\n\\[\\widehat{b}^* = \\widehat{b} + \\epsilon\\]\n\n\nRandom Effects\n\nunbiased\nminimum predicetion error variances"
  },
  {
    "objectID": "my_nb/20240510_facts_lme/20240510_facts_lme.html#solution-via-mixed-model-equations",
    "href": "my_nb/20240510_facts_lme/20240510_facts_lme.html#solution-via-mixed-model-equations",
    "title": "Facts about Usage of LME in Livestock Breeding",
    "section": "Solution via Mixed Model Equations",
    "text": "Solution via Mixed Model Equations"
  },
  {
    "objectID": "about.html#asmasss2024-0.12.1",
    "href": "about.html#asmasss2024-0.12.1",
    "title": "About",
    "section": "asmasss2024 0.12.1",
    "text": "asmasss2024 0.12.1\n\nTest exam asm_exam_tsk\nSolution to test exam asm_exam_sol"
  },
  {
    "objectID": "about.html#asmasss2024-0.12.2",
    "href": "about.html#asmasss2024-0.12.2",
    "title": "About",
    "section": "asmasss2024 0.12.2",
    "text": "asmasss2024 0.12.2\n\nSlides l10_lme_app"
  },
  {
    "objectID": "about.html#asmasss2024-0.12.3",
    "href": "about.html#asmasss2024-0.12.3",
    "title": "About",
    "section": "asmasss2024 0.12.3",
    "text": "asmasss2024 0.12.3\n\nOHP ohp_l12"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-2",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-2",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 2",
    "text": "OHP Picture 2"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-3",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-3",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 3",
    "text": "OHP Picture 3"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-4",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-4",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 4",
    "text": "OHP Picture 4"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-5",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-5",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 5",
    "text": "OHP Picture 5"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-6",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-6",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 6",
    "text": "OHP Picture 6"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-7",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-7",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 7",
    "text": "OHP Picture 7"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-8",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-8",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 8",
    "text": "OHP Picture 8"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-9",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-9",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 9",
    "text": "OHP Picture 9"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-10",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-10",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 10",
    "text": "OHP Picture 10"
  },
  {
    "objectID": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-11",
    "href": "ohp/20240513_ohp_l12/20240513_ohp_l12.html#ohp-picture-11",
    "title": "ASMAS-SS2024 | 0.12.2",
    "section": "OHP Picture 11",
    "text": "OHP Picture 11"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html",
    "href": "slides/l10_app_lme/l10_app_lme.html",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "",
    "text": "Parents pass a random sample of alleles to offspring\nSelection of parents on phenotypes inefficient"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#background",
    "href": "slides/l10_app_lme/l10_app_lme.html#background",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "",
    "text": "Parents pass a random sample of alleles to offspring\nSelection of parents on phenotypes inefficient"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#selection-criterion",
    "href": "slides/l10_app_lme/l10_app_lme.html#selection-criterion",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Selection Criterion",
    "text": "Selection Criterion\n\nQuantify value of alleles passed from parent to offspring\nRequires decomposition of effect of genotype on phenotype"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#model-based-on-decomposition-of-genotype",
    "href": "slides/l10_app_lme/l10_app_lme.html#model-based-on-decomposition-of-genotype",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Model Based on Decomposition of Genotype",
    "text": "Model Based on Decomposition of Genotype\n\nFurther transformation of genotype decomposition"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#statistical-model",
    "href": "slides/l10_app_lme/l10_app_lme.html#statistical-model",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Statistical Model",
    "text": "Statistical Model\n\nLinear Mixed Effects Model\n\n\\[y = Xb + Zu + e \\]\n\nwith vectors\n\n\\(y\\) of length \\(n\\) with observations\n\\(b\\) of length \\(p\\) with fixed effects\n\\(u\\) of length \\(q\\) with random breeding values\n\\(e\\) of length \\(n\\) with random residuals\n\nwith design matrices \\(X\\) and \\(Z\\)"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#assumptions",
    "href": "slides/l10_app_lme/l10_app_lme.html#assumptions",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Assumptions",
    "text": "Assumptions\nExpected values and variance-covariance matrices of all random components\n\\[\nE\\left[\\begin{array}{c} y \\\\ u \\\\ e \\end{array} \\right] = \\left[\\begin{array}{c} Xb \\\\ 0 \\\\ 0 \\end{array} \\right]\n\\]\n\\[\nvar\\left[\\begin{array}{c} y \\\\ u \\\\ e \\end{array} \\right] = \\left[\\begin{array}{ccc} V  & ZU  &  R\\\\  UZ^T  &  U  &  0\\\\ R  &  0  &  R\\end{array} \\right]\n\\]\nwith\n\n\\(R = I * \\sigma_e^2\\)\n\\(U = A * \\sigma_u^2\\), where \\(A\\) is a genetic relationship matrix\n\\(V = ZUZ^T + R\\)"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#inference",
    "href": "slides/l10_app_lme/l10_app_lme.html#inference",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Inference",
    "text": "Inference\n\nEstimates of unknown fixed effects (\\(b\\))\nPredictions of \\(u\\)\n\nAnalogous to fixed effects model, estimates \\(\\widehat{b}\\) are given by\n\\[\\widehat{b} = (X^TV^{-1}X)^- X^TV^{-1}y \\]"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#prediction-of-breeding-values",
    "href": "slides/l10_app_lme/l10_app_lme.html#prediction-of-breeding-values",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Prediction of Breeding Values",
    "text": "Prediction of Breeding Values\nAssume, breeding values (\\(u\\)) and phenotypes (\\(y\\)) can be observed"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#prediction-of-breeding-values-ii",
    "href": "slides/l10_app_lme/l10_app_lme.html#prediction-of-breeding-values-ii",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Prediction of Breeding Values II",
    "text": "Prediction of Breeding Values II\n\nFor new animal \\(i\\) with phenotypic observation \\(y_i\\)\nBreeding value \\(u_i\\) can be predicted based on regression line, as\n\n\\[\\widehat{u_i} = \\mu_u + b * (y_i - \\mu_y)\\]"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#generalisation",
    "href": "slides/l10_app_lme/l10_app_lme.html#generalisation",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Generalisation",
    "text": "Generalisation\n\nAssuming multi-variate normal distributions for \\(y\\), \\(u\\) and \\(e\\)\nFor animal \\(i\\)\n\n\\[\\widehat{u_i} = E(u_i | y_i) = E(u_i) + \\frac{cov(u_i, y_i)}{var(y_i)} * (y_i - E(y_i))\\]\n\nFor a group of animals\n\n\\[\\widehat{u} = E(u | y) = E(u) + cov(u, y^T) \\cdot var(y)^{-1} \\cdot (y - E(y))\\]\n\\[\\widehat{u} = UZ^T \\cdot V^{-1} \\cdot (y - Xb)\\]"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#simplified-solution-mixed-model-equations",
    "href": "slides/l10_app_lme/l10_app_lme.html#simplified-solution-mixed-model-equations",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Simplified Solution: Mixed Model Equations",
    "text": "Simplified Solution: Mixed Model Equations\n\\[\n\\left[\n  \\begin{array}{lr}\n  X^T R^{-1} X  &  X^T R^{-1} Z \\\\\n  Z^T R^{-1} X  &  Z^T R^{-1} Z + U^{-1}\n  \\end{array}\n\\right]\n\\left[\n  \\begin{array}{c}\n  \\hat{\\beta} \\\\\n  \\hat{u}\n  \\end{array}\n\\right]\n=\n\\left[\n  \\begin{array}{c}\n  X^T R^{-1} y \\\\\n  Z^T R^{-1} y\n  \\end{array}\n\\right]\n\\]\nwith \\(R = I * \\sigma_e^2\\)\n\\[\n\\left[\n  \\begin{array}{lr}\n  X^T X  &  X^T  Z \\\\\n  Z^T  X  &  Z^T  Z + \\lambda A^{-1}\n  \\end{array}\n\\right]\n\\left[\n  \\begin{array}{c}\n  \\hat{\\beta} \\\\\n  \\hat{u}\n  \\end{array}\n\\right]\n=\n\\left[\n  \\begin{array}{c}\n  X^T  y \\\\\n  Z^T  y\n  \\end{array}\n\\right]\n\\]\nwith \\(\\lambda = \\sigma_e^2 / \\sigma_u^2\\)"
  },
  {
    "objectID": "slides/l10_app_lme/l10_app_lme.html#examples",
    "href": "slides/l10_app_lme/l10_app_lme.html#examples",
    "title": "Applications of Linear Mixed Effects Models",
    "section": "Examples",
    "text": "Examples\n\nSire model\nAnimal model\nGenomic BLUP"
  },
  {
    "objectID": "about.html#asmasss2024-0.12.4",
    "href": "about.html#asmasss2024-0.12.4",
    "title": "About",
    "section": "asmasss2024 0.12.4",
    "text": "asmasss2024 0.12.4\n\nExercise asm_ex10\nSolution asm_sol10"
  },
  {
    "objectID": "about.html#asmasss2024-0.12.5",
    "href": "about.html#asmasss2024-0.12.5",
    "title": "About",
    "section": "asmasss2024 0.12.5",
    "text": "asmasss2024 0.12.5\n\nExercise asm_ex11\nSolution asm_sol11"
  },
  {
    "objectID": "exam/asm_exam_read_data/asm_exam_read_data.html",
    "href": "exam/asm_exam_read_data/asm_exam_read_data.html",
    "title": "Exam in Applied Statistical Methods",
    "section": "",
    "text": "The following statements can be used to read the datasets for the exam."
  },
  {
    "objectID": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-1-linear-regression",
    "href": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-1-linear-regression",
    "title": "Exam in Applied Statistical Methods",
    "section": "Problem 1: Linear Regression",
    "text": "Problem 1: Linear Regression\n\nDataframe\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p1 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p01.csv\")\ndf_p1 &lt;- read.table(s_data_url_p1, header = T, sep = \",\")\ndim(df_p1)\n\n[1] 20  3\n\n\n\n\nTibble\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p1 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p01.csv\")\ntbl_p1 &lt;- readr::read_delim(file = s_data_url_p1, delim = \",\")\ndim(tbl_p1)\n\n[1] 20  3"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-1",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-1",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-2",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-2",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-3",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-3",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-4",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-4",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-5",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-5",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-6",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-6",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-7",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-7",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-8",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-8",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-9",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-9",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-10",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-10",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-11",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-11",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-12",
    "href": "exam/asm_exam_tsk/asm_exam_tsk.html#solution-12",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html",
    "title": "ASM Exam 2024: Problem 5",
    "section": "",
    "text": "The data for LME is constructed. This includes adding parents to current records. Use parameter from Problem 1 …\n\nset.seed(2405)\nn_nr_obs &lt;- 20\n# dim\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\n# citrate\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.5\n# genetics\nn_cit_h2 &lt;- 0.36\nn_cit_sigma_u &lt;- sqrt(n_cit_h2) * n_cit_sd\nn_cit_sigma_e &lt;- sqrt(1-n_cit_h2) * n_cit_sd\n# pedigree\nn_nr_sire &lt;- 4\nvec_nr_daughter &lt;- c(6,5,6,3)\nn_nr_anim &lt;- n_nr_sire + n_nr_obs"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#background",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#background",
    "title": "ASM Exam 2024: Problem 5",
    "section": "",
    "text": "The data for LME is constructed. This includes adding parents to current records. Use parameter from Problem 1 …\n\nset.seed(2405)\nn_nr_obs &lt;- 20\n# dim\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\n# citrate\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.5\n# genetics\nn_cit_h2 &lt;- 0.36\nn_cit_sigma_u &lt;- sqrt(n_cit_h2) * n_cit_sd\nn_cit_sigma_e &lt;- sqrt(1-n_cit_h2) * n_cit_sd\n# pedigree\nn_nr_sire &lt;- 4\nvec_nr_daughter &lt;- c(6,5,6,3)\nn_nr_anim &lt;- n_nr_sire + n_nr_obs"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#pedigree",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#pedigree",
    "title": "ASM Exam 2024: Problem 5",
    "section": "Pedigree",
    "text": "Pedigree\nBuild up the components of the pedigree\n\n# sires\nvec_sire &lt;- NULL\nfor (s_idx in 1:n_nr_sire){\n  vec_cur_sire &lt;- rep(s_idx, vec_nr_daughter[s_idx])\n  if (is.null(vec_sire)){\n    vec_sire &lt;- vec_cur_sire\n  } else {\n    vec_sire &lt;- c(vec_sire, vec_cur_sire)\n  }\n}\n#vec_sire\n# equal number of daughters per dam\nvec_dam &lt;- rep(1:9, 2)\nvec_dam &lt;- vec_dam[order(vec_dam)] + n_nr_sire\nn_nr_dam &lt;- length(vec_dam)\nvec_dam &lt;- c(rep(NA,(n_nr_obs-n_nr_dam)), vec_dam)\n# setup pedigree\nlibrary(pedigreemm)\n\nLoading required package: lme4\n\n\nLoading required package: Matrix\n\nped_p05 &lt;- pedigree(sire = c(rep(NA, n_nr_sire), vec_sire),\n                                dam =  c(rep(NA, n_nr_sire), vec_dam),\n                                label = as.character(1:n_nr_anim))\nmat_A_p05 &lt;- as.matrix(getA(ped = ped_p05))\n\n'as(&lt;dtTMatrix&gt;, \"dtCMatrix\")' is deprecated.\nUse 'as(., \"CsparseMatrix\")' instead.\nSee help(\"Deprecated\") and help(\"Matrix-deprecated\").\n\nmat_chol_A &lt;- chol(mat_A_p05)"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#data-simulation",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#data-simulation",
    "title": "ASM Exam 2024: Problem 5",
    "section": "Data Simulation",
    "text": "Data Simulation\nThe DIM values are sampled from a uniform distribution determined by the DIM-range.\n\nvec_dim &lt;- round(runif(n_nr_obs, min = n_dim_start, max = n_dim_end), digits = 0)\nvec_dim &lt;- vec_dim[order(vec_dim)]\nvec_dim\n\n [1] 22 22 22 24 24 24 25 26 27 29 29 30 31 33 35 36 42 44 44 46\n\n\nThe vector of breeds is sampled randomly\n\nvec_breed_eff &lt;- c(0, 0.46)\nvec_breed_name &lt;- c(\"BS\", \"HO\")\nvec_breed &lt;- sample(vec_breed_name, n_nr_obs, replace = T)\nvec_breed\n\n [1] \"BS\" \"HO\" \"BS\" \"BS\" \"BS\" \"BS\" \"BS\" \"HO\" \"HO\" \"BS\" \"BS\" \"BS\" \"HO\" \"HO\" \"HO\"\n[16] \"HO\" \"HO\" \"HO\" \"BS\" \"BS\"\n\n\nThe data is generated using breed as factor\n\nvec_breed_fct &lt;- as.factor(vec_breed)\nmat_X_breed &lt;- model.matrix(y ~ breed, data = data.frame(y = rep(1, n_nr_obs), breed = vec_breed_fct))\nattr(mat_X_breed, \"assign\") &lt;- NULL\nattr(mat_X_breed, \"contrasts\") &lt;- NULL\ndimnames(mat_X_breed) &lt;- NULL\nmat_X_breed\n\n      [,1] [,2]\n [1,]    1    0\n [2,]    1    1\n [3,]    1    0\n [4,]    1    0\n [5,]    1    0\n [6,]    1    0\n [7,]    1    0\n [8,]    1    1\n [9,]    1    1\n[10,]    1    0\n[11,]    1    0\n[12,]    1    0\n[13,]    1    1\n[14,]    1    1\n[15,]    1    1\n[16,]    1    1\n[17,]    1    1\n[18,]    1    1\n[19,]    1    0\n[20,]    1    0\n\n\nGenerate the data\n\nvec_true_u &lt;- crossprod(t(mat_chol_A), rnorm(n_nr_anim, sd = n_cit_sigma_u))\nvec_cit &lt;- n_reg_intc + n_reg_coef * vec_dim + \n  crossprod(t(mat_X_breed), vec_breed_eff) + \n  vec_true_u[(n_nr_sire + 1):n_nr_anim] + \n  rnorm(n_nr_obs, mean = 0, sd = n_cit_sigma_e)\nvec_cit_round &lt;- round(vec_cit, digits = 2)\ntbl_cit_dim_br &lt;- tibble::tibble(ID = c((n_nr_sire + 1):n_nr_anim),\n                                 Sire = vec_sire,\n                                 Dam = vec_dam,\n                                 DIM = vec_dim,\n                                 Breed = vec_breed,\n                                 Citrate = vec_cit_round[,1])\ntbl_cit_dim_br\n\n# A tibble: 20 × 6\n      ID  Sire   Dam   DIM Breed Citrate\n   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;\n 1     5     1    NA    22 BS       9.3 \n 2     6     1    NA    22 HO       9.26\n 3     7     1     5    22 BS       8.92\n 4     8     1     5    24 BS       9.3 \n 5     9     1     6    24 BS       9.03\n 6    10     1     6    24 BS       8.82\n 7    11     2     7    25 BS       9.09\n 8    12     2     7    26 HO       9.04\n 9    13     2     8    27 HO       9.71\n10    14     2     8    29 BS       8.52\n11    15     2     9    29 BS       9.18\n12    16     3     9    30 BS       8.85\n13    17     3    10    31 HO       9.04\n14    18     3    10    33 HO       9.04\n15    19     3    11    35 HO       9.44\n16    20     3    11    36 HO       9.18\n17    21     3    12    42 HO       8.88\n18    22     4    12    44 HO       8.96\n19    23     4    13    44 BS       8.74\n20    24     4    13    46 BS       8.52"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#write-data",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p05/20240524_asm_exam_2024_p05.html#write-data",
    "title": "ASM Exam 2024: Problem 5",
    "section": "Write Data",
    "text": "Write Data\n\ns_cit_dim_br_path &lt;- here::here(\"docs\", \"data\", \"asm_exam_2024_p05.csv\")\n# unlink(s_cit_dim_br_path)\nif (!file.exists(s_cit_dim_br_path)){\n  readr::write_delim(tbl_cit_dim_br, file = s_cit_dim_br_path, delim = \",\")\n}"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html",
    "title": "ASM Exam 2024: Problem 3",
    "section": "",
    "text": "Include interactions between breed and DIM into the dataset. Use parameter from Problem 1 …\n\nset.seed(2405)\nn_nr_obs &lt;- 20\n# dim\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\n# citrate\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.0\nn_intac_br_dim &lt;- -n_reg_coef / 25"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#background",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#background",
    "title": "ASM Exam 2024: Problem 3",
    "section": "",
    "text": "Include interactions between breed and DIM into the dataset. Use parameter from Problem 1 …\n\nset.seed(2405)\nn_nr_obs &lt;- 20\n# dim\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\n# citrate\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.0\nn_intac_br_dim &lt;- -n_reg_coef / 25"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#data-simulation",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#data-simulation",
    "title": "ASM Exam 2024: Problem 3",
    "section": "Data Simulation",
    "text": "Data Simulation\nThe DIM values are sampled from a uniform distribution determined by the DIM-range.\n\nvec_dim &lt;- round(runif(n_nr_obs, min = n_dim_start, max = n_dim_end), digits = 0)\nvec_dim &lt;- vec_dim[order(vec_dim)]\nvec_dim\n\n [1] 22 22 22 24 24 24 25 26 27 29 29 30 31 33 35 36 42 44 44 46\n\n\nThe vector of breeds is sampled randomly\n\nvec_breed_eff &lt;- c(0, 0.46)\nvec_breed_name &lt;- c(\"BS\", \"HO\")\nvec_breed &lt;- sample(vec_breed_name, n_nr_obs, replace = T)\nvec_breed\n\n [1] \"BS\" \"HO\" \"BS\" \"BS\" \"BS\" \"BS\" \"BS\" \"HO\" \"HO\" \"BS\" \"BS\" \"BS\" \"HO\" \"HO\" \"HO\"\n[16] \"HO\" \"HO\" \"HO\" \"BS\" \"BS\"\n\n\nThe data is generated using breed as factor, DIM as regression coefficient and an interaction between DIM and breed\n\nvec_breed_fct &lt;- as.factor(vec_breed)\nmat_X_dim_breed &lt;- model.matrix(y ~ breed * dim, \n                                data = data.frame(y = rep(1, n_nr_obs), \n                                                  breed = vec_breed_fct,\n                                                  dim = vec_dim))\nattr(mat_X_dim_breed, \"assign\") &lt;- NULL\nattr(mat_X_dim_breed, \"contrasts\") &lt;- NULL\ndimnames(mat_X_dim_breed) &lt;- NULL\nmat_X_dim_breed\n\n      [,1] [,2] [,3] [,4]\n [1,]    1    0   22    0\n [2,]    1    1   22   22\n [3,]    1    0   22    0\n [4,]    1    0   24    0\n [5,]    1    0   24    0\n [6,]    1    0   24    0\n [7,]    1    0   25    0\n [8,]    1    1   26   26\n [9,]    1    1   27   27\n[10,]    1    0   29    0\n[11,]    1    0   29    0\n[12,]    1    0   30    0\n[13,]    1    1   31   31\n[14,]    1    1   33   33\n[15,]    1    1   35   35\n[16,]    1    1   36   36\n[17,]    1    1   42   42\n[18,]    1    1   44   44\n[19,]    1    0   44    0\n[20,]    1    0   46    0\n\n\nGenerate the data\n\nvec_dim_br_int_eff &lt;- c(n_reg_intc, vec_breed_eff[2], n_reg_coef, n_intac_br_dim)\nvec_cit &lt;- crossprod(t(mat_X_dim_breed), vec_dim_br_int_eff) + rnorm(n_nr_obs, mean = 0, sd = n_cit_sd)\nvec_cit_round &lt;- round(vec_cit, digits = 2)\ntbl_cit_dim_br_intac &lt;- tibble::tibble(Cow = c(1:n_nr_obs),\n                                 DIM = vec_dim,\n                                 Breed = vec_breed,\n                                 Citrate = vec_cit_round[,1])\ntbl_cit_dim_br_intac\n\n# A tibble: 20 × 4\n     Cow   DIM Breed Citrate\n   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;\n 1     1    22 BS       8.21\n 2     2    22 HO       9.51\n 3     3    22 BS       8.34\n 4     4    24 BS       8.37\n 5     5    24 BS       8.53\n 6     6    24 BS       8.07\n 7     7    25 BS       8.75\n 8     8    26 HO       8.74\n 9     9    27 HO       9.1 \n10    10    29 BS       8.16\n11    11    29 BS       8.3 \n12    12    30 BS       8.3 \n13    13    31 HO       9.2 \n14    14    33 HO       8.75\n15    15    35 HO       9.16\n16    16    36 HO       8.36\n17    17    42 HO       8.3 \n18    18    44 HO       8.49\n19    19    44 BS       8.17\n20    20    46 BS       8.06"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#plot",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#plot",
    "title": "ASM Exam 2024: Problem 3",
    "section": "Plot",
    "text": "Plot\n\nlibrary(ggplot2)\np &lt;- ggplot(data = tbl_cit_dim_br_intac, \n            aes(x = DIM, y = Citrate)) + \n  geom_point(aes(color = Breed))\np"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#write-data",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#write-data",
    "title": "ASM Exam 2024: Problem 3",
    "section": "Write Data",
    "text": "Write Data\nThe data is written to a file\n\ns_cit_dim_br_intac_path &lt;- here::here(\"docs\", \"data\", \"asm_exam_2024_p03.csv\")\n#unlink(s_cit_dim_br_intac_path)\nif (!file.exists(s_cit_dim_br_intac_path)){\n  readr::write_delim(tbl_cit_dim_br_intac, file = s_cit_dim_br_intac_path, delim = \",\")\n}"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#group-means",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#group-means",
    "title": "ASM Exam 2024: Problem 3",
    "section": "Group Means",
    "text": "Group Means\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ntbl_cit_dim_br_intac_gr_mean &lt;- tbl_cit_dim_br_intac %&gt;% \n  group_by(Breed) %&gt;%\n  summarise(Cit_Group_Mean = mean(Citrate),\n            DIM_Group_Mean = mean(DIM))\ntbl_cit_dim_br_intac_gr_mean\n\n# A tibble: 2 × 3\n  Breed Cit_Group_Mean DIM_Group_Mean\n  &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;\n1 BS              8.30           29  \n2 HO              8.85           32.9"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#linear-model",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p03/20240524_asm_exam_2024_p03.html#linear-model",
    "title": "ASM Exam 2024: Problem 3",
    "section": "Linear Model",
    "text": "Linear Model\n\nlm_cit_dim_br_intac &lt;- lm(Citrate ~ DIM * Breed, data = tbl_cit_dim_br_intac)\nsmry_lm_cit_dim_br_intac &lt;- summary(lm_cit_dim_br_intac)\nsmry_lm_cit_dim_br_intac\n\n\nCall:\nlm(formula = Citrate ~ DIM * Breed, data = tbl_cit_dim_br_intac)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.40476 -0.13973  0.00115  0.13979  0.40915 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  8.618906   0.274677  31.378 8.45e-16 ***\nDIM         -0.011122   0.009131  -1.218  0.24084    \nBreedHO      1.655131   0.481022   3.441  0.00336 ** \nDIM:BreedHO -0.032311   0.014883  -2.171  0.04531 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2423 on 16 degrees of freedom\nMultiple R-squared:  0.7172,    Adjusted R-squared:  0.6642 \nF-statistic: 13.53 on 3 and 16 DF,  p-value: 0.0001181"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p01/20240524_asm_exam_2024_p01.html",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p01/20240524_asm_exam_2024_p01.html",
    "title": "ASM Exam 2024: Problem 1",
    "section": "",
    "text": "According to (Chen et al. 2023), Milk Citrate concentration (mmol/L) is an important biomarker for Negative Energy Balance (NEB). In their paper they found the following numbers\n\nset.seed(2405)\nn_nr_obs &lt;- 20\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\ntbl_cit_desc_stat &lt;- tibble::tibble(Trait = c(\"Citrate1\", \"Citrate2\", \"Citrate3+\"),\n                                    Minimum = c(4.07, 4.05, 3.97), \n                                    Maximum = c(14.14, 14.18, 14.18), \n                                    Mean = c(8.93, 8.93, 9.18), \n                                    SD = c(1.48, 1.63, 1.76))\ntbl_cit_desc_stat\n\n# A tibble: 3 × 5\n  Trait     Minimum Maximum  Mean    SD\n  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Citrate1     4.07    14.1  8.93  1.48\n2 Citrate2     4.05    14.2  8.93  1.63\n3 Citrate3+    3.97    14.2  9.18  1.76\n\n\nBetween DIM 20 and 50, the relationship between Milk Citrate and DIM is nearly linear. This is shown by the following screenshot of Figure 1 in (Chen et al. 2023).\n\n\n\n\n\n\n\n\n\nThis can be modeled by a regression model. Based on the plot and due to the fact that we restrict the DIM range, we have to adapt some of the parameters.\n\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.5"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p01/20240524_asm_exam_2024_p01.html#background",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p01/20240524_asm_exam_2024_p01.html#background",
    "title": "ASM Exam 2024: Problem 1",
    "section": "",
    "text": "According to (Chen et al. 2023), Milk Citrate concentration (mmol/L) is an important biomarker for Negative Energy Balance (NEB). In their paper they found the following numbers\n\nset.seed(2405)\nn_nr_obs &lt;- 20\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\ntbl_cit_desc_stat &lt;- tibble::tibble(Trait = c(\"Citrate1\", \"Citrate2\", \"Citrate3+\"),\n                                    Minimum = c(4.07, 4.05, 3.97), \n                                    Maximum = c(14.14, 14.18, 14.18), \n                                    Mean = c(8.93, 8.93, 9.18), \n                                    SD = c(1.48, 1.63, 1.76))\ntbl_cit_desc_stat\n\n# A tibble: 3 × 5\n  Trait     Minimum Maximum  Mean    SD\n  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Citrate1     4.07    14.1  8.93  1.48\n2 Citrate2     4.05    14.2  8.93  1.63\n3 Citrate3+    3.97    14.2  9.18  1.76\n\n\nBetween DIM 20 and 50, the relationship between Milk Citrate and DIM is nearly linear. This is shown by the following screenshot of Figure 1 in (Chen et al. 2023).\n\n\n\n\n\n\n\n\n\nThis can be modeled by a regression model. Based on the plot and due to the fact that we restrict the DIM range, we have to adapt some of the parameters.\n\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.5"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p01/20240524_asm_exam_2024_p01.html#data-simulation",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p01/20240524_asm_exam_2024_p01.html#data-simulation",
    "title": "ASM Exam 2024: Problem 1",
    "section": "Data Simulation",
    "text": "Data Simulation\nThe DIM values are sampled from a uniform distribution determined by the DIM-range.\n\nvec_dim &lt;- round(runif(n_nr_obs, min = n_dim_start, max = n_dim_end), digits = 0)\nvec_dim &lt;- vec_dim[order(vec_dim)]\nvec_dim\n\n [1] 22 22 22 24 24 24 25 26 27 29 29 30 31 33 35 36 42 44 44 46\n\n\nGenerate the data\n\nvec_cit &lt;- n_reg_intc + n_reg_coef * vec_dim + rnorm(n_nr_obs, mean = 0, sd = n_cit_sd)\nvec_cit_round &lt;- round(vec_cit, digits = 2)\ntbl_cit_dim &lt;- tibble::tibble(Cow = c(1:n_nr_obs),\n                              DIM = vec_dim,\n                              Citrate = vec_cit_round)\ntbl_cit_dim\n\n# A tibble: 20 × 3\n     Cow   DIM Citrate\n   &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;\n 1     1    22    9.1 \n 2     2    22    9.23\n 3     3    22    9.1 \n 4     4    24    8.68\n 5     5    24    9.1 \n 6     6    24    9.14\n 7     7    25    8.69\n 8     8    26    8.85\n 9     9    27    8.93\n10    10    29    8.67\n11    11    29    8.54\n12    12    30    9.34\n13    13    31    8.63\n14    14    33    8.66\n15    15    35    8.78\n16    16    36    8.29\n17    17    42    8.86\n18    18    44    8.34\n19    19    44    8.72\n20    20    46    8.26\n\n\nWrite data to file\n\ns_cit_dim_path &lt;- here::here(\"docs\", \"data\", \"asm_exam_2024_p01.csv\")\n# unlink(s_cit_dim_path)\nif (!file.exists(s_cit_dim_path)){\n  readr::write_delim(tbl_cit_dim, file = s_cit_dim_path, delim = \",\")\n}\n\nPlot\n\nlibrary(ggplot2)\np &lt;-ggplot(data = tbl_cit_dim, aes(x = DIM, y = Citrate)) + \n  geom_point()\np\n\n\n\n\n\n\n\n\nFit regression model\n\nlm_cit_dim &lt;- lm(Citrate ~ DIM, data = tbl_cit_dim)\nsmry_lm_cit_dim &lt;- summary(lm_cit_dim)\nsmry_lm_cit_dim\n\n\nCall:\nlm(formula = Citrate ~ DIM, data = tbl_cit_dim)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.37391 -0.16177 -0.01203  0.14531  0.52570 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  9.566262   0.221608  43.168  &lt; 2e-16 ***\nDIM         -0.025065   0.006988  -3.587  0.00211 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2424 on 18 degrees of freedom\nMultiple R-squared:  0.4168,    Adjusted R-squared:  0.3845 \nF-statistic: 12.87 on 1 and 18 DF,  p-value: 0.002107\n\n\nAdd regression line to plot\n\np &lt;- p + geom_abline(slope = smry_lm_cit_dim$coefficients[\"DIM\", \"Estimate\"],\n                     intercept = smry_lm_cit_dim$coefficients[\"(Intercept)\", \"Estimate\"],\n                     color = \"red\")\np\n\n\n\n\n\n\n\n\nSave plot to file\n\ns_plot_p1_dir &lt;- \"png\"\nif (!dir.exists(s_plot_p1_dir)){\n  dir.create(s_plot_p1_dir)\n}\ns_plot01_pat &lt;- file.path(s_plot_p1_dir, \"asm_exam_2024_p01_plot01.png\")\nif (!file.exists(s_plot01_pat)){\n  ggsave(filename = s_plot01_pat, p)\n}\n\nSecond Plot\n\nvec_rand &lt;- n_cit_min - 0.5 - n_reg_coef * vec_dim + rnorm(n_nr_obs, mean = 0, sd = n_cit_sd)\nvec_rand_round &lt;- round(vec_rand, digits = 2)\ntbl_rand_dim &lt;- tibble::tibble(DIM = vec_dim,\n                      Citrate = vec_rand_round)\n\nlm_rand_dim &lt;- lm(Citrate ~ DIM, data = tbl_rand_dim)\nsmry_lm_rand_dim &lt;- summary(lm_rand_dim)\n\np_rand &lt;- ggplot(data = tbl_rand_dim, aes(x = DIM, y = Citrate)) + \n  geom_point() + \n  geom_abline(slope = smry_lm_rand_dim$coefficients[\"DIM\", \"Estimate\"],\n              intercept = smry_lm_rand_dim$coefficients[\"(Intercept)\", \"Estimate\"],\n              color = \"red\")\np_rand\n\n\n\n\n\n\n\n\nSave plot to file\n\ns_plot02_pat &lt;- file.path(s_plot_p1_dir, \"asm_exam_2024_p01_plot02.png\")\nif (!file.exists(s_plot02_pat)){\n  ggsave(filename = s_plot02_pat, p_rand)\n}"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p04/20240524_asm_exam_2024_p04.html",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p04/20240524_asm_exam_2024_p04.html",
    "title": "ASM Exam 2024: Problem 4",
    "section": "",
    "text": "Use a dataset with citrate and breed alone to be used in Problem 4 dealing with contrasts."
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p04/20240524_asm_exam_2024_p04.html#background",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p04/20240524_asm_exam_2024_p04.html#background",
    "title": "ASM Exam 2024: Problem 4",
    "section": "",
    "text": "Use a dataset with citrate and breed alone to be used in Problem 4 dealing with contrasts."
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p04/20240524_asm_exam_2024_p04.html#data",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p04/20240524_asm_exam_2024_p04.html#data",
    "title": "ASM Exam 2024: Problem 4",
    "section": "Data",
    "text": "Data\nRead data from problem 2\n\ns_cit_dim_br_path &lt;- here::here(\"docs\", \"data\", \"asm_exam_2024_p02.csv\")\ntbl_cit_dim_br &lt;- readr::read_delim(s_cit_dim_br_path, delim = \",\")\n\nRows: 20 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Breed\ndbl (3): Cow, DIM, Citrate\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntbl_cit_dim_br\n\n# A tibble: 20 × 4\n     Cow   DIM Breed Citrate\n   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;\n 1     1    22 BS       8.71\n 2     2    22 HO       9.99\n 3     3    22 BS       8.84\n 4     4    24 BS       8.87\n 5     5    24 BS       9.03\n 6     6    24 BS       8.57\n 7     7    25 BS       9.25\n 8     8    26 HO       9.22\n 9     9    27 HO       9.57\n10    10    29 BS       8.66\n11    11    29 BS       8.8 \n12    12    30 BS       8.8 \n13    13    31 HO       9.67\n14    14    33 HO       9.21\n15    15    35 HO       9.63\n16    16    36 HO       8.83\n17    17    42 HO       8.76\n18    18    44 HO       8.95\n19    19    44 BS       8.67\n20    20    46 BS       8.56\n\n\nRemove DIM and save new data\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ntbl_cit_br &lt;- tbl_cit_dim_br %&gt;%\n  select(-DIM)\n# write data to file\ns_cit_br_path &lt;- here::here(\"docs\", \"data\", \"asm_exam_2024_p04.csv\")\nif (!file.exists(s_cit_br_path)){\n  readr::write_delim(tbl_cit_br, file = s_cit_br_path, delim = \",\")\n}"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html",
    "title": "ASM Exam 2024: Problem 2",
    "section": "",
    "text": "Include breed as additional fixed effects into the dataset. Use parameter from Problem 1 …\n\nset.seed(2405)\nn_nr_obs &lt;- 20\n# dim\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\n# citrate\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.5"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#background",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#background",
    "title": "ASM Exam 2024: Problem 2",
    "section": "",
    "text": "Include breed as additional fixed effects into the dataset. Use parameter from Problem 1 …\n\nset.seed(2405)\nn_nr_obs &lt;- 20\n# dim\nn_dim_start &lt;- 20\nn_dim_end &lt;- 50\n# citrate\nn_cit_max &lt;- 9.2\nn_cit_min &lt;- 8.5\nn_cit_mean &lt;- mean(c(n_cit_max, n_cit_min))\nn_cit_sd &lt;- 0.24\nn_reg_coef &lt;- (n_cit_min - n_cit_max) / (n_dim_end - n_dim_start)\nn_reg_intc &lt;- 9.5"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#data-simulation",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#data-simulation",
    "title": "ASM Exam 2024: Problem 2",
    "section": "Data Simulation",
    "text": "Data Simulation\nThe DIM values are sampled from a uniform distribution determined by the DIM-range.\n\nvec_dim &lt;- round(runif(n_nr_obs, min = n_dim_start, max = n_dim_end), digits = 0)\nvec_dim &lt;- vec_dim[order(vec_dim)]\nvec_dim\n\n [1] 22 22 22 24 24 24 25 26 27 29 29 30 31 33 35 36 42 44 44 46\n\n\nThe vector of breeds is sampled randomly\n\nvec_breed_eff &lt;- c(0, 0.46)\nvec_breed_name &lt;- c(\"BS\", \"HO\")\nvec_breed &lt;- sample(vec_breed_name, n_nr_obs, replace = T)\nvec_breed\n\n [1] \"BS\" \"HO\" \"BS\" \"BS\" \"BS\" \"BS\" \"BS\" \"HO\" \"HO\" \"BS\" \"BS\" \"BS\" \"HO\" \"HO\" \"HO\"\n[16] \"HO\" \"HO\" \"HO\" \"BS\" \"BS\"\n\n\nThe data is generated using breed as factor\n\nvec_breed_fct &lt;- as.factor(vec_breed)\nmat_X_breed &lt;- model.matrix(y ~ breed, data = data.frame(y = rep(1, n_nr_obs), breed = vec_breed_fct))\nattr(mat_X_breed, \"assign\") &lt;- NULL\nattr(mat_X_breed, \"contrasts\") &lt;- NULL\ndimnames(mat_X_breed) &lt;- NULL\nmat_X_breed\n\n      [,1] [,2]\n [1,]    1    0\n [2,]    1    1\n [3,]    1    0\n [4,]    1    0\n [5,]    1    0\n [6,]    1    0\n [7,]    1    0\n [8,]    1    1\n [9,]    1    1\n[10,]    1    0\n[11,]    1    0\n[12,]    1    0\n[13,]    1    1\n[14,]    1    1\n[15,]    1    1\n[16,]    1    1\n[17,]    1    1\n[18,]    1    1\n[19,]    1    0\n[20,]    1    0\n\n\nGenerate the data\n\nvec_cit &lt;- n_reg_intc + n_reg_coef * vec_dim + crossprod(t(mat_X_breed), vec_breed_eff) + rnorm(n_nr_obs, mean = 0, sd = n_cit_sd)\nvec_cit_round &lt;- round(vec_cit, digits = 2)\ntbl_cit_dim_br &lt;- tibble::tibble(Cow = c(1:n_nr_obs),\n                                 DIM = vec_dim,\n                                 Breed = vec_breed,\n                                 Citrate = vec_cit_round[,1])\ntbl_cit_dim_br\n\n# A tibble: 20 × 4\n     Cow   DIM Breed Citrate\n   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;\n 1     1    22 BS       8.71\n 2     2    22 HO       9.99\n 3     3    22 BS       8.84\n 4     4    24 BS       8.87\n 5     5    24 BS       9.03\n 6     6    24 BS       8.57\n 7     7    25 BS       9.25\n 8     8    26 HO       9.22\n 9     9    27 HO       9.57\n10    10    29 BS       8.66\n11    11    29 BS       8.8 \n12    12    30 BS       8.8 \n13    13    31 HO       9.67\n14    14    33 HO       9.21\n15    15    35 HO       9.63\n16    16    36 HO       8.83\n17    17    42 HO       8.76\n18    18    44 HO       8.95\n19    19    44 BS       8.67\n20    20    46 BS       8.56"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#plot",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#plot",
    "title": "ASM Exam 2024: Problem 2",
    "section": "Plot",
    "text": "Plot\n\nlibrary(ggplot2)\np &lt;- ggplot(data = tbl_cit_dim_br, \n            aes(x = DIM, y = Citrate)) + \n  geom_point(aes(color = Breed))\np"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#write-data",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#write-data",
    "title": "ASM Exam 2024: Problem 2",
    "section": "Write Data",
    "text": "Write Data\nThe data is written to a file\n\ns_cit_dim_br_path &lt;- here::here(\"docs\", \"data\", \"asm_exam_2024_p02.csv\")\n# unlink(s_cit_dim_br_path)\nif (!file.exists(s_cit_dim_br_path)){\n  readr::write_delim(tbl_cit_dim_br, file = s_cit_dim_br_path, delim = \",\")\n}"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#group-means",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#group-means",
    "title": "ASM Exam 2024: Problem 2",
    "section": "Group Means",
    "text": "Group Means\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ntbl_cit_dim_br_gr_mean &lt;- tbl_cit_dim_br %&gt;% \n  group_by(Breed) %&gt;%\n  summarise(Cit_Group_Mean = mean(Citrate),\n            DIM_Group_Mean = mean(DIM))\ntbl_cit_dim_br_gr_mean\n\n# A tibble: 2 × 3\n  Breed Cit_Group_Mean DIM_Group_Mean\n  &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;\n1 BS              8.80           29  \n2 HO              9.31           32.9"
  },
  {
    "objectID": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#linear-model",
    "href": "exam/asm_exam_sol/20240524_asm_exam_2024_p02/20240524_asm_exam_2024_p02.html#linear-model",
    "title": "ASM Exam 2024: Problem 2",
    "section": "Linear Model",
    "text": "Linear Model\n\nlm_cit_dim_br &lt;- lm(Citrate ~ DIM + Breed, data = tbl_cit_dim_br)\nsmry_lm_cit_dim_br &lt;- summary(lm_cit_dim_br)\nsmry_lm_cit_dim_br\n\n\nCall:\nlm(formula = Citrate ~ DIM + Breed, data = tbl_cit_dim_br)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.41096 -0.16520 -0.02042  0.18088  0.41835 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  9.481374   0.245866  38.563  &lt; 2e-16 ***\nDIM         -0.023621   0.008004  -2.951 0.008936 ** \nBreedHO      0.609940   0.124814   4.887 0.000139 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2689 on 17 degrees of freedom\nMultiple R-squared:  0.6144,    Adjusted R-squared:  0.569 \nF-statistic: 13.54 on 2 and 17 DF,  p-value: 0.0003038\n\n\nGroup means\n\nsmry_lm_cit_dim_br$coefficients[\"(Intercept)\",\"Estimate\"] + \n  tbl_cit_dim_br_gr_mean$DIM_Group_Mean[tbl_cit_dim_br_gr_mean$Breed == \"BS\"] * \n  smry_lm_cit_dim_br$coefficients[\"DIM\",\"Estimate\"]\n\n[1] 8.796364"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nThe regression model is given as\n\\[y = Xb + e\\]\nwhere vectors\n\n\\(y\\): vector of length \\(n=20\\) with known observations of the response variable\n\\(b\\): vector of length \\(p=2\\) with unknown effects (intercept and slope)\n\\(e\\): vector of length \\(n=20\\) with unknown random residuals\n\nand Matrix \\(X\\) of dimension \\(n\\times p\\) contains a column of all ones and the column with DIM values.\nThe known components are \\(y\\) and \\(X\\) and they can be specified by the information from the dataset\n\\[\ny = \\begin{bmatrix} 9.1 \\\\9.23 \\\\9.1 \\\\8.68 \\\\9.1 \\\\9.14 \\\\8.69 \\\\8.85 \\\\8.93 \\\\8.67 \\\\8.54 \\\\9.34 \\\\8.63 \\\\8.66 \\\\8.78 \\\\8.29 \\\\8.86 \\\\8.34 \\\\8.72 \\\\8.26\\end{bmatrix}\n\\text{, }\nX = \\begin{bmatrix} 1 & 22 \\\\1 & 22 \\\\1 & 22 \\\\1 & 24 \\\\1 & 24 \\\\1 & 24 \\\\1 & 25 \\\\1 & 26 \\\\1 & 27 \\\\1 & 29 \\\\1 & 29 \\\\1 & 30 \\\\1 & 31 \\\\1 & 33 \\\\1 & 35 \\\\1 & 36 \\\\1 & 42 \\\\1 & 44 \\\\1 & 44 \\\\1 & 46\\end{bmatrix}\n\\]"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-1",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-1",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nThe linear regression model fit is given by\n\nlm_cit_dim &lt;- lm(Citrate ~ DIM, data = tbl_p01)\nsmry_lm_cit_dim &lt;- summary(lm_cit_dim)\nsmry_lm_cit_dim\n\n\nCall:\nlm(formula = Citrate ~ DIM, data = tbl_p01)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.37391 -0.16177 -0.01203  0.14531  0.52570 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  9.566262   0.221608  43.168  &lt; 2e-16 ***\nDIM         -0.025065   0.006988  -3.587  0.00211 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2424 on 18 degrees of freedom\nMultiple R-squared:  0.4168,    Adjusted R-squared:  0.3845 \nF-statistic: 12.87 on 1 and 18 DF,  p-value: 0.002107\n\n\nThe estimates for the quantities asked in the problem are listed in the following table\n\n\n\n\n\nQuantity\nEstimate\n\n\n\n\nSlope\n-0.0250654\n\n\nIntercept\n9.5662617\n\n\nVariance of Residuals\n0.0587783"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-2",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-2",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nThe second plot is correct. The following components could be inserted into the plot"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-3",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-3",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nIt is not possible, because DIM between 1 and 10 are outside of the DIM range of the dataset. Figure 1 in (Chen et al. 2023) shows that before DIM 20 the relationship is different from what was modelled in 1b). Hence a prediction of the citrate concentration would be extrapolation which is not allowed here."
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-4",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-4",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nThe fixed linear effects model is fitted as follows\n\nlm_cit_dim_br &lt;- lm(Citrate ~ DIM + Breed, data = tbl_p02)\nsmry_lm_cit_dim_br &lt;- summary(lm_cit_dim_br)\nsmry_lm_cit_dim_br\n\n\nCall:\nlm(formula = Citrate ~ DIM + Breed, data = tbl_p02)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.41096 -0.16520 -0.02042  0.18088  0.41835 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  9.481374   0.245866  38.563  &lt; 2e-16 ***\nDIM         -0.023621   0.008004  -2.951 0.008936 ** \nBreedHO      0.609940   0.124814   4.887 0.000139 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2689 on 17 degrees of freedom\nMultiple R-squared:  0.6144,    Adjusted R-squared:  0.569 \nF-statistic: 13.54 on 2 and 17 DF,  p-value: 0.0003038"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-5",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-5",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nEstimates for the regression slope is: -0.0236211\nGroup means are determined based on the dataset as check\n\nlibrary(dplyr)\ntbl_gr_means_p02 &lt;- tbl_p02 %&gt;%\n  group_by(Breed) %&gt;%\n  summarise(GrM_Cit = mean(Citrate),\n            GrM_DIM = mean(DIM))\ntbl_gr_means_p02\n\n# A tibble: 2 × 3\n  Breed GrM_Cit GrM_DIM\n  &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 BS       8.80    29  \n2 HO       9.31    32.9\n\n\nGroup means based on modelling results for breed BS\n\nsmry_lm_cit_dim_br$coefficients[\"(Intercept)\", \"Estimate\"] + \n  tbl_gr_means_p02$GrM_DIM[tbl_gr_means_p02$Breed == cur_breed] * \n  smry_lm_cit_dim_br$coefficients[\"DIM\", \"Estimate\"]\n\n[1] 8.796364\n\n\nGroup means based on modelling results for breed HO\n\nsmry_lm_cit_dim_br$coefficients[\"(Intercept)\", \"Estimate\"] + \n  tbl_gr_means_p02$GrM_DIM[tbl_gr_means_p02$Breed == cur_breed] * \n  smry_lm_cit_dim_br$coefficients[\"DIM\", \"Estimate\"] + \n  smry_lm_cit_dim_br$coefficients[\"BreedHO\", \"Estimate\"] \n\n[1] 9.314444"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-6",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-6",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nExpected value of citrate concentration for animals of breed BS\n\nsmry_lm_cit_dim_br$coefficients[\"(Intercept)\", \"Estimate\"] + \n  n_dim_pred * smry_lm_cit_dim_br$coefficients[\"DIM\", \"Estimate\"]\n\n[1] 8.772743\n\n\nExpected value of citrate concentration for animals of breed HO\n\nsmry_lm_cit_dim_br$coefficients[\"(Intercept)\", \"Estimate\"] + \n  n_dim_pred * smry_lm_cit_dim_br$coefficients[\"DIM\", \"Estimate\"] + \n  smry_lm_cit_dim_br$coefficients[\"BreedHO\", \"Estimate\"] \n\n[1] 9.382683"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-7",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-7",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nThe fixed linear effects model including an interaction term between DIM and Breed is fitted to the data by\n\nlm_cit_dim_br_inta &lt;- lm(Citrate ~ DIM * Breed, data = tbl_p03)\nsmry_lm_cit_dim_br_inta &lt;- summary(lm_cit_dim_br_inta)\nsmry_lm_cit_dim_br_inta\n\n\nCall:\nlm(formula = Citrate ~ DIM * Breed, data = tbl_p03)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.40476 -0.13973  0.00115  0.13979  0.40915 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  8.618906   0.274677  31.378 8.45e-16 ***\nDIM         -0.011122   0.009131  -1.218  0.24084    \nBreedHO      1.655131   0.481022   3.441  0.00336 ** \nDIM:BreedHO -0.032311   0.014883  -2.171  0.04531 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2423 on 16 degrees of freedom\nMultiple R-squared:  0.7172,    Adjusted R-squared:  0.6642 \nF-statistic: 13.53 on 3 and 16 DF,  p-value: 0.0001181"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-8",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-8",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nThe expected difference in citrate concentration in the milk for animals of breed\n\nBS corresponds to the regression coefficient times the difference in DIM\n\n\nn_delta_dim &lt;- n_dim_end_intac - n_dim_start_intac\nn_delta_citr_bs &lt;- smry_lm_cit_dim_br_inta$coefficients[\"DIM\", \"Estimate\"] * n_delta_dim\nn_delta_citr_bs\n\n[1] -0.1112216\n\n\n\nHO corresponds to the regression coefficient plus the interaction term times the difference in DIM\n\n\nn_delta_dim &lt;- n_dim_end_intac - n_dim_start_intac\nn_delta_citr_ho &lt;- (smry_lm_cit_dim_br_inta$coefficients[\"DIM\", \"Estimate\"] +\n                      smry_lm_cit_dim_br_inta$coefficients[\"DIM:BreedHO\", \"Estimate\"]) * n_delta_dim\nn_delta_citr_ho\n\n[1] -0.4343358"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-9",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-9",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nTreatment contrasts are used by default by lm() when fitting a FLEM. Hence the fit is obtained by\n\nlm_cit_br &lt;- lm(Citrate ~ Breed, data = tbl_p04)\nsmry_lm_cit_br &lt;- summary(lm_cit_br)\nsmry_lm_cit_br\n\n\nCall:\nlm(formula = Citrate ~ Breed, data = tbl_p04)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.55444 -0.15886 -0.04136  0.23912  0.67556 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   8.7964     0.0969  90.774  &lt; 2e-16 ***\nBreedHO       0.5181     0.1445   3.586  0.00211 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3214 on 18 degrees of freedom\nMultiple R-squared:  0.4168,    Adjusted R-squared:  0.3844 \nF-statistic: 12.86 on 1 and 18 DF,  p-value: 0.00211\n\n\nAssuming treatment contrasts, verification via group means is done as follows\n\nIntercept estimate corresponds to the mean of all BS animals\n\n\nmean(tbl_p04$Citrate[tbl_p04$Breed == \"BS\"])\n\n[1] 8.796364\n\n\nThis is expected to be the same as\n\nsmry_lm_cit_br$coefficients[\"(Intercept)\", \"Estimate\"]\n\n[1] 8.796364\n\n\n\nThe difference between the group means of HO animals minus the group mean of the BS animals corresponds to the reported breed effect, hence\n\n\nmean(tbl_p04$Citrate[tbl_p04$Breed == \"HO\"]) - mean(tbl_p04$Citrate[tbl_p04$Breed == \"BS\"])\n\n[1] 0.5180808\n\n\nis expected to be the same as\n\nsmry_lm_cit_br$coefficients[\"BreedHO\", \"Estimate\"]\n\n[1] 0.5180808\n\n\n\nThe breed effect estimated can also be verified via solutions of the least squares normal equations\n\n\nmat_X &lt;- model.matrix(Citrate ~ 0 + Breed, tbl_p04)\nattr(mat_X, \"assign\") &lt;- NULL\nattr(mat_X, \"contrasts\") &lt;- NULL\ncolnames(mat_X) &lt;- NULL\nmat_X &lt;- cbind(matrix(rep(1,nrow(mat_X)), ncol = 1), mat_X)\nmat_xtx &lt;- crossprod(mat_X)\nmat_xtx_ginv &lt;- MASS::ginv(mat_xtx)\nmat_xty &lt;- crossprod(mat_X, tbl_p04$Citrate)\nmat_b_sol &lt;- crossprod(mat_xtx_ginv, mat_xty)\nmat_b_sol\n\n         [,1]\n[1,] 6.036936\n[2,] 2.759428\n[3,] 3.277508\n\n\nContrasts matrix for treatment contrasts\n\nfac_breed &lt;- as.factor(tbl_p04$Breed)\ncontr_mat_breed_treat &lt;- contrasts(fac_breed)\ncontr_mat_breed_treat &lt;- cbind(matrix(rep(1,nrow(contr_mat_breed_treat)), ncol = 1), \n                               contr_mat_breed_treat)\nest_mat_breed_treat &lt;- solve(contr_mat_breed_treat)\nest_mat_breed_treat\n\n   BS HO\n    1  0\nHO -1  1\n\n\nFor the effects estimates, we are looking at the second and the third row of the matrix est_mat_breed_treat. We are prepending a column of zeroes to the second and the third row of est_mat_breed_treat.\n\nn_nrow_est_mat &lt;- nrow(est_mat_breed_treat)\nmat_q_efun &lt;- cbind(matrix(0, nrow = (nrow(est_mat_breed_treat)-1), ncol = 1),\n                    matrix(est_mat_breed_treat[2:n_nrow_est_mat,], \n                           nrow = (nrow(est_mat_breed_treat)-1)))\ncrossprod(t(mat_q_efun), mat_b_sol) \n\n          [,1]\n[1,] 0.5180808"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-10",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-10",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\nThe fixed linear effects model using sum contrasts is fitted as shown below\n\nlm_cit_br_csum &lt;- lm(Citrate ~ Breed, data = tbl_p04, contrasts = list(Breed = \"contr.sum\"))\nsmry_lm_cit_br_csum &lt;- summary(lm_cit_br_csum)\nsmry_lm_cit_br_csum\n\n\nCall:\nlm(formula = Citrate ~ Breed, data = tbl_p04, contrasts = list(Breed = \"contr.sum\"))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.55444 -0.15886 -0.04136  0.23912  0.67556 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  9.05540    0.07223 125.373  &lt; 2e-16 ***\nBreed1      -0.25904    0.07223  -3.586  0.00211 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3214 on 18 degrees of freedom\nMultiple R-squared:  0.4168,    Adjusted R-squared:  0.3844 \nF-statistic: 12.86 on 1 and 18 DF,  p-value: 0.00211\n\n\n\nContrasts Matrix for Sum Contrasts From the contrasts matrix, we get the matrix of estimable functions.\n\n\nfac_breed &lt;- as.factor(tbl_p04$Breed)\ncontr_mat_breed_sum &lt;- contrasts(C(fac_breed, sum))\ncontr_mat_breed_sum &lt;- cbind(matrix(rep(1,nrow(contr_mat_breed_sum)), ncol = 1), contr_mat_breed_sum)\nest_mat_breed_sum &lt;- solve(contr_mat_breed_sum)\nest_mat_breed_sum\n\n      BS   HO\n[1,] 0.5  0.5\n[2,] 0.5 -0.5\n\n\nThe matrix est_mat_breed_sum tells us that the estimate for the intercept (first row) is computed as the mean of the group means for the two breeds and the estimate for the breed effect (second row) is computed as half of the difference between group means for the first breed minus the group mean of the second breed.\nHence the estimate of the intercept is\n\nmean(c(mean(tbl_p04$Citrate[tbl_p04$Breed == \"BS\"]),\n       mean(tbl_p04$Citrate[tbl_p04$Breed == \"HO\"])))\n\n[1] 9.055404\n\n\nand has to be equal to\n\nsmry_lm_cit_br_csum$coefficients[\"(Intercept)\", \"Estimate\"]\n\n[1] 9.055404\n\n\nThe estimate for the breed-effect is obtained by\n\n0.5 * (mean(tbl_p04$Citrate[tbl_p04$Breed == \"BS\"]) - mean(tbl_p04$Citrate[tbl_p04$Breed == \"HO\"]))\n\n[1] -0.2590404\n\n\nwhich is the same as\n\nsmry_lm_cit_br_csum$coefficients[\"Breed1\", \"Estimate\"]\n\n[1] -0.2590404\n\n\nThe verification with the solution of the least squares normal equation is done with\n\nn_nrow_est_mat &lt;- nrow(est_mat_breed_sum)\nmat_q_efun &lt;- cbind(matrix(0, nrow = (nrow(est_mat_breed_sum)-1), ncol = 1),\n                    matrix(est_mat_breed_sum[2:n_nrow_est_mat,], \n                           nrow = (nrow(est_mat_breed_sum)-1)))\ncrossprod(t(mat_q_efun), mat_b_sol) \n\n           [,1]\n[1,] -0.2590404"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-11",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-11",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\n\nModel as equation:\n\n\\[y = Xb + Zs + e\\] where\n\n\n\n\n\n\\(y\\)\nvector of observations\n\n\n\\(b\\)\nvector of intercept, regression coefficient and fixed effects\n\n\n\\(s\\)\nvector of random sire breeding values\n\n\n\\(e\\)\nvector of random residuals\n\n\n\\(X\\)\ndesign matrix linking observations to fixed effects\n\n\n\\(Z\\)\ndesign matrix linking observations to sire breeding values\n\n\n\n\n\n\nExpected values and the variance-covariance matrices:\n\nRandom effects are \\(y\\), \\(s\\) and \\(e\\). Their expected values correspond to\n\\[E\\left[\\begin{array}{c}y \\\\ s \\\\ e \\end{array}\\right]\n= \\left[\\begin{array}{c}Xb \\\\ 0 \\\\ 0 \\end{array}\\right]\n\\]\nThe variance-covariance matrices\n\\[\nvar\\left[\\begin{array}{c}y \\\\ s \\\\ e \\end{array}\\right]\n= \\left[\\begin{array}{ccc} V & ZS & R \\\\ SZ^T & S & 0 \\\\ R & 0 & R \\end{array}\\right]\n\\]\nwhere \\(var(s) = S = I * \\sigma_s^2\\), \\(var(e) = R = I * \\sigma_e^2\\) and \\(var(y) = V = ZSZ^T + R = ZZ^T\\sigma_s^2 + R\\) with given sire-variance component \\(\\sigma_s^2\\) and given residual variance component \\(\\sigma_e^2\\).\n\nInformation from data to model components\n\n\\[\ny = \\begin{bmatrix} 9.3 \\\\9.26 \\\\8.92 \\\\9.3 \\\\9.03 \\\\8.82 \\\\9.09 \\\\9.04 \\\\9.71 \\\\8.52 \\\\9.18 \\\\8.85 \\\\9.04 \\\\9.04 \\\\9.44 \\\\9.18 \\\\8.88 \\\\8.96 \\\\8.74 \\\\8.52\\end{bmatrix}\\text{, }b = \\begin{bmatrix} b_0 \\\\b_{DIM} \\\\b_{BreedHO}\\end{bmatrix}\\text{, }s = \\begin{bmatrix} s_{1} \\\\s_{2} \\\\s_{3} \\\\s_{4}\\end{bmatrix}\\text{, }e = \\begin{bmatrix} e_{5} \\\\e_{6} \\\\e_{7} \\\\e_{8} \\\\e_{9} \\\\e_{10} \\\\e_{11} \\\\e_{12} \\\\e_{13} \\\\e_{14} \\\\e_{15} \\\\e_{16} \\\\e_{17} \\\\e_{18} \\\\e_{19} \\\\e_{20} \\\\e_{21} \\\\e_{22} \\\\e_{23} \\\\e_{24}\\end{bmatrix}\\]\n\\[\nX = \\begin{bmatrix} 1 & 22 & 0 \\\\1 & 22 & 1 \\\\1 & 22 & 0 \\\\1 & 24 & 0 \\\\1 & 24 & 0 \\\\1 & 24 & 0 \\\\1 & 25 & 0 \\\\1 & 26 & 1 \\\\1 & 27 & 1 \\\\1 & 29 & 0 \\\\1 & 29 & 0 \\\\1 & 30 & 0 \\\\1 & 31 & 1 \\\\1 & 33 & 1 \\\\1 & 35 & 1 \\\\1 & 36 & 1 \\\\1 & 42 & 1 \\\\1 & 44 & 1 \\\\1 & 44 & 0 \\\\1 & 46 & 0\\end{bmatrix}\\text{, }Z = \\begin{bmatrix} 1 & 0 & 0 & 0 \\\\1 & 0 & 0 & 0 \\\\1 & 0 & 0 & 0 \\\\1 & 0 & 0 & 0 \\\\1 & 0 & 0 & 0 \\\\1 & 0 & 0 & 0 \\\\0 & 1 & 0 & 0 \\\\0 & 1 & 0 & 0 \\\\0 & 1 & 0 & 0 \\\\0 & 1 & 0 & 0 \\\\0 & 1 & 0 & 0 \\\\0 & 0 & 1 & 0 \\\\0 & 0 & 1 & 0 \\\\0 & 0 & 1 & 0 \\\\0 & 0 & 1 & 0 \\\\0 & 0 & 1 & 0 \\\\0 & 0 & 1 & 0 \\\\0 & 0 & 0 & 1 \\\\0 & 0 & 0 & 1 \\\\0 & 0 & 0 & 1\\end{bmatrix}\\]\n\nMixed model equations:\n\n\\[\n\\left[\n\\begin{array}{cc}\nX^TX  &  X^TZ \\\\\nZ^TX  &  Z^TZ + \\lambda_s * I\n\\end{array}\n\\right]\n\\left[\n\\begin{array}{c}\n\\hat{b} \\\\\n\\hat{s}\n\\end{array}\n\\right]\n=\n\\left[\n\\begin{array}{c}\nX^Ty \\\\\nZ^Ty\n\\end{array}\n\\right]\n\\]\n\nSolutions of MME\n\n\nmat_xtx &lt;- crossprod(mat_X_p05)\nmat_xtz &lt;- crossprod(mat_X_p05, mat_Z_sire)\nmat_ztx &lt;- t(mat_xtz)\nmat_ztz_lAsinv &lt;- crossprod(mat_Z_sire) + n_lambda_s * diag(1, nrow = n_nr_sire)\nmat_coef_sire &lt;- rbind(cbind(mat_xtx, mat_xtz), cbind(mat_ztx, mat_ztz_lAsinv))\nmat_rhs_sire &lt;- rbind(crossprod(mat_X_p05, vec_y), crossprod(mat_Z_sire, vec_y))\nmat_sol_sire &lt;- solve(mat_coef_sire, mat_rhs_sire)\nmat_sol_sire\n\n              [,1]\n[1,]  9.5007575600\n[2,] -0.0196080127\n[3,]  0.3196246901\n[4,]  0.0008951716\n[5,]  0.0052561969\n[6,] -0.0086811736\n[7,]  0.0025298051\n\n\n\nEstimates of intercept, regression coefficient and fixed effect for BreedHO are given by\n\n\ntbl_sire_result &lt;- tibble::tibble(Effect = c(\"Intercept\", \n                                             \"Regression Coefficient\", \n                                             \"BreedHO Effect\"),\n                                  Estimate = mat_sol_sire[1:3,])\nknitr::kable(tbl_sire_result)\n\n\n\n\nEffect\nEstimate\n\n\n\n\nIntercept\n9.5007576\n\n\nRegression Coefficient\n-0.0196080\n\n\nBreedHO Effect\n0.3196247\n\n\n\n\n\n\nPredicted breeding values for the sires are\n\n\nvec_sire_pbv &lt;- mat_sol_sire[(nrow(mat_sol_sire)-n_nr_sire+1):nrow(mat_sol_sire),]\nvec_sire_pbv\n\n[1]  0.0008951716  0.0052561969 -0.0086811736  0.0025298051\n\n\nThe order of the sires according to the predicted breeding values is given by\n\nvec_sire_pbv[order(vec_sire_pbv, decreasing = T)]\n\n[1]  0.0052561969  0.0025298051  0.0008951716 -0.0086811736"
  },
  {
    "objectID": "exam/asm_exam_sol/asm_exam_sol.html#solution-12",
    "href": "exam/asm_exam_sol/asm_exam_sol.html#solution-12",
    "title": "Problem 1: Linear Regression",
    "section": "Solution",
    "text": "Solution\n\nModel as equation:\n\n\\[y = Xb + Zu + e\\] where\n\n\n\n\n\n\\(y\\)\nvector of observations\n\n\n\\(b\\)\nvector of intercept, regression coefficient and fixed effects\n\n\n\\(u\\)\nvector of random breeding values\n\n\n\\(e\\)\nvector of random residuals\n\n\n\\(X\\)\ndesign matrix linking observations to fixed effects\n\n\n\\(Z\\)\ndesign matrix linking observations to sire breeding values\n\n\n\n\n\n\nExpected values and the variance-covariance matrices:\n\nRandom effects are \\(y\\), \\(u\\) and \\(e\\). Their expected values correspond to\n\\[E\\left[\\begin{array}{c}y \\\\ u \\\\ e \\end{array}\\right]\n= \\left[\\begin{array}{c}Xb \\\\ 0 \\\\ 0 \\end{array}\\right]\n\\]\nThe variance-covariance matrices\n\\[\nvar\\left[\\begin{array}{c}y \\\\ u \\\\ e \\end{array}\\right]\n= \\left[\\begin{array}{ccc} V & ZU & R \\\\ UZ^T & U & 0 \\\\ R & 0 & R \\end{array}\\right]\n\\]\nwhere \\(var(u) = U = A * \\sigma_u^2\\), \\(var(e) = R = I * \\sigma_e^2\\) and \\(var(y) = V = ZUZ^T + R\\) with given additive genetic variance component \\(\\sigma_u^2\\) and given residual variance component \\(\\sigma_e^2\\).\n\nInformation from data to model components\n\n\\[\ny = \\begin{bmatrix} 9.3 \\\\9.26 \\\\8.92 \\\\9.3 \\\\9.03 \\\\8.82 \\\\9.09 \\\\9.04 \\\\9.71 \\\\8.52 \\\\9.18 \\\\8.85 \\\\9.04 \\\\9.04 \\\\9.44 \\\\9.18 \\\\8.88 \\\\8.96 \\\\8.74 \\\\8.52\\end{bmatrix}\\text{, }b = \\begin{bmatrix} b_0 \\\\b_{DIM} \\\\b_{BreedHO}\\end{bmatrix}\\text{, }u = \\begin{bmatrix} u_{1} \\\\u_{2} \\\\u_{3} \\\\u_{4} \\\\u_{5} \\\\u_{6} \\\\u_{7} \\\\u_{8} \\\\u_{9} \\\\u_{10} \\\\u_{11} \\\\u_{12} \\\\u_{13} \\\\u_{14} \\\\u_{15} \\\\u_{16} \\\\u_{17} \\\\u_{18} \\\\u_{19} \\\\u_{20} \\\\u_{21} \\\\u_{22} \\\\u_{23} \\\\u_{24}\\end{bmatrix}\\text{, }e = \\begin{bmatrix} e_{5} \\\\e_{6} \\\\e_{7} \\\\e_{8} \\\\e_{9} \\\\e_{10} \\\\e_{11} \\\\e_{12} \\\\e_{13} \\\\e_{14} \\\\e_{15} \\\\e_{16} \\\\e_{17} \\\\e_{18} \\\\e_{19} \\\\e_{20} \\\\e_{21} \\\\e_{22} \\\\e_{23} \\\\e_{24}\\end{bmatrix}\\]\n\\[\nX = \\begin{bmatrix} 1 & 22 & 0 \\\\1 & 22 & 1 \\\\1 & 22 & 0 \\\\1 & 24 & 0 \\\\1 & 24 & 0 \\\\1 & 24 & 0 \\\\1 & 25 & 0 \\\\1 & 26 & 1 \\\\1 & 27 & 1 \\\\1 & 29 & 0 \\\\1 & 29 & 0 \\\\1 & 30 & 0 \\\\1 & 31 & 1 \\\\1 & 33 & 1 \\\\1 & 35 & 1 \\\\1 & 36 & 1 \\\\1 & 42 & 1 \\\\1 & 44 & 1 \\\\1 & 44 & 0 \\\\1 & 46 & 0\\end{bmatrix}\\]\n\\[\nZ = \\]\n\nMixed model equations:\n\n\\[\n\\left[\n\\begin{array}{cc}\nX^TX  &  X^TZ \\\\\nZ^TX  &  Z^TZ + \\lambda_u * A^{-1}\n\\end{array}\n\\right]\n\\left[\n\\begin{array}{c}\n\\hat{b} \\\\\n\\hat{u}\n\\end{array}\n\\right]\n=\n\\left[\n\\begin{array}{c}\nX^Ty \\\\\nZ^Ty\n\\end{array}\n\\right]\n\\]\n\n\nLoading required package: lme4\n\n\nLoading required package: Matrix\n\n\n'as(&lt;dtTMatrix&gt;, \"dtCMatrix\")' is deprecated.\nUse 'as(., \"CsparseMatrix\")' instead.\nSee help(\"Deprecated\") and help(\"Matrix-deprecated\").\n\n\nwhere \\(\\lambda_u = \\frac{\\sigma_e^2}{\\sigma_u^2} = 1.78\\) and \\(A\\) corresponds to the numerator relationship matrix given by\n\\[A =  \\]\nThe inverse \\(A_s^{-1}\\) is\n\\[A^{-1} = \\]\n\nSolutions of MME\n\n\nmat_xtx &lt;- crossprod(mat_X_p05)\nmat_xtz &lt;- crossprod(mat_X_p05, mat_Z_ani)\nmat_ztx &lt;- t(mat_xtz)\nmat_ztz_lAinv &lt;- crossprod(mat_Z_ani) + n_lambda_u * mat_A_inv\nmat_coef_ani &lt;- rbind(cbind(mat_xtx, mat_xtz), cbind(mat_ztx, mat_ztz_lAinv))\nmat_rhs_ani &lt;- rbind(crossprod(mat_X_p05, vec_y), crossprod(mat_Z_ani, vec_y))\nmat_sol_ani &lt;- solve(mat_coef_ani, mat_rhs_ani)\nmat_sol_ani\n\n           [,1]\n    9.539690005\n   -0.021267432\n    0.349117898\n1  -0.019522398\n2   0.015023764\n3  -0.007240318\n4   0.004130529\n5   0.060900627\n6  -0.069010391\n7  -0.025382473\n8   0.066991716\n9  -0.015315320\n10 -0.100579302\n11  0.036875067\n12 -0.065712408\n13  0.109473105\n14 -0.046579510\n15  0.050600530\n16 -0.019246384\n17 -0.080664433\n18 -0.072272549\n19  0.076382029\n20  0.024028396\n21 -0.053822726\n22 -0.022512425\n23  0.074186722\n24  0.035268929\n\n\n\nEstimates of intercept, regression coefficient and fixed effect for BreedHO are given by\n\n\ntbl_ani_result &lt;- tibble::tibble(Effect = c(\"Intercept\", \n                                             \"Regression Coefficient\", \n                                             \"BreedHO Effect\"),\n                                  Estimate = mat_sol_ani[1:3,])\nknitr::kable(tbl_ani_result)\n\n\n\n\nEffect\nEstimate\n\n\n\n\nIntercept\n9.5396900\n\n\nRegression Coefficient\n-0.0212674\n\n\nBreedHO Effect\n0.3491179\n\n\n\n\n\n\nPredicted breeding values for all animals: The first two elements are solutions of fixed effects, the remaining elements are predicted breeding values\n\n\n\n\n\n\nAnimals\nPredicted Breeding Values\n\n\n\n\n1\n-0.0195224\n\n\n2\n0.0150238\n\n\n3\n-0.0072403\n\n\n4\n0.0041305\n\n\n5\n0.0609006\n\n\n6\n-0.0690104\n\n\n7\n-0.0253825\n\n\n8\n0.0669917\n\n\n9\n-0.0153153\n\n\n10\n-0.1005793\n\n\n11\n0.0368751\n\n\n12\n-0.0657124\n\n\n13\n0.1094731\n\n\n14\n-0.0465795\n\n\n15\n0.0506005\n\n\n16\n-0.0192464\n\n\n17\n-0.0806644\n\n\n18\n-0.0722725\n\n\n19\n0.0763820\n\n\n20\n0.0240284\n\n\n21\n-0.0538227\n\n\n22\n-0.0225124\n\n\n23\n0.0741867\n\n\n24\n0.0352689"
  },
  {
    "objectID": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-2-fixed-linear-effects-model",
    "href": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-2-fixed-linear-effects-model",
    "title": "Exam in Applied Statistical Methods",
    "section": "Problem 2: Fixed Linear Effects Model",
    "text": "Problem 2: Fixed Linear Effects Model\n\nDataframe\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p2 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p02.csv\")\ndf_p2 &lt;- read.table(s_data_url_p2, header = T, sep = \",\")\ndim(df_p2)\n\n[1] 20  4\n\n\n\n\nTibble\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p2 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p02.csv\")\ntbl_p2 &lt;- readr::read_delim(file = s_data_url_p2, delim = \",\")\ndim(tbl_p2)\n\n[1] 20  4"
  },
  {
    "objectID": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-3-interactions",
    "href": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-3-interactions",
    "title": "Exam in Applied Statistical Methods",
    "section": "Problem 3: Interactions",
    "text": "Problem 3: Interactions\n\nDataframe\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p3 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p03.csv\")\ndf_p3 &lt;- read.table(s_data_url_p3, header = T, sep = \",\")\ndim(df_p3)\n\n[1] 20  4\n\n\n\n\nTibble\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p3 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p03.csv\")\ntbl_p3 &lt;- readr::read_delim(file = s_data_url_p3, delim = \",\")\ndim(tbl_p3)\n\n[1] 20  4"
  },
  {
    "objectID": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-4-contrasts",
    "href": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-4-contrasts",
    "title": "Exam in Applied Statistical Methods",
    "section": "Problem 4: Contrasts",
    "text": "Problem 4: Contrasts\n\nDataframe\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p4 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p04.csv\")\ndf_p4 &lt;- read.table(s_data_url_p4, header = T, sep = \",\")\ndim(df_p4)\n\n[1] 20  3\n\n\n\n\nTibble\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p4 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p04.csv\")\ntbl_p4 &lt;- readr::read_delim(file = s_data_url_p4, delim = \",\")\ndim(tbl_p4)\n\n[1] 20  3"
  },
  {
    "objectID": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-5-linear-mixed-effects-models",
    "href": "exam/asm_exam_read_data/asm_exam_read_data.html#problem-5-linear-mixed-effects-models",
    "title": "Exam in Applied Statistical Methods",
    "section": "Problem 5: Linear Mixed Effects Models",
    "text": "Problem 5: Linear Mixed Effects Models\n\nDataframe\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p5 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p05.csv\")\ndf_p5 &lt;- read.table(s_data_url_p5, header = T, sep = \",\")\ndim(df_p5)\n\n[1] 20  6\n\n\n\n\nTibble\n\ns_data_url_root &lt;- \"https://charlotte-ngs.github.io/asmasss2024/data\"\ns_data_url_p5 &lt;- file.path(s_data_url_root, \"asm_exam_2024_p05.csv\")\ntbl_p5 &lt;- readr::read_delim(file = s_data_url_p5, delim = \",\")\ndim(tbl_p5)\n\n[1] 20  6\n\n\n\nLatest Changes: 2024-05-27 05:28:37 CEST (pvr)"
  },
  {
    "objectID": "about.html#asmasss2024-0.13.0",
    "href": "about.html#asmasss2024-0.13.0",
    "title": "About",
    "section": "",
    "text": "Exam Data asm_exam_read_data"
  }
]