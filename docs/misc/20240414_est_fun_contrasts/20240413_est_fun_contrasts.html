<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ASMAS-SS2024 | 0.8.1 - Estimable Functions and Contrasts in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ASMAS-SS2024 | 0.8.1</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../course_notes.html"> 
<span class="menu-text">Course Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../exercises.html"> 
<span class="menu-text">Exercises</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../solutions.html"> 
<span class="menu-text">Solutions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../add_info.html"> 
<span class="menu-text">Additional Information</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#disclaimer" id="toc-disclaimer" class="nav-link active" data-scroll-target="#disclaimer">Disclaimer</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#regression-on-dummy-variables" id="toc-regression-on-dummy-variables" class="nav-link" data-scroll-target="#regression-on-dummy-variables">Regression on Dummy Variables</a></li>
  <li><a href="#old-stuff-below-here" id="toc-old-stuff-below-here" class="nav-link" data-scroll-target="#old-stuff-below-here">Old Stuff Below Here</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#data-1" id="toc-data-1" class="nav-link" data-scroll-target="#data-1">Data</a></li>
  <li><a href="#use-regression-to-describe-group-means" id="toc-use-regression-to-describe-group-means" class="nav-link" data-scroll-target="#use-regression-to-describe-group-means">Use Regression To Describe Group Means</a></li>
  <li><a href="#idea-of-contrasts" id="toc-idea-of-contrasts" class="nav-link" data-scroll-target="#idea-of-contrasts">Idea of Contrasts</a></li>
  <li><a href="#contrasts-in-r" id="toc-contrasts-in-r" class="nav-link" data-scroll-target="#contrasts-in-r">Contrasts in R</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation">Validation</a></li>
  <li><a href="#vector-of-group-means" id="toc-vector-of-group-means" class="nav-link" data-scroll-target="#vector-of-group-means">Vector of Group Means</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Estimable Functions and Contrasts in R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="disclaimer" class="level2">
<h2 class="anchored" data-anchor-id="disclaimer">Disclaimer</h2>
<p>This is an update on the synthesis and derivation notebook of the two previous years. After the lecture, we start with the development of new material. The new material is only based on group means and contrasts of group means.</p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>We are using the dataset on body weight and breed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>s_bw_breed_path <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"docs"</span>, <span class="st">"data"</span>, <span class="st">"asm_bw_breed.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_delim</span>(s_bw_breed_path, <span class="at">delim =</span> <span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 10 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Breed
dbl (2): Animal, Body Weight

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   Animal `Body Weight` Breed    
    &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    
 1      1           471 Angus    
 2      2           463 Angus    
 3      4           470 Angus    
 4      7           518 Limousin 
 5      8           511 Limousin 
 6      9           510 Limousin 
 7     10           541 Limousin 
 8      3           481 Simmental
 9      5           496 Simmental
10      6           491 Simmental</code></pre>
</div>
</div>
</section>
<section id="regression-on-dummy-variables" class="level2">
<h2 class="anchored" data-anchor-id="regression-on-dummy-variables">Regression on Dummy Variables</h2>
<p>Let us assume that we are interested in the difference between body weights of animals of the breed <code>Limousin</code> compared to the body weight of animals of breed <code>Angus</code>. This difference can be visualized by the following plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tbl_bw_an_li <span class="ot">&lt;-</span> tbl_bw_breed <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Breed <span class="sc">!=</span> <span class="st">"Simmental"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>tbl_bw_an_li</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  Animal `Body Weight` Breed   
   &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;   
1      1           471 Angus   
2      2           463 Angus   
3      4           470 Angus   
4      7           518 Limousin
5      8           511 Limousin
6      9           510 Limousin
7     10           541 Limousin</code></pre>
</div>
</div>
<p>Show the plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plot_bw_diff_li_an <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tbl_bw_an_li, <span class="fu">aes</span>(<span class="at">x =</span> Breed, <span class="at">y =</span> <span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plot_bw_diff_li_an</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="20240413_est_fun_contrasts_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The difference of mean body weight between animals of the two breeds can be shown by fitting a regression of body weight on a breed code where Angus animals are assigned the code <span class="math inline">\(0\)</span> and animals of breed Limousin are assigned the code <span class="math inline">\(1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tbl_bw_an_li<span class="sc">$</span>BreedCodeLi <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(tbl_bw_an_li<span class="sc">$</span>Breed)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tbl_bw_an_li</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  Animal `Body Weight` Breed    BreedCodeLi
   &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
1      1           471 Angus              0
2      2           463 Angus              0
3      4           470 Angus              0
4      7           518 Limousin           1
5      8           511 Limousin           1
6      9           510 Limousin           1
7     10           541 Limousin           1</code></pre>
</div>
</div>
<p>The regression of <code>Body Weight</code> on <code>BreedCode</code> is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lm_bw_brc_li <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span> <span class="sc">~</span> BreedCodeLi, <span class="at">data =</span> tbl_bw_an_li)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>(smry_bw_brc_li <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_bw_brc_li))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = `Body Weight` ~ BreedCodeLi, data = tbl_bw_an_li)

Residuals:
  1   2   3   4   5   6   7 
  3  -5   2  -2  -9 -10  21 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  468.000      6.653  70.341  1.1e-08 ***
BreedCodeLi   52.000      8.802   5.908  0.00198 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.52 on 5 degrees of freedom
Multiple R-squared:  0.8747,    Adjusted R-squared:  0.8496 
F-statistic: 34.91 on 1 and 5 DF,  p-value: 0.001978</code></pre>
</div>
</div>
<p>Adding the resuting regression line to the above plot leads to</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plot_bw_brc_li_an <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tbl_bw_an_li, <span class="fu">aes</span>(<span class="at">x =</span> BreedCodeLi, <span class="at">y =</span> <span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> smry_bw_brc_li<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> smry_bw_brc_li<span class="sc">$</span>coefficients[<span class="st">"BreedCodeLi"</span>, <span class="st">"Estimate"</span>],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plot_bw_brc_li_an</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="20240413_est_fun_contrasts_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The intersection of the red regression line with <span class="math inline">\(x=0\)</span> on the one hand shows the intercept of the regression line and on the other hand corresponds to the mean Angus body weight</p>
</section>
<section id="old-stuff-below-here" class="level2">
<h2 class="anchored" data-anchor-id="old-stuff-below-here">Old Stuff Below Here</h2>
<p>The material from 2024 and before was mostly based on explaining parameter estimates via estimable functions of solutions of least squares normal equations. While this is possible and can work, it adds un-necessary complexity. For documentation, the previously used material is left in here.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>[1] Notebooks on contrasts from previous years [2] Material from https://bookdown.org/pingapang9/linear_models_bookdown/chap-contrasts.html</p>
</section>
<section id="data-1" class="level2">
<h2 class="anchored" data-anchor-id="data-1">Data</h2>
<p>The data set used is the one on a synthetic observation and on breeds of animals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>s_data_path <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"docs"</span>, <span class="st">"data"</span>, <span class="st">"est_fun_breed_data.csv"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tbl_est_fun <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_delim</span>(s_data_path, <span class="at">delim =</span> <span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Breed
dbl (2): Animal, Observation

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tbl_est_fun</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Animal Breed     Observation
   &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
1      1 Angus              16
2      2 Angus              10
3      3 Angus              19
4      4 Simmental          11
5      5 Simmental          13
6      6 Limousin           27</code></pre>
</div>
</div>
<p>Use a second dataset with body weight and breed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>s_bw_breed_path <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"docs"</span>, <span class="st">"data"</span>, <span class="st">"asm_bw_breed.csv"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_delim</span>(s_bw_breed_path, <span class="at">delim =</span> <span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 10 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Breed
dbl (2): Animal, Body Weight

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   Animal `Body Weight` Breed    
    &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    
 1      1           471 Angus    
 2      2           463 Angus    
 3      4           470 Angus    
 4      7           518 Limousin 
 5      8           511 Limousin 
 6      9           510 Limousin 
 7     10           541 Limousin 
 8      3           481 Simmental
 9      5           496 Simmental
10      6           491 Simmental</code></pre>
</div>
</div>
</section>
<section id="use-regression-to-describe-group-means" class="level2">
<h2 class="anchored" data-anchor-id="use-regression-to-describe-group-means">Use Regression To Describe Group Means</h2>
<p>Start by looking only at breeds Angus and Limousin in the dataset on body weight. Then use the dummy coding where Angus animals receive a value of <span class="math inline">\(0\)</span> and Limousin animals receive a code of <span class="math inline">\(1\)</span>. The regression of body weight on that dummy coding results in a regression line that goes through the mean body weights for both breeds. That means, we get</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed <span class="ot">&lt;-</span> tbl_bw_breed <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Breed <span class="sc">!=</span> <span class="st">"Simmental"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed<span class="sc">$</span>BreedFactor <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(tbl_bw_breed<span class="sc">$</span>Breed))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  Animal `Body Weight` Breed    BreedFactor
   &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
1      1           471 Angus              0
2      2           463 Angus              0
3      4           470 Angus              0
4      7           518 Limousin           1
5      8           511 Limousin           1
6      9           510 Limousin           1
7     10           541 Limousin           1</code></pre>
</div>
</div>
<p>Fit regression</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lm_bw_breed <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span> <span class="sc">~</span> BreedFactor, <span class="at">data =</span> tbl_bw_breed)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>(smry_bw_breed <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_bw_breed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = `Body Weight` ~ BreedFactor, data = tbl_bw_breed)

Residuals:
  1   2   3   4   5   6   7 
  3  -5   2  -2  -9 -10  21 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  468.000      6.653  70.341  1.1e-08 ***
BreedFactor   52.000      8.802   5.908  0.00198 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.52 on 5 degrees of freedom
Multiple R-squared:  0.8747,    Adjusted R-squared:  0.8496 
F-statistic: 34.91 on 1 and 5 DF,  p-value: 0.001978</code></pre>
</div>
</div>
<p>Create a plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>pl_bw_breed <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tbl_bw_breed, <span class="fu">aes</span>(<span class="at">x =</span> BreedFactor, <span class="at">y =</span> <span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> smry_bw_breed<span class="sc">$</span>coefficients[<span class="st">"BreedFactor"</span>, <span class="st">"Estimate"</span>], </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> smry_bw_breed<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>])</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>pl_bw_breed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="20240413_est_fun_contrasts_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The intersection of the regression line at the two values <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> for BreedFactor are at the mean value for body weight for the two breeds AN and LI. The writing the parameter vector <span class="math inline">\(b\)</span> as</p>
<p><span class="math display">\[b = \left[ \begin{array}{c} b_0 \\ b_1 \end{array}\right] \]</span></p>
<p>We see in the next section how to express <span class="math inline">\(b\)</span> as contrasts of group means <span class="math inline">\(M_{AN}\)</span> and <span class="math inline">\(M_{LI}\)</span>.</p>
</section>
<section id="idea-of-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="idea-of-contrasts">Idea of Contrasts</h2>
<p>According to chapter 7 of [2], contrasts can be explained as follows.</p>
<p>A <strong>contrast</strong> is a linear combination of parameters or statistics. An alternative term for “linear combination” is <strong>weighted sum</strong>. We are currently focusing on statistics from two levels of a given factor. In our dataset this corresponds to two levels of the factor breed. As an example, we have a look at the observation for Simmental and for Angus animals.</p>
<p>Let <span class="math inline">\(M_{AN}\)</span> be the mean observation for all animals of breed Angus and <span class="math inline">\(M_{SI}\)</span> be the mean observation for all Simmental animals. The sum of the two means can be written as</p>
<p><span class="math display">\[L_1 = M_{AN} + M_{SI}
= \left[\begin{array}{cc} 1 &amp; 1 \end{array}\right] \cdot \left[ \begin{array}{c} M_{AN} \\  M_{SI}  \end{array}\right]
= l_1^T \cdot m\]</span></p>
<p>A different contrast (<span class="math inline">\(L_2\)</span>) insepects the difference between the two means.</p>
<p><span class="math display">\[L_2 = M_{AN} - M_{SI}
= \left[\begin{array}{cc} 1 &amp; -1 \end{array}\right] \cdot \left[ \begin{array}{c} M_{AN} \\  M_{SI}  \end{array}\right]
= l_2^T \cdot m\]</span></p>
<p>These contrasts <span class="math inline">\(l_1\)</span> and <span class="math inline">\(l_2\)</span> can be combined into a matrix <span class="math inline">\(L\)</span></p>
<p><span class="math display">\[L = \left[\begin{array}{cc} l_1 &amp; l_2 \end{array} \right] \]</span></p>
<p>Then we can write the above two contrasts as</p>
<p><span class="math display">\[L^T \cdot m\]</span></p>
<p>As seen in the previous section, the estimate of the parameter vector <span class="math inline">\(b\)</span> can be written as contrasts of group means and as a consequence, the group means can be written as a function of parameter estimates</p>
<p><span class="math display">\[m =  \left[ \begin{array}{c} M_{AN} \\  M_{SI}  \end{array}\right]
= \left[ \begin{array}{c} \widehat{b_0} \\  \widehat{b_0} + \widehat{b_1}  \end{array}\right]
=  \left[\begin{array}{cc} 1 &amp; 0 \\ 1 &amp; 1 \end{array}\right]
    \cdot \left[ \begin{array}{c} \widehat{b_0} \\  \widehat{b_1}  \end{array}\right]
= L^T \cdot  \widehat{b}\]</span></p>
<p>With this, the vector of group means <span class="math inline">\(m\)</span> is expressed as linear function or linear transformation of the vector of parameter estimates $ $. Solving for <span class="math inline">\(\widehat{b}\)</span> yields the parameter estimates as linear function of group means.</p>
<p><span class="math display">\[\widehat{b} = (L^T)^{-1} \cdot m\]</span></p>
<p>As shown below, the matrix <span class="math inline">\(L^T\)</span> is used to determine what type of contrasts are used in R.</p>
</section>
<section id="contrasts-in-r" class="level2">
<h2 class="anchored" data-anchor-id="contrasts-in-r">Contrasts in R</h2>
<p>For a given dataset, the contrast matrix can be obtained as a result of the function <code>contrasts()</code>. For our original example with three breeds this yields in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tbl_bw_breed <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_delim</span>(s_bw_breed_path, <span class="at">delim =</span> <span class="st">","</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mat_ctr_br <span class="ot">&lt;-</span> <span class="fu">contrasts</span>(<span class="fu">as.factor</span>(tbl_bw_breed<span class="sc">$</span>Breed))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>mat_ctr_br</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Limousin Simmental
Angus            0         0
Limousin         1         0
Simmental        0         1</code></pre>
</div>
</div>
<p>The above shown contrasts matrix shows in the rows, the original factor levels in the dataset. The columns stand for the new variables that are introduced in the re-dimensioned model. How the codes for the new model are assigned to the observations can be seen from the result of the function <code>model.matrix</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mat_mod_br <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span> <span class="sc">~</span> Breed, tbl_bw_breed)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mat_mod_br</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) BreedLimousin BreedSimmental
1            1             0              0
2            1             0              0
3            1             0              0
4            1             1              0
5            1             1              0
6            1             1              0
7            1             1              0
8            1             0              1
9            1             0              1
10           1             0              1
attr(,"assign")
[1] 0 1 1
attr(,"contrasts")
attr(,"contrasts")$Breed
[1] "contr.treatment"</code></pre>
</div>
</div>
<p>Adding a column representing the intercept to the contrasts matrix and taking its inverse, results in the matrix of estimable functions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mat_ctr_br_ext <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(mat_ctr_br))), mat_ctr_br)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mat_ctr_br_ext)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"(Intercept)"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>mat_ctr_br_ext</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          (Intercept) Limousin Simmental
Angus               1        0         0
Limousin            1        1         0
Simmental           1        0         1</code></pre>
</div>
</div>
<p>Then the inverse</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mat_est_fun <span class="ot">&lt;-</span> <span class="fu">solve</span>(mat_ctr_br_ext)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>mat_est_fun</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Angus Limousin Simmental
(Intercept)     1        0         0
Limousin       -1        1         0
Simmental      -1        0         1</code></pre>
</div>
</div>
<p>The first row indicates which group mean is used for the intercept. The remaining rows represent the estimable functions used for the effect with the corresponding row name.</p>
</section>
<section id="validation" class="level2">
<h2 class="anchored" data-anchor-id="validation">Validation</h2>
<p>The results on the investigated connection between contrasts and estimable functions is validated with our example dataset. For this validation, we first need a set of solutions to the least squares normal equations. As the first step, we set up the design matrix <span class="math inline">\(\mathbf{X}\)</span> and use it to compute the crossproduct <span class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tbl_flem_bw_breed</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>mat_X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span> <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Breed, tbl_bw_breed)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>mat_X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(tbl_bw_breed), <span class="at">ncol =</span> <span class="dv">1</span>), mat_X)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(mat_X) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>mat_xtx <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>mat_xtx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]   10    3    4    3
[2,]    3    3    0    0
[3,]    4    0    4    0
[4,]    3    0    0    3</code></pre>
</div>
</div>
<p>The solution to the normal equations are obtained by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>vec_y <span class="ot">&lt;-</span> tbl_bw_breed<span class="sc">$</span><span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mat_xty <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(mat_X, vec_y)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>mat_xtx_ginv <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">ginv</span>(mat_xtx)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>mat_b_sol <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(<span class="fu">t</span>(mat_xtx_ginv), mat_xty)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>mat_b_sol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 369.33333
[2,]  98.66667
[3,] 150.66667
[4,] 120.00000</code></pre>
</div>
</div>
<p>The intercept in the treatment contrasts are computed as the mean observations for the first factor level. For the factor <code>Breed</code> this corresponds to the mean of all animals of breed <code>Angus</code>. This is verified by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((tbl_bw_breed <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Breed <span class="sc">==</span> <span class="st">"Angus"</span>))<span class="sc">$</span><span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 468</code></pre>
</div>
</div>
<p>Based on the matrix of estimable functions, the effect assigned to the <code>BreedLimousin</code> corresponds to the difference between the third and the second component of the solution vector</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mat_b_sol[<span class="dv">3</span>] <span class="sc">-</span> mat_b_sol[<span class="dv">2</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52</code></pre>
</div>
</div>
<p>The effect assigned to <code>BreedSimmental</code> is the difference between the last and the second component of the solution vector</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mat_b_sol[<span class="dv">4</span>] <span class="sc">-</span> mat_b_sol[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.33333</code></pre>
</div>
</div>
<p>These effects can also be found in the summary output of the <code>lm</code> -object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>lm_bw_br <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span> <span class="sc">~</span> Breed, <span class="at">data =</span> tbl_bw_breed)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>(smry_lm_bw_br <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_bw_br))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = `Body Weight` ~ Breed, data = tbl_bw_breed)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.0000  -7.5000  -0.1667   2.7500  21.0000 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     468.000      6.097  76.758 1.68e-11 ***
BreedLimousin    52.000      8.066   6.447 0.000351 ***
BreedSimmental   21.333      8.623   2.474 0.042575 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.56 on 7 degrees of freedom
Multiple R-squared:  0.8597,    Adjusted R-squared:  0.8196 
F-statistic: 21.44 on 2 and 7 DF,  p-value: 0.001035</code></pre>
</div>
</div>
</section>
<section id="vector-of-group-means" class="level2">
<h2 class="anchored" data-anchor-id="vector-of-group-means">Vector of Group Means</h2>
<p>The vector <span class="math inline">\(m\)</span> is the vector of group means</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>n_mean_AN <span class="ot">&lt;-</span> <span class="fu">mean</span>((tbl_bw_breed <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Breed <span class="sc">==</span> <span class="st">"Angus"</span>))<span class="sc">$</span><span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>n_mean_LI <span class="ot">&lt;-</span> <span class="fu">mean</span>((tbl_bw_breed <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Breed <span class="sc">==</span> <span class="st">"Limousin"</span>))<span class="sc">$</span><span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>n_mean_SI <span class="ot">&lt;-</span> <span class="fu">mean</span>((tbl_bw_breed <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Breed <span class="sc">==</span> <span class="st">"Simmental"</span>))<span class="sc">$</span><span class="st">`</span><span class="at">Body Weight</span><span class="st">`</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>(vec_group_mean <span class="ot">&lt;-</span> <span class="fu">c</span>(n_mean_AN, n_mean_LI, n_mean_SI))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 468.0000 520.0000 489.3333</code></pre>
</div>
</div>
<p>Pre-multiplication of the vector of group means with the matrix of estimable functions yields</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossprod</span>(<span class="fu">t</span>(mat_est_fun), vec_group_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 [,1]
(Intercept) 468.00000
Limousin     52.00000
Simmental    21.33333</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>